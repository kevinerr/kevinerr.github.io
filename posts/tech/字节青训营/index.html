<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>字节青训营 | hkh&#39;s Blog</title>
<meta name="keywords" content="标签1, 标签2" />
<meta name="description" content="day1 go语言上手-基础语言 https://bytedance.feishu.cn/file/boxcnQnHXuDOdzd8CqVid7nQLmg 随机数 rand.Intn () 函数是个伪随机函数，不管运行多少次都只会返回同样的随机数，因为它默认的资源就是单一值，所以必须调用 rand.Seed (), 并">
<meta name="author" content="
作者:&nbsp;kevin">
<link rel="canonical" href="https://kevinerr.github.io/posts/tech/%E5%AD%97%E8%8A%82%E9%9D%92%E8%AE%AD%E8%90%A5/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.7724ad4800b622e9e86a37940cdc71441089d486cd46f35de38fdd833dd93d2f.css" integrity="sha256-dyStSAC2IunoajeUDNxxRBCJ1IbNRvNd44/dgz3ZPS8=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.4dcb3c4f38462f66c6b6137227726f5543cb934cca9788f041c087e374491df2.js" integrity="sha256-Tcs8TzhGL2bGthNyJ3JvVUPLk0zKl4jwQcCH43RJHfI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://kevinerr.github.io/img/Q.jpg">
<link rel="icon" type="image/png" sizes="16x16" href="https://kevinerr.github.io/img/Q.jpg">
<link rel="icon" type="image/png" sizes="32x32" href="https://kevinerr.github.io/img/Q.jpg">
<link rel="apple-touch-icon" href="https://kevinerr.github.io/Q.jpg">
<link rel="mask-icon" href="https://kevinerr.github.io/Q.jpg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.94.2" />
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="字节青训营" />
<meta property="og:description" content="day1 go语言上手-基础语言 https://bytedance.feishu.cn/file/boxcnQnHXuDOdzd8CqVid7nQLmg 随机数 rand.Intn () 函数是个伪随机函数，不管运行多少次都只会返回同样的随机数，因为它默认的资源就是单一值，所以必须调用 rand.Seed (), 并" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://kevinerr.github.io/posts/tech/%E5%AD%97%E8%8A%82%E9%9D%92%E8%AE%AD%E8%90%A5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-06T10:00:50&#43;08:00" />
<meta property="article:modified_time" content="2022-05-06T10:00:50&#43;08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="字节青训营"/>
<meta name="twitter:description" content="day1 go语言上手-基础语言 https://bytedance.feishu.cn/file/boxcnQnHXuDOdzd8CqVid7nQLmg 随机数 rand.Intn () 函数是个伪随机函数，不管运行多少次都只会返回同样的随机数，因为它默认的资源就是单一值，所以必须调用 rand.Seed (), 并"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "📚文章",
      "item": "https://kevinerr.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "👨🏻‍💻技术",
      "item": "https://kevinerr.github.io/posts/tech/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "字节青训营",
      "item": "https://kevinerr.github.io/posts/tech/%E5%AD%97%E8%8A%82%E9%9D%92%E8%AE%AD%E8%90%A5/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "字节青训营",
  "name": "字节青训营",
  "description": "day1 go语言上手-基础语言 https://bytedance.feishu.cn/file/boxcnQnHXuDOdzd8CqVid7nQLmg 随机数 rand.Intn () 函数是个伪随机函数，不管运行多少次都只会返回同样的随机数，因为它默认的资源就是单一值，所以必须调用 rand.Seed (), 并",
  "keywords": [
    "标签1", "标签2"
  ],
  "articleBody": "day1 go语言上手-基础语言 https://bytedance.feishu.cn/file/boxcnQnHXuDOdzd8CqVid7nQLmg\n随机数 rand.Intn () 函数是个伪随机函数，不管运行多少次都只会返回同样的随机数，因为它默认的资源就是单一值，所以必须调用 rand.Seed (), 并且传入一个变化的值作为参数，如 time.Now().UnixNano() , 就是可以生成时刻变化的值.\n1 2 3  maxNum := 100 rand.Seed(time.Now().UnixNano()) secretNumber := rand.Intn(maxNum)   输入 输入bufio的reader\n1 2 3 4  reader := bufio.NewReader(os.Stdin) input, err := reader.ReadString('\\n') //以空格结束 input = strings.TrimSuffix(input, \"\\r\\n\") uess, err := strconv.Atoi(input) //转为int      fmt.Scan 获取输入     fmt.Scanf 获取输入，但是可以指定格式，go语言会根据格式解析参数   fmt.Scanln 获取一行的输入，只会获取到一行    1 2 3 4 5 6 7 8 9  var guess int _ , err := fmt.Scanf(\"%v\\n\",\u0026guess)   var a1,a2 string fmt.Scanln(\u0026a1,\u0026a2)//如果换行输出不了a2了  var a1,a2 string fmt.Scanf(\"%s %s\",\u0026a1,\u0026a2)   自动生成爬虫代码 https://fanyi.caiyunapp.com/#/\n要求是bash\nhttps://curlconverter.com/#go\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44  package main  import ( \t\"fmt\" \t\"io/ioutil\" \t\"log\" \t\"net/http\" \t\"strings\" )  func main() { \tclient := \u0026http.Client{} \tvar data = strings.NewReader(`{\"trans_type\":\"en2zh\",\"source\":\"good\"}`) \treq, err := http.NewRequest(\"POST\", \"https://api.interpreter.caiyunai.com/v1/dict\", data) \tif err!= nil { \tlog.Fatal(err) \t} \treq.Header.Set(\"Accept\", \"application/json, text/plain, */*\") \treq.Header.Set(\"Accept-Language\", \"zh-CN,zh;q=0.9\") \treq.Header.Set(\"Connection\", \"keep-alive\") \treq.Header.Set(\"Content-Type\", \"application/json;charset=UTF-8\") \treq.Header.Set(\"Origin\", \"https://fanyi.caiyunapp.com\") \treq.Header.Set(\"Referer\", \"https://fanyi.caiyunapp.com/\") \treq.Header.Set(\"Sec-Fetch-Dest\", \"empty\") \treq.Header.Set(\"Sec-Fetch-Mode\", \"cors\") \treq.Header.Set(\"Sec-Fetch-Site\", \"cross-site\") \treq.Header.Set(\"User-Agent\", \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36\") \treq.Header.Set(\"X-Authorization\", \"token:qgemv4jr1y38jyq6vhvi\") \treq.Header.Set(\"app-name\", \"xy\") \treq.Header.Set(\"os-type\", \"web\") \treq.Header.Set(\"sec-ch-ua\", `\" Not A;Brand\";v=\"99\", \"Chromium\";v=\"100\", \"Google Chrome\";v=\"100\"`) \treq.Header.Set(\"sec-ch-ua-mobile\", \"?0\") \treq.Header.Set(\"sec-ch-ua-platform\", `\"Windows\"`) \tresp, err := client.Do(req) \tif err!= nil { \tlog.Fatal(err) \t} \tdefer resp.Body.Close() \tbodyText, err := ioutil.ReadAll(resp.Body) \tif err!= nil { \tlog.Fatal(err) \t} \tfmt.Printf(\"%s\\n\", bodyText) }   运行代码输出\n1  {\"rc\":0,\"wiki\":{\"known_in_laguages\":63,\"description\":{\"source\":\"tangible and intangible thing, except labor tied services, that satisfies human wants and provides utility\",\"target\":null},\"id\":\"Q28877\",\"item\":{\"source\":\"good\",\"target\":\"\\u5546\\u54c1\"},\"image_url\":\"http:\\/\\/www.caiyunapp.com\\/imgs\\/link_default_img.png\",\"is_subject\":\"true\",\"sitelink\":\"https:\\/\\/www.caiyunapp.com\\/read_mode\\/?id=625b4b949c0120504d1e7b69\"},\"dictionary\":{\"prons\":{\"en-us\":\"[g\\u028ad]\",\"en\":\"[gud]\"},\"explanations\":[\"a.\\u597d\\u7684;\\u5584\\u826f\\u7684;\\u5feb\\u4e50\\u7684;\\u771f\\u6b63\\u7684;\\u5bbd\\u5927\\u7684;\\u6709\\u76ca\\u7684;\\u8001\\u7ec3\\u7684;\\u5e78\\u798f\\u7684;\\u5fe0\\u5b9e\\u7684;\\u4f18\\u79c0\\u7684;\\u5b8c\\u6574\\u7684;\\u5f7b\\u5e95\\u7684;\\u4e30\\u5bcc\\u7684\",\"n.\\u5229\\u76ca;\\u597d\\u5904;\\u5584\\u826f;\\u597d\\u4eba\",\"ad.=well\"],\"synonym\":[\"excellent\",\"fine\",\"nice\",\"splendid\",\"proper\"],\"antonym\":[\"bad\",\"wrong\",\"evil\",\"harmful\",\"poor\"],\"wqx_example\":[[\"to the good\",\"\\u6709\\u5229,\\u6709\\u597d\\u5904\"],[\"good, bad and indifferent\",\"\\u597d\\u7684,\\u574f\\u7684\\u548c\\u4e00\\u822c\\u7684\"],[\"good innings\",\"\\u957f\\u5bff\"],[\"good and ...\",\"\\u5f88,\\u9887;\\u5b8c\\u5168,\\u5f7b\\u5e95\"],[\"do somebody's heart good\",\"\\u5bf9\\u67d0\\u4eba\\u7684\\u5fc3\\u810f\\u6709\\u76ca,\\u4f7f\\u67d0\\u4eba\\u611f\\u5230\\u6109\\u5feb\"],[\"do somebody good\",\"\\u5bf9\\u67d0\\u4eba\\u6709\\u76ca\"],[\"be good for\",\"\\u5bf9\\u2026\\u6709\\u6548,\\u9002\\u5408,\\u80dc\\u4efb\"],[\"be good at\",\"\\u5728\\u2026\\u65b9\\u9762(\\u5b66\\u5f97,\\u505a\\u5f97)\\u597d;\\u5584\\u4e8e\"],[\"as good as one's word\",\"\\u4fe1\\u5b88\\u8bfa\\u8a00,\\u503c\\u5f97\\u4fe1\\u8d56\"],[\"as good as\",\"\\u5b9e\\u9645\\u4e0a,\\u51e0\\u4e4e\\u7b49\\u4e8e\"],[\"all well and good\",\"\\u4e5f\\u597d,\\u8fd8\\u597d,\\u5f88\\u4e0d\\u9519\"],[\"a good\",\"\\u76f8\\u5f53,\\u8db3\\u8db3\"],[\"He is good at figures . \",\"\\u4ed6\\u5584\\u4e8e\\u8ba1\\u7b97\\u3002\"]],\"entry\":\"good\",\"type\":\"word\",\"related\":[],\"source\":\"wenquxing\"}}   https://oktools.net/json2go\n转为go结构体\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32  type DictResponse struct { \tRc int `json:\"rc\"` \tWiki struct { \tKnownInLaguages int `json:\"known_in_laguages\"` \tDescription struct { \tSource string `json:\"source\"` \tTarget interface{} `json:\"target\"` \t} `json:\"description\"` \tID string `json:\"id\"` \tItem struct { \tSource string `json:\"source\"` \tTarget string `json:\"target\"` \t} `json:\"item\"` \tImageURL string `json:\"image_url\"` \tIsSubject string `json:\"is_subject\"` \tSitelink string `json:\"sitelink\"` \t} `json:\"wiki\"` \tDictionary struct { \tProns struct { \tEnUs string `json:\"en-us\"` \tEn string `json:\"en\"` \t} `json:\"prons\"` \tExplanations []string `json:\"explanations\"` \tSynonym []string `json:\"synonym\"` \tAntonym []string `json:\"antonym\"` \tWqxExample [][]string `json:\"wqx_example\"` \tEntry string `json:\"entry\"` \tType string `json:\"type\"` \tRelated []interface{} `json:\"related\"` \tSource string `json:\"source\"` \t} `json:\"dictionary\"` }   SOCKS5 https://zhuanlan.zhihu.com/p/438521117\n老师，请问go的字符串拼接效率问题，一般考虑到综合易用性和性能，推荐使用 strings.Builder 来拼接字符串。但为什么有的文章会说标准编译器对使用+运算符的字符串衔接做了特别的优化。 所以，一般说来，在被衔接的字符串的数量是已知的情况下，使用+运算符进行字符串衔接是比较高效的。请问下一般在项目中如何拼接字符串是比较高效合理的呢\nday2 go语言上手-应用实践 https://bytedance.feishu.cn/file/boxcnRmlw9MjbtAMBnOW44y8dZd?hash=7cfc75acc80372c08463b622df90a4b5\ngo依赖管理引进 2个目标 不同环境依赖的版本不同\n控制依赖库的版本\nGOPATH GO Vendor GO Module go.mod\nProxy\ngo get/mod\n测试 单元测试 1 2 3 4 5  package concurrence  func HelloTom() string { \treturn \"Tom\" }   1 2 3 4 5 6 7 8 9 10 11  package concurrence  import \"testing\"  func TestHelloTom(t *testing.T) { \toutput := HelloTom() \texpectOutput := \"Tom\" \tif output != expectOutput { \tt.Errorf(\"Expected %s do not match actual %s\", expectOutput, output) \t} }   assert 1 2 3 4 5 6 7 8 9 10 11 12  package concurrence  import ( \t\"github.com/stretchr/testify/assert\" \t\"testing\" )  func TestHelloTom(t *testing.T) { \toutput := HelloTom() \texpectOutput := \"Tom\" \tassert.Equal(t, expectOutput, output) }   覆盖率 1 2 3 4 5 6 7 8  package concurrence  func JudgePassLine(score int16) bool { \tif score = 60 { \treturn true \t} \treturn false }   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  package concurrence  import ( \t\"github.com/stretchr/testify/assert\" \t\"testing\" )  func TestJudgePassLineTrue(t *testing.T) { \tisPass := JudgePassLine(70) \tassert.Equal(t, true, isPass) }  func TestJudgePassLineFalse(t *testing.T) { \tisPass := JudgePassLine(50) \tassert.Equal(t, false, isPass) }   1  go test .\\demo_test.go .\\demo.go --cover   Mock测试 基准测试  day3 高质量编程与性能调优实战 https://bytedance.feishu.cn/file/boxcnqqWtT0xgWAIMGWVs7wM6fd\n高质量编程 高质量-正确可靠、简洁清晰\n编码规范 代码格式 gofmt\ngoimports\n注释 解释代码作用–适合注释公共符号\n解释代码代码是如何做的–适合代码逻辑比较多的\n解释代码实现的原因–提供额外上下文\n解释代码什么情况下会出错–\n公共符号始终要注释,不需要注释实现接口的方法\n命名规范 简洁胜于冗长\n缩略词全大写\n有特定的含义\n函数名不带包的上下文信息\n控制流程 优先处理错误情况，尽早返回\n错误和异常处理 性能优化建议 benchmark Slice 尽量初始化容量信息，避免内存发生拷贝\n因为切片操作并不复制切片指向的元素，创建一个新的切片会复用原来切片的底层数组，所以会有大内存未释放的陷阱\nMap 预分配内存\n字符串处理 +最慢\nstrings.Builder\nbytes.Buffer最快\n空结构体 可以用来实现set\natomic包 锁的实现是由操作系统来实现，属于系统调用\natomic操作通过硬件实现，效率比锁高\n性能调优实战 要依靠数据，而不是猜测\n要定位最大瓶颈而不是细枝末节\n不要过早优化\n不要过度优化\npprof实战 https://blog.wolfogre.com/posts/go-ppof-practice/\ncpu占用情况\ngo tool pprof http://localhost:6060/debug/pprof/profile\n内存分配情况\ngo tool pprof http://localhost:6060/debug/pprof/heap\n阻塞操作情况\ngo tool pprof http://localhost:6060/debug/pprof/block\ngoroutine堆栈\ngo tool pprof http://localhost:6060/debug/pprof/goroutine\n锁竞争\ngo tool pprof http://localhost:6060/debug/pprof/mutex\ngc\ngo tool pprof http://localhost:6060/debug/pprof/allocs\npprof采样过程和原理 性能调优案例 业务服务优化 建立服务性能评估手段\n 服务性能评估手段 请求流量构造 压测范围 性能数据采集  分析性能数据，定位性能评价\n重点优化项改造\n优化效果验证\n进一步优化，服务整体链路分析\nAB实验SDK的优化\n编译器和运行时优化\n课后作业-重点内容 Review   了解下其他语言的编码规范，是否和 Go 语言编码规范有相通之处，注重理解哪些共同点？\n  编码规范或者性能优化建议大部分是通用的，有没有方式能够自动化对代码进行检测？\n  从 github.com/golang/go/t… 中选择感兴趣的包，看看官方代码是如何编写的？\n  使用 Go 进行并发编程时有哪些性能陷阱或者优化手段？\n  在真实的线上环境中，每个场景或者服务遇到的性能问题也是各种各样，搜索下知名公司的官方公众号或者博客，里面有哪些性能优化的案例？比如 eng.uber.com/category/os…\n  Go 语言本身在持续更新迭代，每个版本在性能上有哪些重要的优化点？\n  正确答案：   可以了解下开源项目的编码规范，比如Google开源项目风格指南，\ngoogle.github.io/styleguide\nhttps://zh-google-styleguide.readthedocs.io/en/latest/\n  Go 语言有代码检查工具，可以和CI进行集成，https://github.com/golangci/golangci-lint\n  可以优先看看sync和net包的内容，实际在服务端编程过程中会经常用到\nhttps://github.com/golang/go/tree/master/src/sync\nhttps://github.com/golang/go/tree/master/src/net\n  可以看看Effective Go的并发编程章节，\nhttps://go.dev/doc/effective_go#concurrency\nhttps://github.com/geektutu/high-performance-go\n  实际优化案例，\nhttps://eng.uber.com/how-we-saved-70k-cores-across-30-mission-critical-services/\nhttps://medium.com/coralogix-engineering/optimizing-a-golang-service-to-reduce-over-40-cpu-366b67c67ef9\n  Go 的每次版本更新都有详细的文档说明，可以从中了解性能相关的信息，\nhttps://go.dev/doc/devel/release\n  day4 高性能go语言发行版优化与落地实践 https://bytedance.feishu.cn/file/boxcnRcx62rX5X22Q2WFR5Xm5Oh?hash=cd874ae31e355b9a1f34ae0dad2fad5e\n内存管理优化\n编译器优化\n性能优化的基本问题 性能优化是什么？\n提升软件系统处理能力，减少不必要的耗费、充分发掘计算机算力\n为什么要性能优化\n用户体验\n资源高效利用\n性能优化的2个层面 业务层优化\n语言运行时优化\n性能优化的可维护性 自动内存管理 自动内存管理：由程序语言的运行时系统管理动态内存\n避免手动处理内存\n保证内存使用的正确性和安全性\n评价gc算法：安全性、吞吐率、暂停时间、内存开销\n分代GC 引用计数 go内存管理及优化 分块 缓存 Go对象分配的性能问题 分配路径过长\n小对象居多\nBalanced GC 指针碰撞风格的对象分配\n实现了copying GC\n性能收益\n编译器和静态分析 编译器的结构与编译的流程 编译器后端优化 数据流和控制流分析 过程内和过程间分析 go编译器优化 Tradeoff ：用编译时间换取更高效的机器码\nBeast mode 函数内联\n逃逸分析\n课后作业- 重点内容 Review   从业务层和语言运行时层进行优化分别有什么特点？\n  从软件工程的角度出发，为了保证语言SDK的可维护性和可拓展性，在进行运行时优化时需要注意什么？\n  自动内存管理技术从大类上分为哪两种，每一种技术的特点以及优缺点有哪些？\n  什么是分代假说？分代 GC 的初衷是为了解决什么样的问题？\n  Go 是如何管理和组织内存的？\n  为什么采用 bump-pointer 的方式分配内存会很快？\n  为什么我们需要在编译器优化中进行静态代码分析？\n  函数内联是什么，这项优化的优缺点是什么？\n  什么是逃逸分析？逃逸分析是如何提升代码性能的？\n  正确答案：   业务层的优化需要针对具体问题具体分析；而语言运行时层的优化针对的是更通用的问题，需要在多方面进行 tradeoff。两者都需要自动化性能分析工具的支持。\n  因为语言 SDK 会被大量广泛使用，保证接口的稳定性和一致性至关重要。对已有接口的改动，需要保证兼容性；对新增的接口，需要提供明确的文档说明。对于功能的改动，最好通过选项进行隔离，保证新增改动在不打开的情况下不影响原本的功能。\n  主要分为追踪垃圾回收和引用计数：\na. 追踪垃圾回收\n1 2 3 4 5  1️⃣ 回收内存的条件：回收不可达的对象； 2️⃣ 回收时，首先会扫描 GC roots，例如栈上的对象、全局变量等； 3️⃣ 从 GC roots 出发，沿着指针指向，追踪所有的可达对象； 4️⃣ 追踪完成后，回收所有不可达对象的内存。 复制代码   b. 引用计数\n1 2 3 4 5  1️⃣ 对象有一个与之关联的引用数目。当且仅当引用数大于 0 时对象存活； 2️⃣ 当对象的引用数目为 0 时，内存可以被回收； 3️⃣ 优点：内存管理的开销被平摊到程序运行中，且内存管理不需要了解 runtime 的实现细节； 4️⃣ 缺点：维护引用计数的开销较大；额外的内存开销存储引用计数；无法回收带有环的数据结构；回收大数据结构时依然会造成程序暂停。 复制代码     大量的对象会很快死去。分代 GC 的思想是：针对不同生命周期的对象采取不同策略的内存管理机制。\n  Go 使用 TCMalloc 风格的内存管理方式。\na. TC 是 thread caching 的简写。每个线程都绑定 cache 方便线程快速分配内存；\nb. 内存被划分为特定大小的块。根据对象是否包含指针，将内存块分为 scan 和 noscan 两种；\nc. 根据内存分配请求的大小，选择合适的内存块返回，完成一次内存分配操作；\nd. 回收的内存不会立刻还给操作系统，而是在 Go 内部缓存起来，方便下次分配。\n  每个线程都持有用于对象分配的 buffer，因此指针碰撞方式的内存分配无需加锁或使用 CAS 操作；对象分配的操作非常简单。\n  通过静态分析，我们可以获取更多关于程序的非平凡特性 (non-trivial properties)；这些关于程序的知识可以指导编译器优化。例如通过逃逸分析得知对象并未逃逸出当前函数，因此对象可以在栈上分配，避免频繁在堆上分配对象，降低 GC 的压力。\n  函数内联：将被调用函数的函数体的副本替换到调用位置上，同时重写代码以反映参数的绑定。\na. 优点\n1 2 3  ① 消除函数调用； ② 由于没有了函数调用，过程间分析转化为过程内分析； 复制代码   b. 缺点\n1 2 3  ① 函数体变大； ② 编译生成的 Go 镜像变大。 复制代码     逃逸分析：分析代码中指针的动态作用域，即指针在何处可以被访问。\n通过逃逸分析得知对象并未逃逸出当前函数，因此对象可以在栈上分配，避免频繁在堆上分配对象，降低 GC 的压力。\n  day5 GORM https://bytedance.feishu.cn/file/boxcnct7Jc8Td2Oolfbm6t4HfJg?hash=e52044cf65cc597854fbf299f2a26073\n理解database/sql 基本用法 设计原理 基础概念 GORM使用简介 基本用法 Model定义 惯例约定 关联 GORM设计原理 SQL生成 插件扩展 ConnPool Dialector GORM最佳实践 数据序列化与SQL表达式\n批量数据操作\n代码复用、分库分表、Sharding\n混沌工程/压测\nLogger/Trace\nMigrate\nGen代码生成/Raw SQL\n安全\n课后作业 作业要求：首先实现一个脚本工具：包含一个 User struct, 只包含 UUID string, Name string，Age int，Version int 四个字段，在脚本中使用 gorm ＋ mysql 初始化 DB, 并使用初始化后的 DB 的 AutoMigrate 迁移数据表。\n然后完成一个 Gen (github.com/go-gorm/gen/) 项目，基于上面创建的数据库及表名，通过 Gen 的自动同步库表功能生成 struct People，并给该 struct 生成基本 CRUD 方法，基于 OnConflict Upsert 功能实现 100 个随机用户的创建，其中需要包含重复的 UUID 用户的 Upsert, 在 Upsert 时，如果遇到重复 UUID 中，需要将 Version 更新为 Version + 1。最后再通过一条自定义的Raw SQL 实现，将数据按 Version 分组，并取出 Version 最高的一组的用户总数的功能，该 Raw SQL 需要通过自定义查询方法的形式实现，需要给 People 生成相应的方法名: GetMaxVersionCount。完成后提交代码到 github\n正确答案：   (WIP)\n  参考 github.com/go-gorm/mys… , 实现出 gorm dialector interface (github.com/go-gorm/gor…)\n  通过 docker compose 跑起来环境后，go test 测试通过成后即可\n 通过实现插件的 callbacks 接口，然后通过 Use 注册使用加解密码功能，在实现中需要从 db.Statement.Context 读取到当前租户 ID，然后通过该 ID 进行加解密  通过 docker compose 跑起来环境后，go test 测试通过成后即可\nday6.1 实战项目 https://bytedance.feishu.cn/docx/doxcnDExcSSmRx5R9s8uKmZRpNc\nhttps://live.juejin.cn/4354/yc_teacher\nday6.2 从需求到上线全流程 https://bytedance.feishu.cn/file/boxcnBFwiH4ItgbiBBADJcFTKBc\nhttps://live.juejin.cn/4354/yc_demand\n为什么要有流程    分类 英文 中文 解释     研发模式 Waterfall Model 瀑布模型 瀑布模型（Waterfall Model）最早强调软件或系统开发应有完整之周期，且必须完整的经历周期之每一开发阶段，并系统化的考量分析与设计的技术、时间与资源之投入等。由于该模式强调系统开发过程需有完整的规划、分析、设计、测试及文件等管理与控制，因此能有效的确保系统质量，它已经成为软体业界大多数软件开发的最初标准    The Scaled Agile Framework(SAFe) 规模化敏捷框架     Scrum Scrum 在软件工程中，Scrum是以经验过程为依据，采用迭代、增量的方法来提高产品开发的可预见性并控制风险的理论，Scrum不是一种过程，也不是一项构建产品的技术，而是一个框架，在Scrum框架中可以应用各种过程和技术，Scrum的作用是让开发实践方法的相对功效显现出来以便随时改进。 Scrum是敏捷(Agile)开发的一种实践模式，敏捷开发强调拥抱需求变化，快速响应不断变化的需求，并尽可能快地提供可以工作的软件产品，敏捷最强调的是可以正常工作的软件产品，文档等不是非常的强调（并非不要文档，只是需要必要的文档），敏捷理论认为面对面的沟通交流远比文档更有效。 敏捷开发的Scrum模式是以价值驱动(Value-Driven)的开发模式，即认为用户的需求并不一定需要100%实现，最重要的是将对用户最有价值的功能实现并交付.   流程中的概念 Scrum Master 敏捷教练 Scrum Master是Scrum教练和团队带头人，确保团队合理的运作Scrum，并帮助团队扫除实施中的障碍   Product Owner 产品负责人 产品负责人，确定产品的方向和愿景，定义产品发布的内容、优先级及交付时间，为产品投资回报率负责；    Agile Release Train 敏捷发布火车 敏捷开发的一种发布模式    RD 研发工程师 RD一般指Research and Development Engineer，即研发工程师。    PM 产品经理 产品经理    PRD 产品需求文档 产品需求文档    RD 研发工程师 RD一般指Research and Development Engineer，即研发工程师。    UED 交互设计师 用户体验设计师，交互设计师，界面设计师    QA 测试工程师 指理解产品的功能要求，并对其进行测试，检查软件有没有缺陷（Bug），测试软件是否具有稳定性（Robustness）、安全性、易操作性等性能，写出相应的测试规范和测试用例的专门工作人员。    Backlog 待办事项 产品订单（product backlog）是整个专案的概要文档。产品订单包括所有所需特性的粗略的描述。产品订单是关于将要生产什么样的产品。产品订单是开放的，每个人都可以编辑。产品订单包括粗略的估算，通常以天为单位。估算将帮助产品负责人衡量时程表和优先级（例如，如果\"增加拼写检查\"特性的估计需要花3天或3个月，将影响产品负责人对该特性的渴望）。 冲刺订单（sprint backlog）是大大细化了的文档，包含团队如何实现下一个冲刺的需求的信息。任务被分解为以小时为单位，没有任务可以超过16个小时。如果一个任务超过16个小时，那么它就应该被进一步分解。冲刺订单上的任务不会被分派，而是由团队成员签名认领他们喜爱的任务。    Grooming Meeting Grooming会议 这个会议上面会由PO来描述下个迭代需要实现的功能，大家讨论要不要干    Planning Meeting Planning会议 这个会议讨论功能具体什么时候干，要估算任务的工作量    基础知识 CNCF 云原生计算基金会 云原生计算是软件开发中的一种方法，它利用云计算“在现代动态环境（例如公共云、私有云和混合云）中构建和运行可扩展的应用程序”。 通过声明性代码部署的容器、微服务、无服务器功能和不可变基础设施等技术是这种架构风格的常见元素。   Kubernetes K8S 生产级别的容器编排系统。Kubernetes 是一个可移植的、可扩展的开源平台，用于管理容器化的工作负载和服务，可促进声明式配置和自动化。 Kubernetes 拥有一个庞大且快速增长的生态系统。Kubernetes 的服务、支持和工具广泛可用。    FAAS 函数即服务 函数即服务。仅通过编写函数（function）就能够发布为一个 API 或者服务，实现业务功能的技术体系。由于处理单元为函数粒度，往往底层也能够支持自动扩缩容地更精细化使用计算资源，开发侧支持事件驱动，可由消息或多种 Hook 触发，同时拥有快速上线、按需付费等优点。    APAAS 平台即服务 是一个为应用程序服务提供开发和部署环境的云服务    IDE IDE 用于提供程序开发环境的应用程序。一般包括代码编辑器、编译器、调试器和图形用户界面等工具    Git Git 分布式的版本管理系统    Merge/Rebase 合并/变基 处理代码分支的操作，将不同的分支整合成一个的两种方式     后端的定位  瀑布模式  按照时间节点参与会议，产出文档（系统分析，概要设计，详细设计，接口文档，提测文档等） 按照时间节点交付测试 按照时间节点发布   敏捷团队  跟随迭代制定规划，进行开发 参与待办事项整理会议（Backlog Grooming Meeting）  PO描述下个迭代希望实现的用户故事   迭代计划会议（Sprint Planning Meeting）  选择迭代的任务和估算工作量   每日站会（Standup Meeting）  昨天你做了什么? 今天你将要做什么? 你有需要帮助的地方吗?   评审会（Retrospective Meeting）  小组向产品负责人展示迭代工作结果   反思会（Retrospective Meeting）  在每个迭代后召开简短的反思会，总结哪些事情做得好，哪些事情做得不好      团队协作 一个具体的迭代时间表：\n2. 有哪些流程 需求阶段   不要浪费时间讨论不应该存在的问题\n  站在用户的角度思考\n  给出后端系统视角的建议，估算任务优先级\n  开发阶段   云原生下的开发：\n 容器化技术 微服务技术 WebIDE    团队分支策略：\n 为什么会有分支策略 有哪些分支策略 合并的方式    代码规范\n 养成良好的注释习惯，超过三个月的代码，自己都会忘了当时在想什么 不要有魔法数字，魔法字符串 重复的逻辑抽象成公共的方法，不要copy代码 正确使用IDE的重构功能，防止修改错误    自测\n 单元测试 功能环境测试 测试数据构造    文档\n 大型改造需要有技术设计文档，方案评审 好的接口文档能更方便的和前端进行沟通    测试阶段  功能测试  功能测试，是为了测试一个新开发的功能，因此需要有能模拟线上的开发和测试环境，环境之间能相互隔离，这样可以独立验证不同的新功能\n  集成测试：集成测试，是为了把几个功能合在一起测试，因为可能各个新功能独立测试没有问题，但是合在一起却产生了bug\n  回归测试：回归测试是为了验证老的功能不被新的改动影响\n  发布阶段   各种发布模式\n 蛮力发布：简单粗暴，直接用新版本覆盖老版本。 金丝雀发布：由于金丝雀对瓦斯极其敏感，因此以前矿工开矿下矿洞前，先会放一只金丝雀进去探是否有有毒气体，看金丝雀能否活下来，金丝雀发布由此得名。 滚动发布：每个实例都通过金丝雀的方式逐步放大流量，对用户影响小，体验平滑 蓝绿发布：常备两个集群，先把流量全部切换到Group 1，升级Group2，然后再把流量全部切换到Group 2，升级Group 1。最终恢复流量。 红黑发布：与蓝绿发布类似，但是日常只有一个集群工作，发布时扩容一个集群升级新版本，切换流量后下掉老版本的集群。    发布过程要做的事\n 发布负责人  负责按照计划执行发布 需要通知各个相关人员发布进展 观察各个服务的发布状态，及时处理异常   变更服务的相关RD  按照上线checklist检查服务的日志，监控，响应上线过程中的告警 对于自己负责的改动，在小流量或者是预览环境进行功能验证 执行发布计划中的其他操作（如线上配置，数据处理等）   值班同学  发布过程中的监控和告警需要特别关注，如果有异常需要立刻判断是否由变更引起 如果有变更引起的告警或者用户反馈，需要及时中止发布      运维阶段 3. 怎样执行流程 DevOps  效率竖井  流程中实际产生价值的部分很短 大量的时间用在等待和传递上 人和人之间的沟通很慢     DevOps解决方案  代码管理 自动化测试 持续集成 持续交付    全流程自动化   通过效能平台串联各个阶段\n 需求发起研发流程的自动化 写代码，测试环境部署的自动化 自动化测试触发和报告分析 发布过程可观测融入流程    减少无价值的等待\n 分析整个流程的耗时，计算真正产生价值的时间 不断优化流程，让有价值的流程时间占比上升    参考文献   瀑布模型 zh.wikipedia.org/wiki/%E7%80…\n  Scrum: zh.wikipedia.org/wiki/Scrum\n  SAFe：\na. www.woshipm.com/pd/4331832.… b. en.wikipedia.org/wiki/Scaled…\n  CNCF：en.wikipedia.org/wiki/Cloud_…\n  常用的发布模式：www.cnblogs.com/Leo_wl/p/14…\n  课后作业：   敏捷宣言是什么？\n  Grooming meeting 的作用是什么？\n  我们为什么需要进行集成测试？\n  遇到线上问题，我们要做的四个关键动作是什么？\n  DevOps 包含了哪些流程？\n  正确答案：   敏捷宣言参考：agilemanifesto.org/iso/zhchs/m…\n  PO描述下个迭代希望实现的用户故事，PM提出需求列表\n  不同人开发的功能合并在一起测试，相互之间的影响可能产生缺陷；迭代发布的所有功能合并在一起测试，确保发布的所有功能之间的影响不产生缺陷\n  止损，周知，定位，修复\n  DevOps概念上，涵盖了软件交付生命周期的全流程，包含需求-开发-构建-测试-发布-运维的研发环节\n  day7.1 计算机网络基本概念 https://live.juejin.cn/4354/yc_computer\nhttps://bytedance.feishu.cn/file/boxcneJVcYNfEn3umrE5K806h0g\nhttps://juejin.cn/post/7097126973163454494#heading-0\n刷抖音网络是怎么交互的？ 怎么让我的手机能访问抖音服务器 网络接入-互联网 网络接入-路由 交换机-同网段发包交互？\n找MAC地址就行，SDN（Software Defined Network）软件定义网络\n路由一定是对称的吗？\n不一定，去的时候可以是一条路，回来的时候另一条路\n路由是工作在哪一层协议？\nip层 传输层\n路由改的是IP地址吗？\n源IP地址和⽬标IP地址在传输过程中是不会变化的，只有源 MAC 地址和⽬标 MAC ⼀直在变化。\n动态路由BGP/OSPF？\nhttps://blog.csdn.net/weixin_43914604/article/details/105084158\nhttps://blog.csdn.net/weixin_43914604/article/details/105313629\n网络接入-ARP协议 逻辑同网段才能发送ARP？\nhttps://blog.csdn.net/weixin_43914604/article/details/105138313\nARP请求广播，应答单播\nARP的本质是寻求下一跳的MAC，而不是请求目标地址\n非同网段需要借助路由器的帮助\n免费ARP？\n免费告诉别人我的MAC地址\n免费 ARP（Gratuitous ARP）包是一种特殊的 ARP 请求，它并非期待得到 IP 对应的 MAC 地址\n免费 ARP 报文与普通 ARP 请求报文的区别在于报文中的目标 IP 地址。普通 ARP 报文中的目标 IP 地址是其他主机的 IP 地址；而免费 ARP 的请求报文中，目标 IP 地址是自己的 IP 地址。\nhttps://zhuanlan.zhihu.com/p/371088648\nARP代理？\n网络接入-IP协议 唯一标识，互联网通用。抖音客户端一个、抖音服务端一个\nMac地址不能替代IP地址吗？\nhttps://www.cnblogs.com/botoo/p/7793036.html\n IP地址是网络层使用的地址，它是分层次等级的。 硬件地址是数据链路层使用的地址(如MAC地址)，它是平面式的。  随着网络中的设备逐渐增多，人们发现路由（也就是寻找数据包从发送方到接收方的路径）变得越来越困难了\nMAC 地址就像自己的 ID 号，而 IP 地址就像带着邮政编码的住址，各有各的用途。所以我们需要两个地址，缺一不可。\nIPv4不够用，一般怎么解决？\nNAT、IPv6\n网络接入-NAT 家里路由器是怎样上网的？\n(Network Address Translation)网络地址转换\n私有地址（10 172 192）–公用地址\n该网络中的主机使用私用IP地址.当私有网络内部主机和外部Internet通信时,网关(gateway)路由器负责将私有IP地址转换为全球IP地址\n多个内网客户端访问同一个目标地址+端口，源端口恰好一样，冲突了？\nNAPT\n(Network Address and Port Translation)\n把端口也变了\n网络打通了怎么下载视频 网络传输-数据包 网络传输-数据包发送 网络传输-先请求DNS https://blog.csdn.net/weixin_43914604/article/details/105583806\n网络传输-DNS的传输协议UDP 由于过于简单，用好很难\n发包每次发多少？怎么避免切片？\nMTU（数据帧最大传输单元）有限制，∴要分片\n怎么知道没有丢包？\n怎么权衡传输效率与质量？\n网络传输-TCP三次握手 拔了网线，连接会断吗？\n看具体情况。\n假设TCP有探活，假设刚好在一次探活后拔了网线，不会立马断开\n你真的了解TCP三次握手？\n最大报文段长度（MSS）是TCP协议的一个选项，用于在TCP连接建立时，收发双方协商通信时每一个报文段所能承载的最大数据长度（不包括文段头）。为了避免IP切片\n区分MSS与MTU\n最大报文段长度（MSS）与最大传输单元（Maximum Transmission Unit, MTU）均是协议用来定义最大长度的。不同的是，MTU应用于OSI模型的第二层数据链接层，并无具体针对的协议。MTU限制了数据链接层上可以传输的数据包的大小，也因此限制了上层（网络层）的数据包大小。例如，如果已知某局域网的MTU为1500字节，则在网络层的因特网协议（Internet Protocol, IP）里，最大的数据包大小为1500字节（包含IP协议头）。MSS针对的是OSI模型里第四层传输层的TCP协议。因为MSS应用的协议在数据链接层的上层，MSS会受到MTU的限制\nTCP的有限状态机\n为什么老问你Timewait？\n等待足够的时间以确保远程 TCP 收到其连接终止请求的确认。\nhttps://blog.csdn.net/mystyle_/article/details/119176327\n丢包怎么办？\nhttps://blog.csdn.net/weixin_43914604/article/details/105524592\n滑动窗口\n流量控制/拥塞控制\nhttps://blog.csdn.net/weixin_43914604/article/details/105531547\nhttps://blog.csdn.net/weixin_43914604/article/details/105532044\n网络传输-HTTP/HTTP1.1 为什么不直接用TCP通信？\nTCP内容太多了，编程麻烦\n其实HTTP只是多加了一层规矩，HTTP仍然是TCP，只是这个规矩让用户更清晰\nhttps://www.cnblogs.com/heluan/p/8620312.html\nhttps://zhuanlan.zhihu.com/p/266578819\n网络传输-HTTPS 网络传输-SSL/TLS握手 https://www.jianshu.com/p/6811285c577d\n网络架构怎么给抖音提质？ 网络提速-HTTP2.0 网络提速-如何理解多路复用/stream 单个TCP链接传输\n实际上stream还是串行的\n如果TCP丢包怎么办？\nTCP队头阻塞，TCP有个option，可以指定ack的序列号，指定需要重传的\n网络提速-QUIC/HTTP3.0 TCP or UDP?\n改TCP动一发而牵全身\nKernel or Userspace?\n0RTT\n弱网优势\n网络提速-数据中心分布 核心机房\nPOP接入\n边缘机房\n汇聚机房\n网络提速-同运营商访问 网络提速-静态资源路径优化（CDN） Content Delivery Network，即内容分发网络\n网络提速-动态API路径优化（DSA） 网络稳定-容灾概念 故障发生\n故障感知\n自动切换\n服务恢复\n专线\n外网容灾\n云控？\nweb页面不能嵌入SDK、用户权限、\n网络稳定-故障排查 故障明确 出现了什么故障？-沟通是前提\n什么业务?什么接口障碍?\n故障体现在哪里？\n访问其他目标是否正常？\n是否是修改导致的异常？\n故障止损 先止损再排查\n分段排查 网络稳定-网络故障排查常用命令 课后作业1- UDP socket 实现 ack，感知丢包重传 作业要求：\n  学会 UDP socket 编程\n  先从简单的 ack 学习，客户端等待 ack 再发包\n  什么时候客户端认为是丢包？\n  重传怎么考虑效率？\n  能不能不阻塞只穿丢掉的中间的段？\n  课后作业2- 三台同网段内的服务器，模拟实现一个路由器 方法一: Linux 操作系统配置法\n提示：\n  了解Linux的路由配置方式\n  确保是同网段直连可达的环境。在三台机器上另外配置IP网段和路由\n  一台机器做客户端，一台机器做路由器，一台机器做服务端\n  客户端配置到达服务器的下一跳指向路由器，路由器上配置到达服务端的路由\n  方法二: 用户态 socket 编程实现简易 route 软件\n提示：\n  收到指定的包后，做转发\n  注意是修改报文的 MAC ，不是修改 IP\n  实现一个对称路由。这样可以实现 TCP 交互\n  可以通过 ping 来验证\n  可以支持 traceroute 吗？\n  正确答案： 课后作业1： 开放性问题，答案只要合理即可。具体实现可以参考\nhttps://github.com/networkprotocol/reliable\n根据作业要求的顺序一点点去实现，由简单ack功能入手到复杂的流控。\n课后作业2： 开放性问题，答案只要合理即可。具体实现可以参考：\n  静态路由表的注入可以在代码内用全局变量表示，也可以写一个配置文件去注入。\n  socket编程收raw包\n  解析raw包的IP层数据，根据静态路由表找到目标IP的下一跳\n  获取下一跳的MAC地址（linux有命令/系统调用接口，也可以自己实现简单的arp请求，保存目标MAC地址）\n  修改目标MAC地址为下一跳的MAC，修改源MAC地址为本机的出口网卡MAC。\n  ttl记得-1，然后转发数据包。\n  day7.2 如何将我的服务开放给用户 https://live.juejin.cn/4354/yc_open-serve\nhttps://bytedance.feishu.cn/file/boxcnUDmxxNLZjEd8oC17wFRRTe\n企业接入升级打怪之路\n域名系统 host管理的问题 流量和负载\n名称冲突\n时效性\n域名购买和配置迁移 自建DNS服务器 权威DNS系统 https://www.bilibili.com/video/BV1Mf4y1C7V8?spm_id_from=333.337.search-card.all.click\n常见的开源DNS：bind、nsd、knot、coredns\nHTTPS协议 HTTP明文传输，弊端越来愈明显\n对称加密和非对称加密 SSL的通信过程 证书链 接入全站加速 源站容量低，可承载的并发请求数低\n报文经过的网络设备越多，出问题的概率越大\n自主选路网络链路长\n静态加速CDN 动态加速DCDN 基于智能选路技术，从众多回源路线中择优选择一条路线进行传输\n四层负载均衡 https://blog.csdn.net/hanjinjuan/article/details/120274878\n七层负载均衡 https://www.cnblogs.com/cheyunhua/p/10670070.html\nhttps://blog.csdn.net/lamp_yang_3533/article/details/80383039\nday8.1 架构初探 https://live.juejin.cn/4354/yc_cake\nhttps://bytedance.feishu.cn/file/boxcne8xf0JBAiXgPJ08Vf0IdJg?hash=d3d3a460879da375f28cee06d470b5aa\n什么是架构 有关软件整体结构与组件的抽象描述\n用于指导软件系统各个方面的设计\n单机 All in one，所有的东西都在一个进程里，部署在一个机器上。\n优点：\n 简单  缺点：\n  运维需要停服，用户体验较差\n  承载能力有限。了解下 c10k 问题\n  单体、垂直切分 在单机架构的基础上，将进程部署到多个机器上。\n优点：\n  具备水平扩容能力\n  运维不需要停服\n  缺点：\n  后端进程职责太多，越来越臃肿\n  爆炸半径较大，进程中一个很小的模块出现问题，都可能导致整个进程崩溃\n  SOA SOA 架构中，服务为一等公民，将进程按照不同的功能单元进行抽象，拆分为『服务』。有了服务之后，SOA 还为服务之间的通信定义了标准，保证各个服务之间通讯体验的一致性。\n优点：\n  各服务的职责更清晰\n  运维粒度减小到服务，爆炸半径可控\n  缺点：\n ESB (企业服务总线) 往往需要一整套解决方案  微服务 在 SOA 架构中，ESB 起到了至关重要的作用。但从架构拓扑来看，它更像是一个集中式的模块。有一个 SOA 分布式演进的分支，最终的形态便是微服务。\n优点：\n  兼具 SOA 解决的问题\n  服务间的通信更敏捷、灵活\n  缺点：\n 运维成本 服务间通信成本问题； 数据一致性问题  小结   架构演进的初衷：满足软件迭代诉求，提高迭代效率\n  架构演进的思路：垂直切分——分布式，水平切分——分层/模块化\n  企业级后端架构剖析 https://www.zhihu.com/question/20387284\n云计算基础：   虚拟化技术\n 硬件层面（VM 虚拟机）- KVM/Xen/VMware 操作系统层面（Container 容器）- LCX/Docker/Kata Container 网络层面 - Linux Bridge/Open v Switch    编排方案\n VM - OpenStack/VMWare Workstation Container - Kubernetes/Docker Swarm    云计算架构：   云服务\n IaaS - 云基础设施，对底层硬件资源池的抽象 PaaS - 基于资源池抽象，对上层提供的弹性资源平台 SaaS - 基于弹性资源平台构建的云服务 FaaS - 更轻量级的函数服务。好比 LeetCode 等 OJ，刷题时只需要实现函数，不需要关注输入输出流    云部署模式（拓展）\n 私有云 - 企业自用 公有云 - AWS/Azure/Google Cloud/Huawei 混合云    云原生 云原生，实际是云原生（计算）的简称，它是元计算发展到现在的一种形态。\n云原生技术为组织（公司）在公有云、自由云、混合云等新型的动态环境中，构建和运行可弹性拓展的应用提供了可能。 它的代表技术：\n  弹性资源\n  微服务架构\n  DevOps\n  服务网格\n  弹性资源 基于虚拟化技术，提供的可以快速扩缩容的能力。可以分为弹性计算资源和弹性存储资源两个方面。 弹性计算资源：\n  计算资源调度\n 在线计算 - 互联网后端服务 离线计算 - 大数据分析。Map-Reduce/Spark/Flinnk    消息队列\n 在线队列 - 削峰、解耦 离线队列 - 结合数据分析的一整套方案，如 ELK    弹性存储资源：\n  经典存储\n 对象存储 - 视频、图片等。结合 CDN 等技术，可以为应用提供丰富的多媒体能力 大数据存储 - 应用日志、用户数据等。结合数据挖掘、机器学习等技术，提高应用的体验    关系型数据库\n  元数据\n 服务发现    NoSQL\n KV 存储 - Redis 文档存储 - Mongo    在云原生的大背景下，不论是计算资源还是存储资源，他们都像是服务一样供用户使用。\n微服务架构 微服务架构下，服务之间的通讯标准是基于协议而不是 ESB 的。\n  HTTP - H1/H2\n  RPC - Apache Thrift/gRPC\n  如何在 HTTP 和 RPC 之间选择？\n  性能 - RPC 协议往往具备较好的压缩率，性能较高。如 Thrift, Protocol Buffers\n  服务治理 - RPC 中间件往往集成了丰富的服务治理能力。如 熔断、降级、超时等\n  可解释性 - HTTP 通信的协议往往首选 JSON，可解释性、可调试性更好\n  服务网格 什么是服务网格？\n  微服务之间通讯的中间层\n  一个高性能的 4 层网络代理\n  将流量层面的逻辑与业务进程解耦\n  没有什么是加一层代理解决不了的问题，服务网格相比较于 RPC/HTTP 框架：\n  实现了异构系统治理体验的统一化\n  服务网格的数据平面代理与业务进程采取进程间通信的模式，使得流量相关的逻辑（包含治理）与业务进程解耦，生命周期也更容易管理\n  企业级后端架构的挑战 挑战 基础设施层面： Q：我们总说，云是弹性的，也就是说，在用户的角度，云提供的资源是无限的。然而，云背后的物理资源是有限的。在企业级后端架构里，云如何解决近乎无限的弹性资源和有限的物理资源之间的矛盾？\nQ：闲事的资源就这么空着呢？如何提高资源利用率，提高物理资源的价值转换率？\n用户层面： Q：上了云原生微服务后，服务之间的通信开销较大，应该如何做成本优化？\nQ：微服务看起来没有那么美好，抖动导致的运维成本较高，如何解决？\nQ：异构的物理环境应该对用户是透明的，如何屏蔽这些细节？\n离在线资源并池 考虑到在线业务的潮汐性，物理资源的用量不是一成不变的。离在线资源并池，可以：\n  提高物理资源利用率\n  提供更多的弹性资源\n  后端架构实践 day8.2 git https://bytedance.feishu.cn/file/boxcnsl8BgASj1TA9lzYb0TevEg?hash=8b34156117fb8fbc4eb72588c99e1adc\nhttps://live.juejin.cn/4354/yc_Git-posture\nday9 数据结构与算法 https://live.juejin.cn/4354/yc_data-correlation/preload\nhttps://bytedance.feishu.cn/file/boxcnZoRBfHvkwiwXC5qKft4L7b\n课后作业-实现 pdqsort-Version 1 作业要求：\n完成 PPT 中 pdqsort v1 版本，可以正确对元素排序\n正确答案： https://github.com/zhangyunhao116/sortlearning/blob/master/pdqsort.go\nday10.1 RPC框架 https://live.juejin.cn/4354/yc_RPC-framework/preload\nhttps://bytedance.feishu.cn/file/boxcnQ289aixfQUmvgtDDn98mmf\nRPC 相关的基本概念 RPC（Remote Procedure Call）远程过程调用协议，一种通过网络从远程计算机上请求服务，而不需要了解底层网络技术的协议。RPC它假定某些协议的存在，例如TPC/UDP等，为通信程序之间携带信息数据。在OSI网络七层模型中，RPC跨越了传输层和应用层，RPC使得开发，包括网络分布式多程序在内的应用程序更加容易。\n过程是什么？ 过程就是业务处理、计算任务，更直白的说，就是程序，就是想调用本地方法一样调用远程的过程\n==1：通讯协议== 比如：你需要找人在国外干活，那么你可以直接飞过去或者打电话或者通过互联网的形式，去找人，这个找人的过程就是通讯协议 ==2：寻址== 既然要找人干活，肯定要知道地址在哪，飞过去需要找到详细地址，打电话需要知道电话号码，互联网需要知道IP是多少 ==3：数据序列化== 就是说，语言需要互通，才能够让别人干活，之间需要一个大家都懂的语言去交流\n  RPC的概念模型：User、User-Stub、RPC-Runtime、Server-Stub、Server\n 来自论文《Implementing Remote Procedure Calls》    IDL(Interface Definition Language) 文件\n Thrift Protobuf    生成代码\n  编解码（序列化/反序列化）\n  通信协议\n 应用层协议    网络通信\n IO 网络模型  blocking IO unblocking IO IO multiplexing signal driven IO asynchronous IO   传输层协议  TCP UDP      RPC 框架的分层设计   编解码层\n 数据格式：  语言特定格式 文本格式 二进制编码  TLV 编码：Thrift 使用 TLV 编码 Varint 编码：Protobuf 使用 Varint 编码     选项：  兼容性 通用型 性能      传输协议层\n 消息切分  特殊结束符 变长协议：length+body   协议构造  以 Thrift 的 THeader 协议为例讲解      网络通信层\n 网络库 核心指标  吞吐高 延迟低      衡量 RPC 框架的一些核心指标   稳定性\n 保障策略  熔断 限流 超时   请求成功率  负载均衡 重试   长尾请求  BackupRequest      易用性\n 开箱即用 周边工具    扩展性\n  观测性\n Log Metric Tracing 内置观测性服务    高性能\n  字节内部 RPC 框架 Kitex 实践分享  Kitex 整体架构 自研网络库 Netpoll 性能优化：  网络库优化 编解码优化   合并部署  课后作业- 重点内容 Review   行业内各个流行的 RPC 框架的优劣对比？\n  从第三章节 RPC 的核心指标来看，Kitex 还有哪些功能是欠缺或者需要加强的？\n  了解微服务的新趋势 ServiceMesh，以及 RPC 框架和 ServiceMesh 的关系\n  关于 RPC 框架，业界有哪些新的趋势和概念？\n  Netpoll 的优势在哪？相比其他高性能网络库例如 Netty 还有什么不足？\n  Flatbuffer 和 Cap’n Proto 等编解码协议为什么高性能？\n  day10.2 HTTP修炼知道 https://live.juejin.cn/4354/yc_practise/preload\nhttps://bytedance.feishu.cn/file/boxcnfWxLoNVpn36D041DdKP6Vg\n再谈HTTP协议 HTTP框架的设计与实现 性能修炼之道 企业实践 课后作业-重点内容 Review 作业要求：\n  为什么 HTTP 框架做要分层设计？分层设计有哪些优势与劣势。\n  现有开源社区 HTTP 框架有哪些优势与不足。\n  中间件还有没有其他实现方式？可以用伪代码说明。\n  完成基于前缀路由树的注册与查找功能？可以用伪代码说明。\n  路由还有没有其他的实现方式？\n  正确答案： 该问题为开放性问题，答案合理即可。\n  优势：\n 分层设计可以提高框架的扩展性、可维护性、复用性 分层设计可以让相关同学聚焦在核心层上而不用关心其他层的实现 劣势： 提高代码设计的复杂性，设计不好可能会导致循环依赖 由于使用接口进行解耦，可能会对代码性能造成影响    gin：易用性强；生态丰富，但扩展性一般，性能一般。\n fasthttp：性能强；扩展性一般，生态一般。 go-zero：开箱即用，提供全套微服务能力，但扩展性一般，性能一般。    课程中讲的中间件模型需要有一个地方保存 index，对于没有 index 的场景，可以将中间件构造为递归函数进行调用。\n  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  // Endpoint represent one method for calling from remote. type Endpoint func ( ctx context.Context, req, resp interface {}) ( err error )  // Middleware deal with input Endpoint and output Endpoint. type Middleware func ( Endpoint ) Endpoint  // Chain connect middlewares into one middleware. func chain ( mws ...Middleware ) Middleware { return func ( next Endpoint ) Endpoint { for i := len ( mws ) - 1; i = 0; i-- { next = mws [ i ]( next ) } return next  } } 复制代码    伪代码如下，可以使用递归实现，也可以使用其他更高性能的实现，这里提供递归的实现方式。  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73  func ( r *router ) addRoute ( path string, h app.HandlersChain ) { // 检查 path 合理性  checkPathValid ( path ) // 循环添加 path 中的每一段  for i range len ( path ) { // 处理 : 类型参数路由  if path [ i ] == \":\" { // 添加 : 之前的静态路由  Insert ( path [ :i ] , staticKind, nil ) // 处理参数名称  paramNames.add ( paramName ) // 判断当前是否是路由 path 的最后一段  if last { // 插入最后一段  Insert ( path [ i: ] , paramKind, handler ) return  } else { // 不是最后一段，插入该段后继续插入之后的部分。  Insert ( path [ i: ] , paramKind, nil ) } // 处理 * 号类型参数路由  } else if path [ i ] == \"*\" { // 添加 * 路由之前的部分  Insert ( path [ :i ] , staticKind, nil ) // 处理参数名称  paramNames.add (paramName) // 添加最后一段  Insert ( path [ i: ] , allKind, handler ) return  } } // 添加最后的静态路由  Insert ( path [ i: ] , staticKind, handler ) }  func find ( path string ) () {  // 匹配静态路由  if matchStaticKind { nextSearchPath = handleStaticKind ( path, node ) path = nextSearchPath  } // 匹配 param 路由  if matchParamKind { nextSearchPath = handleParamKind ( path, node ) path = nextSearchPath  } // 匹配 * 路由  if matchAllKind { nextSearchPath = handleAllKind ( path, node ) path = nextSearchPath  } // 判断是否找到  if endcondition { return  }  // 递归搜索下一段静态路由  for node := range allStaticKindNodeChildren { if prefixMatch { node.find ( path ) } } // 搜索下一段 param 路由  if node.HasParamKindChild { node.find ( path)  } // 搜索下一段 * 路由  if node.HasAllKindChild { node.find ( path)  } return } 复制代码    可以尝试使用正则匹配的方式注册路由  day11.1 微服务框架 https://bytedance.feishu.cn/file/boxcnPjF5oJxpZh4ZQYDwVCSxib\n微服务架构介绍 微服务架构概览 微服务架构的核心要素 服务治理\n可观测性\n安全\n微服务架构原理及特征 基本概念 服务\n实例\n集群\n实例承载形式\n服务注册及发现 无损的服务实例上下线流程 微服务架构中的基本流量特征 核心服务治理功能 服务发布 流量治理 负载均衡 稳定性治理 字节跳动服务治理实践 重试\n课后作业- 重点内容 Review   结合 CAP 等原理，思考微服务架构有哪些缺陷？\n  微服务是否拆分得越“微”越好？为什么？\n  Service Mesh 这一架构是为了解决微服务架构的什么问题？\nhttps://philcalcado.com/2017/08/03/pattern_service_mesh.html\nhttps://zhuanlan.zhihu.com/p/61901608\n  有没有可能有这样一种架构，从开发上线运维体验上是微服务，但实际运行又类似单体服务？\n  day11.2消息队列 https://bytedance.feishu.cn/file/boxcnKXjTxtmdCpdidtJZGckf5b\nhttps://live.juejin.cn/4354/yc_message-queue/preload\n解耦：系统崩溃\n削峰：服务处理能力有限\n异步：链路耗时长尾\n日志处理：日志如何处理\n前世今生 消息队列：支持高吞吐、高并发、高可用的队列\n消息队列Kafka kafka使用场景，业务日志、用户行为数据、Metrics数据\n基本概念，Producer、Cluster、Consumer、Topic、Partition\n数据迁移、Offset、Partition选主\n一条消息从生产到消费是如何处理的，Producer端逻辑、Broker端逻辑、Consumer端逻辑\nProducer端逻辑 批量发送、数据压缩\nBroker端逻辑 顺序写、消息索引、零拷贝\nConsumer端逻辑 Rebalance\n问题：\n运维成本高\n对于负载不均衡的场景，解决方案复杂\n没有自己的缓存，完全依赖于Page Cache\n消息队列BMQ 课后作业：   消息队列的应用场景有哪些？\n  Kafka 的哪些 Feature 让其可以支撑大吞吐写入的场景？\n  Kafka Consumer Rebalance 的流程简述？\n  BMQ 相比较 Kafka 有哪些优势？\n  RocketMQ 有哪些特有的 Feature？\n  RocketMQ 事务消息处理流程简述？\n  你认为 MQ 后面应该如何发展？（开放题）\n  day12.1 分布式定时器 https://bytedance.feishu.cn/file/boxcnxSIthZayPmlXZWdYx845qg\n前言   每年春节抖音都会有很多有意思的玩法，如果同学们是字节的后端同学，怎么设计今年春节集卡瓜分20亿的技术方案？\n  业务流程\n 定时扫描抖音用户集卡状态 汇总计算用户的瓜分金额 定时开奖    技术体量\n 亿级用户规模 十亿级资金规模 百万级读写QPS    方案引出\n 自动化 + 定时执行 + 海量数据 + 高效稳定 = 分布式定时任务    发展历程 Windows批处理\nwindows任务计划程序\nLinux CronJob\n单机定时任务Timer\tTicker\n单机定时任务 ScheduledExecutorService\n任务调度Quartz\n分布式定时任务 定义  定时任务是指系统为了自动完成特定任务，实时、延时、周期性完成任务调度的过程。 分布式定时任务是把分散的、可靠性差的定时任务纳入统一的平台，并实现集群管理调度和分布式部署的一种定时任务的管理方式。  按触发时机分类： 定时任务：特定时间触发，比如今天15:06执行 延时任务：延时触发，比如10s后执行 周期任务：固定周期时间，或固定频率周期调度触发，比如每隔5s或者每天12点执行\n特点 自动化：全自动完成定时任务的调度和执行 平台化：基于平台化的思维管控一系列的分布式定时任务 分布式：在分布式系统环境下运行任务调度，突破单机定时任务的性能瓶颈 伸缩性：采用集群方式部署，可以随时按需扩缩容 高可用：单点故障不影响最终任务结果，可以做到故障转移\n执行模式 单机任务：随机触发一台机器执行任务，适用于计算量小、并发度低的任务 广播任务：广播到所有机器上执行同一个任务，比如所有机器一起清理日志 Map任务：一个任务可以分出多个子任务，每个子任务负责一部分的计算。适用于计算量大，单机无法满足要求的任务 MapReduce任务：在Map任务的基础上，还可以对所有子任务的结果做汇总计算，适用于计算量大，并且需要对子任务结果做汇总的任务\n分布式定时任务VS单机定时任务 关系： 都可以实现自动化的定时、延时、周期任务调度 差异： 分布式定时任务可支撑更大的业务体量 分布式定时任务的性能、伸缩性、稳定性更高\n分布式定时任务VS大数据处理引擎 关系： 都可以对海量数据做处理 性能、伸缩性、稳定性都很高 差异： 定时并不是大数据处理引擎要解决的核心问题 大数据处理引擎往往致力于将源数据处理成结果数据，分布式定时任务除了能做这个之外，还可以调用HTTP和RPC服务\n业内流行框架：Xxl-job、SchedulerX、TCT 实现原理 分布式定时任务核心要解决触发、调度、执行三个关键问题\n触发器：Trigger，解析任务，生成触发事件 调度器：Scheduler，分配任务，管理任务生命周期 执行器：Executor，获取执行任务单元，执行任务逻辑\n除此之外，还需要提供一个控制台（Admin），提供任务管理和干预的功能。\n基本概念 任务：Job，任务元数据 任务实例：JobInstance，周期任务会生成多个任务实例 任务结果：JobResult，任务实例运行的结果 任务历史：JobHistory，用户可以修改任务信息，任务实例对应的任务元数据可以不同，因而使用任务历史存储\n触发器 核心职责 给定一系列任务，解析它们的触发规则，在规定的时间点触发任务的调度\n设计约束 需支持大量任务 需支持秒级的调度 周期任务需要多次执行 需保证秒级扫描的高性能，并避免资源浪费\n方案一 定期扫描+延时消息（腾讯、字节方案）\n方案二 时间轮（ Quartz 所用方案） 时间轮是一种高效利用线程资源进行批量化调度的一种调度模型。时间轮是一个存储环形队列，底层采用数组实现，数组中的每个元素可以存放一个定时任务列表。\n多级时间轮\n触发器 高可用\n课后作业- 重点内容 Review   分布式定时任务可以帮助我们处理哪些业务场景？\n  春节集卡瓜分20亿的玩法，发奖金额计算、实时开奖两个阶段分别用到分布式定时任务什么执行方式？\n  有了分布式定时任务，单机定时任务还有适用场景么？\n  时间轮这种数据结构，在定时/延时场景相比其他数据结构有哪些优势？\n  分布式定时任务的调度中心怎么判断一台执行器的机器处于可被调度状态？\n  你能想到哪些业务场景，实时计算引擎优于分布式定时任务？\n  正确答案：   所有需要定时、延时、周期性执行任务的业务场景，都可以考虑使用分布式定时任务。在电商、游戏、互动等多个业务领域中都有广泛应用。\n  MapReduce任务和Map任务。由于发奖金额计算时需要汇总计算所有用户的集卡状态，因而在Map之后还需要对子任务的结果做汇总计算；而实时开奖则只需要对全量集齐的用户发奖即可。\n  有，比如定时刷新每台机器中的缓存、定期清理机器日志等。\n  相比于链表、最小堆，时间轮的查询和修改的时间复杂度都是O(1)。\n  执行器的机器首先需要调用调度中心的注册服务将本机器注册上去，并且需要定期状态上报供调度中心监控机器状态。\n  需要实时统计大规模流式数据，只需要做数据处理，无需调用RPC/HTTP接口做其他额外处理的业务场景，比较典型的例子是电商双十一的大屏，实时统计当前的GMV、订单量等\n  day12.2 存储与数据库 https://bytedance.feishu.cn/file/boxcn27GCEstXUOpBYFEpAY3EIh\n课后作业-实现一个（分布式）key-value 存储系统 作业要求：\n  基于本地文件系统实现，支持常用的 put(k, v)、get(k, v)、scan_by_prefix(prefix) 接口\n  支持存储 server 独立进程部署，支持跨进程或者网络访问\n  IO 操作做到低时延\n  *可选： 支持扩展成分布式架构，多台存储server组成一个分布式key-value存储系统，并保证全局的数据一致性。\nday13 深入理解RDBMS https://bytedance.feishu.cn/file/boxcnXzUnOJI7nUFhvBMTW9sfBh?hash=a90b5ab6be81c4d6ca20bf103bd9ab65\n课后作业- 重点内容 Review   WAL 日志到底是如何保证数据的持久化，宕机后数据不丢失的？\n  相比于其他方案，WAL 日志都有什么优势？\n  除了 Undo Log 之外，是否还有其他方案可以实现 MVCC？\n  基于代价的优化器一般需要考虑哪些代价？\n  执行器的执行模型，除了本课中提到的火山模型是否还有其他模型？\n  B+ Tree的优点有哪些？\n  InnoDB 的 buffer pool 是怎么实现页面管理和淘汰的？\n  正确答案：   WAL是预写日志，需要保证日志落盘才能够进行事务提交。日志中包含了事务对数据的修改，宕机后通过解析WAL日志，就可以对数据进行恢复。\n  相比于每次事务提交时都对数据页面进行flush操作，WAL日志有以下优点：\n 解决了IO放大的问题。 随机读写变为顺序读写，对磁盘更友好。    除了Undo Log之外，还有shadow paging的方式。例如PostgreSQL就是采用这种方式。这种方式的特点是，在数据页面中同时保留了一行数据的多个历史版本，通过trx_id来区分。\n  基于代价的优化器一般需要考虑IO消耗、网络消耗、CPU消耗等。\n  常见的执行模型有三类：火山模型(Volcano Model/Pipeline Model/Iterator Model/Pull Model)、物化模型(Materialization Model/Push Model)、向量化模型(Vectorized / Batch Model)。\n  B+树的优点如下：\n B+树内部节点不存储数据，只存储键值，这样，每个节点就能存储更多的键值，一次性也就能将更多的键值读入内存，减少了对磁盘的IO操作次数； B+树的叶节点有一条链相连，所以对于区间内查询数据比较高效。    InnoDB的buffer pool通过一个hash_map来实现页面的快速查找访问，通过一个LRU来实现页面的冷热淘汰管理。\n  day14.1 TOS对象存储 https://live.juejin.cn/4354/yc_TOS\nhttps://bytedance.feishu.cn/file/boxcn3SOO7DkrVWzb93qx08jtch\n课后作业-实现一个对象存储客户端 作业要求：\n  在任意一个公有云中申请一个对象存储 Bucket\n  使用你熟悉的语言，实现一个对象存储命令行客户端，要求该客户端能够\n 创建对象：超过 1GB 的对象使用 MultiUpload 上传，小于 1GB 的使用 Put 上传 下载对象 删除对象 查看对象是否存在 列举对象及 CommonPrefix    ",
  "wordCount" : "18595",
  "inLanguage": "en",
  "datePublished": "2022-05-06T10:00:50+08:00",
  "dateModified": "2022-05-06T10:00:50+08:00",
  "author":[{
    "@type": "Person",
    "name": "kevin"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://kevinerr.github.io/posts/tech/%E5%AD%97%E8%8A%82%E9%9D%92%E8%AE%AD%E8%90%A5/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "hkh's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://kevinerr.github.io/img/Q.jpg"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://kevinerr.github.io/" accesskey="h" title="hkh&#39;s Blog (Alt + H)">hkh&#39;s Blog</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://kevinerr.github.io/search" title="🔍搜索 (Alt &#43; /)" accesskey=/>
                    <span>🔍搜索</span>
                </a>
            </li>
            <li>
                <a href="https://kevinerr.github.io/" title="🏠主页">
                    <span>🏠主页</span>
                </a>
            </li>
            <li>
                <a href="https://kevinerr.github.io/posts" title="📚文章">
                    <span>📚文章</span>
                </a>
            </li>
            <li>
                <a href="https://kevinerr.github.io/archives" title="⏱时间轴">
                    <span>⏱时间轴</span>
                </a>
            </li>
            <li>
                <a href="https://kevinerr.github.io/tags" title="🔖标签">
                    <span>🔖标签</span>
                </a>
            </li>
            <li>
                <a href="https://kevinerr.github.io/about" title="🙋🏻‍♂️关于">
                    <span>🙋🏻‍♂️关于</span>
                </a>
            </li>
            <li>
                <a href="https://kevinerr.github.io/links" title="🤝友链">
                    <span>🤝友链</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://kevinerr.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://kevinerr.github.io/posts/">📚文章</a>&nbsp;»&nbsp;<a href="https://kevinerr.github.io/posts/tech/">👨🏻‍💻技术</a></div>
    <h1 class="post-title">
      字节青训营
    </h1>
    <div class="post-meta">










创建:&nbsp;<span title='2022-05-06 10:00:50 +0800 CST'>2022-05-06</span>&nbsp;|&nbsp;更新:&nbsp;2022-05-06&nbsp;|&nbsp;字数:&nbsp;18595字&nbsp;|&nbsp;时长: 38分钟&nbsp;|&nbsp;
作者:&nbsp;kevin

</div>
  </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">Table of Contents</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#day1-go%e8%af%ad%e8%a8%80%e4%b8%8a%e6%89%8b-%e5%9f%ba%e7%a1%80%e8%af%ad%e8%a8%80" aria-label="day1 go语言上手-基础语言">day1 go语言上手-基础语言</a><ul>
                            
                    <li>
                        <a href="#%e9%9a%8f%e6%9c%ba%e6%95%b0" aria-label="随机数">随机数</a></li>
                    <li>
                        <a href="#%e8%be%93%e5%85%a5" aria-label="输入">输入</a></li>
                    <li>
                        <a href="#%e8%87%aa%e5%8a%a8%e7%94%9f%e6%88%90%e7%88%ac%e8%99%ab%e4%bb%a3%e7%a0%81" aria-label="自动生成爬虫代码">自动生成爬虫代码</a></li>
                    <li>
                        <a href="#socks5" aria-label="SOCKS5">SOCKS5</a></li></ul>
                    </li>
                    <li>
                        <a href="#day2-go%e8%af%ad%e8%a8%80%e4%b8%8a%e6%89%8b-%e5%ba%94%e7%94%a8%e5%ae%9e%e8%b7%b5" aria-label="day2 go语言上手-应用实践">day2 go语言上手-应用实践</a><ul>
                            
                    <li>
                        <a href="#go%e4%be%9d%e8%b5%96%e7%ae%a1%e7%90%86%e5%bc%95%e8%bf%9b" aria-label="go依赖管理引进">go依赖管理引进</a><ul>
                            
                    <li>
                        <a href="#2%e4%b8%aa%e7%9b%ae%e6%a0%87" aria-label="2个目标">2个目标</a></li>
                    <li>
                        <a href="#gopath" aria-label="GOPATH">GOPATH</a></li>
                    <li>
                        <a href="#go-vendor" aria-label="GO Vendor">GO Vendor</a></li>
                    <li>
                        <a href="#go-module" aria-label="GO Module">GO Module</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e6%b5%8b%e8%af%95" aria-label="测试">测试</a><ul>
                            
                    <li>
                        <a href="#%e5%8d%95%e5%85%83%e6%b5%8b%e8%af%95" aria-label="单元测试">单元测试</a><ul>
                            
                    <li>
                        <a href="#assert" aria-label="assert">assert</a></li>
                    <li>
                        <a href="#%e8%a6%86%e7%9b%96%e7%8e%87" aria-label="覆盖率">覆盖率</a></li></ul>
                    </li>
                    <li>
                        <a href="#mock%e6%b5%8b%e8%af%95" aria-label="Mock测试">Mock测试</a></li>
                    <li>
                        <a href="#%e5%9f%ba%e5%87%86%e6%b5%8b%e8%af%95" aria-label="基准测试">基准测试</a></li></ul>
                    </li></ul>
                    </li>
                    <li>
                        <a href="#day3-%e9%ab%98%e8%b4%a8%e9%87%8f%e7%bc%96%e7%a8%8b%e4%b8%8e%e6%80%a7%e8%83%bd%e8%b0%83%e4%bc%98%e5%ae%9e%e6%88%98" aria-label="day3 高质量编程与性能调优实战">day3 高质量编程与性能调优实战</a><ul>
                            
                    <li>
                        <a href="#%e9%ab%98%e8%b4%a8%e9%87%8f%e7%bc%96%e7%a8%8b" aria-label="高质量编程">高质量编程</a><ul>
                            
                    <li>
                        <a href="#%e7%bc%96%e7%a0%81%e8%a7%84%e8%8c%83" aria-label="编码规范">编码规范</a><ul>
                            
                    <li>
                        <a href="#%e4%bb%a3%e7%a0%81%e6%a0%bc%e5%bc%8f" aria-label="代码格式">代码格式</a></li>
                    <li>
                        <a href="#%e6%b3%a8%e9%87%8a" aria-label="注释">注释</a></li>
                    <li>
                        <a href="#%e5%91%bd%e5%90%8d%e8%a7%84%e8%8c%83" aria-label="命名规范">命名规范</a></li>
                    <li>
                        <a href="#%e6%8e%a7%e5%88%b6%e6%b5%81%e7%a8%8b" aria-label="控制流程">控制流程</a></li>
                    <li>
                        <a href="#%e9%94%99%e8%af%af%e5%92%8c%e5%bc%82%e5%b8%b8%e5%a4%84%e7%90%86" aria-label="错误和异常处理">错误和异常处理</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e5%bb%ba%e8%ae%ae" aria-label="性能优化建议">性能优化建议</a><ul>
                            
                    <li>
                        <a href="#benchmark" aria-label="benchmark">benchmark</a></li>
                    <li>
                        <a href="#slice" aria-label="Slice">Slice</a></li>
                    <li>
                        <a href="#map" aria-label="Map">Map</a></li>
                    <li>
                        <a href="#%e5%ad%97%e7%ac%a6%e4%b8%b2%e5%a4%84%e7%90%86" aria-label="字符串处理">字符串处理</a></li>
                    <li>
                        <a href="#%e7%a9%ba%e7%bb%93%e6%9e%84%e4%bd%93" aria-label="空结构体">空结构体</a></li>
                    <li>
                        <a href="#atomic%e5%8c%85" aria-label="atomic包">atomic包</a></li></ul>
                    </li></ul>
                    </li>
                    <li>
                        <a href="#%e6%80%a7%e8%83%bd%e8%b0%83%e4%bc%98%e5%ae%9e%e6%88%98" aria-label="性能调优实战">性能调优实战</a><ul>
                            
                    <li>
                        <a href="#pprof%e5%ae%9e%e6%88%98" aria-label="pprof实战">pprof实战</a></li>
                    <li>
                        <a href="#pprof%e9%87%87%e6%a0%b7%e8%bf%87%e7%a8%8b%e5%92%8c%e5%8e%9f%e7%90%86" aria-label="pprof采样过程和原理">pprof采样过程和原理</a></li>
                    <li>
                        <a href="#%e6%80%a7%e8%83%bd%e8%b0%83%e4%bc%98%e6%a1%88%e4%be%8b" aria-label="性能调优案例">性能调优案例</a><ul>
                            
                    <li>
                        <a href="#%e4%b8%9a%e5%8a%a1%e6%9c%8d%e5%8a%a1%e4%bc%98%e5%8c%96" aria-label="业务服务优化">业务服务优化</a></li></ul>
                    </li></ul>
                    </li>
                    <li>
                        <a href="#%e8%af%be%e5%90%8e%e4%bd%9c%e4%b8%9a-%e9%87%8d%e7%82%b9%e5%86%85%e5%ae%b9-review" aria-label="课后作业-重点内容 Review">课后作业-重点内容 Review</a></li>
                    <li>
                        <a href="#%e6%ad%a3%e7%a1%ae%e7%ad%94%e6%a1%88" aria-label="正确答案：">正确答案：</a></li></ul>
                    </li>
                    <li>
                        <a href="#day4-%e9%ab%98%e6%80%a7%e8%83%bdgo%e8%af%ad%e8%a8%80%e5%8f%91%e8%a1%8c%e7%89%88%e4%bc%98%e5%8c%96%e4%b8%8e%e8%90%bd%e5%9c%b0%e5%ae%9e%e8%b7%b5" aria-label="day4 高性能go语言发行版优化与落地实践">day4 高性能go语言发行版优化与落地实践</a><ul>
                            
                    <li>
                        <a href="#%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e7%9a%84%e5%9f%ba%e6%9c%ac%e9%97%ae%e9%a2%98" aria-label="性能优化的基本问题">性能优化的基本问题</a></li>
                    <li>
                        <a href="#%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e7%9a%842%e4%b8%aa%e5%b1%82%e9%9d%a2" aria-label="性能优化的2个层面">性能优化的2个层面</a></li>
                    <li>
                        <a href="#%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e7%9a%84%e5%8f%af%e7%bb%b4%e6%8a%a4%e6%80%a7" aria-label="性能优化的可维护性">性能优化的可维护性</a></li>
                    <li>
                        <a href="#%e8%87%aa%e5%8a%a8%e5%86%85%e5%ad%98%e7%ae%a1%e7%90%86" aria-label="自动内存管理">自动内存管理</a><ul>
                            
                    <li>
                        <a href="#%e5%88%86%e4%bb%a3gc" aria-label="分代GC">分代GC</a></li>
                    <li>
                        <a href="#%e5%bc%95%e7%94%a8%e8%ae%a1%e6%95%b0" aria-label="引用计数">引用计数</a></li></ul>
                    </li>
                    <li>
                        <a href="#go%e5%86%85%e5%ad%98%e7%ae%a1%e7%90%86%e5%8f%8a%e4%bc%98%e5%8c%96" aria-label="go内存管理及优化">go内存管理及优化</a><ul>
                            
                    <li>
                        <a href="#%e5%88%86%e5%9d%97" aria-label="分块">分块</a></li>
                    <li>
                        <a href="#%e7%bc%93%e5%ad%98" aria-label="缓存">缓存</a></li>
                    <li>
                        <a href="#go%e5%af%b9%e8%b1%a1%e5%88%86%e9%85%8d%e7%9a%84%e6%80%a7%e8%83%bd%e9%97%ae%e9%a2%98" aria-label="Go对象分配的性能问题">Go对象分配的性能问题</a></li>
                    <li>
                        <a href="#balanced-gc" aria-label="Balanced GC">Balanced GC</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e7%bc%96%e8%af%91%e5%99%a8%e5%92%8c%e9%9d%99%e6%80%81%e5%88%86%e6%9e%90" aria-label="编译器和静态分析">编译器和静态分析</a><ul>
                            
                    <li>
                        <a href="#%e7%bc%96%e8%af%91%e5%99%a8%e7%9a%84%e7%bb%93%e6%9e%84%e4%b8%8e%e7%bc%96%e8%af%91%e7%9a%84%e6%b5%81%e7%a8%8b" aria-label="编译器的结构与编译的流程">编译器的结构与编译的流程</a></li>
                    <li>
                        <a href="#%e7%bc%96%e8%af%91%e5%99%a8%e5%90%8e%e7%ab%af%e4%bc%98%e5%8c%96" aria-label="编译器后端优化">编译器后端优化</a></li>
                    <li>
                        <a href="#%e6%95%b0%e6%8d%ae%e6%b5%81%e5%92%8c%e6%8e%a7%e5%88%b6%e6%b5%81%e5%88%86%e6%9e%90" aria-label="数据流和控制流分析">数据流和控制流分析</a></li>
                    <li>
                        <a href="#%e8%bf%87%e7%a8%8b%e5%86%85%e5%92%8c%e8%bf%87%e7%a8%8b%e9%97%b4%e5%88%86%e6%9e%90" aria-label="过程内和过程间分析">过程内和过程间分析</a></li></ul>
                    </li>
                    <li>
                        <a href="#go%e7%bc%96%e8%af%91%e5%99%a8%e4%bc%98%e5%8c%96" aria-label="go编译器优化">go编译器优化</a><ul>
                            
                    <li>
                        <a href="#tradeoff" aria-label="Tradeoff">Tradeoff</a></li>
                    <li>
                        <a href="#beast-mode" aria-label="Beast mode">Beast mode</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e8%af%be%e5%90%8e%e4%bd%9c%e4%b8%9a--%e9%87%8d%e7%82%b9%e5%86%85%e5%ae%b9-review" aria-label="课后作业- 重点内容 Review">课后作业- 重点内容 Review</a></li>
                    <li>
                        <a href="#%e6%ad%a3%e7%a1%ae%e7%ad%94%e6%a1%88-1" aria-label="正确答案：">正确答案：</a></li></ul>
                    </li>
                    <li>
                        <a href="#day5-gorm" aria-label="day5 GORM">day5 GORM</a><ul>
                            
                    <li>
                        <a href="#%e7%90%86%e8%a7%a3databasesql" aria-label="理解database/sql">理解database/sql</a><ul>
                            
                    <li>
                        <a href="#%e5%9f%ba%e6%9c%ac%e7%94%a8%e6%b3%95" aria-label="基本用法">基本用法</a></li>
                    <li>
                        <a href="#%e8%ae%be%e8%ae%a1%e5%8e%9f%e7%90%86" aria-label="设计原理">设计原理</a></li>
                    <li>
                        <a href="#%e5%9f%ba%e7%a1%80%e6%a6%82%e5%bf%b5" aria-label="基础概念">基础概念</a></li></ul>
                    </li>
                    <li>
                        <a href="#gorm%e4%bd%bf%e7%94%a8%e7%ae%80%e4%bb%8b" aria-label="GORM使用简介">GORM使用简介</a><ul>
                            
                    <li>
                        <a href="#%e5%9f%ba%e6%9c%ac%e7%94%a8%e6%b3%95-1" aria-label="基本用法">基本用法</a></li>
                    <li>
                        <a href="#model%e5%ae%9a%e4%b9%89" aria-label="Model定义">Model定义</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e6%83%af%e4%be%8b%e7%ba%a6%e5%ae%9a" aria-label="惯例约定">惯例约定</a><ul>
                            
                    <li>
                        <a href="#%e5%85%b3%e8%81%94" aria-label="关联">关联</a></li></ul>
                    </li>
                    <li>
                        <a href="#gorm%e8%ae%be%e8%ae%a1%e5%8e%9f%e7%90%86" aria-label="GORM设计原理">GORM设计原理</a><ul>
                            
                    <li>
                        <a href="#sql%e7%94%9f%e6%88%90" aria-label="SQL生成">SQL生成</a></li>
                    <li>
                        <a href="#%e6%8f%92%e4%bb%b6%e6%89%a9%e5%b1%95" aria-label="插件扩展">插件扩展</a></li>
                    <li>
                        <a href="#connpool" aria-label="ConnPool">ConnPool</a></li>
                    <li>
                        <a href="#dialector" aria-label="Dialector">Dialector</a></li></ul>
                    </li>
                    <li>
                        <a href="#gorm%e6%9c%80%e4%bd%b3%e5%ae%9e%e8%b7%b5" aria-label="GORM最佳实践">GORM最佳实践</a></li>
                    <li>
                        <a href="#%e8%af%be%e5%90%8e%e4%bd%9c%e4%b8%9a" aria-label="课后作业">课后作业</a></li>
                    <li>
                        <a href="#%e6%ad%a3%e7%a1%ae%e7%ad%94%e6%a1%88-2" aria-label="正确答案：">正确答案：</a></li></ul>
                    </li>
                    <li>
                        <a href="#day61-%e5%ae%9e%e6%88%98%e9%a1%b9%e7%9b%ae" aria-label="day6.1 实战项目">day6.1 实战项目</a></li>
                    <li>
                        <a href="#day62-%e4%bb%8e%e9%9c%80%e6%b1%82%e5%88%b0%e4%b8%8a%e7%ba%bf%e5%85%a8%e6%b5%81%e7%a8%8b" aria-label="day6.2 从需求到上线全流程">day6.2 从需求到上线全流程</a><ul>
                            
                    <li>
                        <a href="#%e4%b8%ba%e4%bb%80%e4%b9%88%e8%a6%81%e6%9c%89%e6%b5%81%e7%a8%8b" aria-label="为什么要有流程">为什么要有流程</a><ul>
                            
                    <li>
                        <a href="#%e5%90%8e%e7%ab%af%e7%9a%84%e5%ae%9a%e4%bd%8d" aria-label="后端的定位">后端的定位</a></li>
                    <li>
                        <a href="#%e5%9b%a2%e9%98%9f%e5%8d%8f%e4%bd%9c" aria-label="团队协作">团队协作</a></li></ul>
                    </li>
                    <li>
                        <a href="#2-%e6%9c%89%e5%93%aa%e4%ba%9b%e6%b5%81%e7%a8%8b" aria-label="2. 有哪些流程">2. 有哪些流程</a><ul>
                            
                    <li>
                        <a href="#%e9%9c%80%e6%b1%82%e9%98%b6%e6%ae%b5" aria-label="需求阶段">需求阶段</a></li>
                    <li>
                        <a href="#%e5%bc%80%e5%8f%91%e9%98%b6%e6%ae%b5" aria-label="开发阶段">开发阶段</a></li>
                    <li>
                        <a href="#%e6%b5%8b%e8%af%95%e9%98%b6%e6%ae%b5" aria-label="测试阶段">测试阶段</a></li>
                    <li>
                        <a href="#%e5%8f%91%e5%b8%83%e9%98%b6%e6%ae%b5" aria-label="发布阶段">发布阶段</a></li>
                    <li>
                        <a href="#%e8%bf%90%e7%bb%b4%e9%98%b6%e6%ae%b5" aria-label="运维阶段">运维阶段</a></li></ul>
                    </li>
                    <li>
                        <a href="#3-%e6%80%8e%e6%a0%b7%e6%89%a7%e8%a1%8c%e6%b5%81%e7%a8%8b" aria-label="3. 怎样执行流程">3. 怎样执行流程</a><ul>
                            
                    <li>
                        <a href="#devops" aria-label="DevOps">DevOps</a></li>
                    <li>
                        <a href="#%e5%85%a8%e6%b5%81%e7%a8%8b%e8%87%aa%e5%8a%a8%e5%8c%96" aria-label="全流程自动化">全流程自动化</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e5%8f%82%e8%80%83%e6%96%87%e7%8c%ae" aria-label="参考文献">参考文献</a></li>
                    <li>
                        <a href="#%e8%af%be%e5%90%8e%e4%bd%9c%e4%b8%9a-1" aria-label="课后作业：">课后作业：</a></li>
                    <li>
                        <a href="#%e6%ad%a3%e7%a1%ae%e7%ad%94%e6%a1%88-3" aria-label="正确答案：">正确答案：</a></li></ul>
                    </li>
                    <li>
                        <a href="#day71-%e8%ae%a1%e7%ae%97%e6%9c%ba%e7%bd%91%e7%bb%9c%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5" aria-label="day7.1 计算机网络基本概念">day7.1 计算机网络基本概念</a><ul>
                            
                    <li>
                        <a href="#%e5%88%b7%e6%8a%96%e9%9f%b3%e7%bd%91%e7%bb%9c%e6%98%af%e6%80%8e%e4%b9%88%e4%ba%a4%e4%ba%92%e7%9a%84" aria-label="刷抖音网络是怎么交互的？">刷抖音网络是怎么交互的？</a></li>
                    <li>
                        <a href="#%e6%80%8e%e4%b9%88%e8%ae%a9%e6%88%91%e7%9a%84%e6%89%8b%e6%9c%ba%e8%83%bd%e8%ae%bf%e9%97%ae%e6%8a%96%e9%9f%b3%e6%9c%8d%e5%8a%a1%e5%99%a8" aria-label="怎么让我的手机能访问抖音服务器">怎么让我的手机能访问抖音服务器</a><ul>
                            
                    <li>
                        <a href="#%e7%bd%91%e7%bb%9c%e6%8e%a5%e5%85%a5-%e4%ba%92%e8%81%94%e7%bd%91" aria-label="网络接入-互联网">网络接入-互联网</a></li>
                    <li>
                        <a href="#%e7%bd%91%e7%bb%9c%e6%8e%a5%e5%85%a5-%e8%b7%af%e7%94%b1" aria-label="网络接入-路由">网络接入-路由</a></li>
                    <li>
                        <a href="#%e7%bd%91%e7%bb%9c%e6%8e%a5%e5%85%a5-arp%e5%8d%8f%e8%ae%ae" aria-label="网络接入-ARP协议">网络接入-ARP协议</a></li>
                    <li>
                        <a href="#%e7%bd%91%e7%bb%9c%e6%8e%a5%e5%85%a5-ip%e5%8d%8f%e8%ae%ae" aria-label="网络接入-IP协议">网络接入-IP协议</a></li>
                    <li>
                        <a href="#%e7%bd%91%e7%bb%9c%e6%8e%a5%e5%85%a5-nat" aria-label="网络接入-NAT">网络接入-NAT</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e7%bd%91%e7%bb%9c%e6%89%93%e9%80%9a%e4%ba%86%e6%80%8e%e4%b9%88%e4%b8%8b%e8%bd%bd%e8%a7%86%e9%a2%91" aria-label="网络打通了怎么下载视频">网络打通了怎么下载视频</a><ul>
                            
                    <li>
                        <a href="#%e7%bd%91%e7%bb%9c%e4%bc%a0%e8%be%93-%e6%95%b0%e6%8d%ae%e5%8c%85" aria-label="网络传输-数据包">网络传输-数据包</a></li>
                    <li>
                        <a href="#%e7%bd%91%e7%bb%9c%e4%bc%a0%e8%be%93-%e6%95%b0%e6%8d%ae%e5%8c%85%e5%8f%91%e9%80%81" aria-label="网络传输-数据包发送">网络传输-数据包发送</a></li>
                    <li>
                        <a href="#%e7%bd%91%e7%bb%9c%e4%bc%a0%e8%be%93-%e5%85%88%e8%af%b7%e6%b1%82dns" aria-label="网络传输-先请求DNS">网络传输-先请求DNS</a></li>
                    <li>
                        <a href="#%e7%bd%91%e7%bb%9c%e4%bc%a0%e8%be%93-dns%e7%9a%84%e4%bc%a0%e8%be%93%e5%8d%8f%e8%ae%aeudp" aria-label="网络传输-DNS的传输协议UDP">网络传输-DNS的传输协议UDP</a></li>
                    <li>
                        <a href="#%e7%bd%91%e7%bb%9c%e4%bc%a0%e8%be%93-tcp%e4%b8%89%e6%ac%a1%e6%8f%a1%e6%89%8b" aria-label="网络传输-TCP三次握手">网络传输-TCP三次握手</a></li>
                    <li>
                        <a href="#%e7%bd%91%e7%bb%9c%e4%bc%a0%e8%be%93-httphttp11" aria-label="网络传输-HTTP/HTTP1.1">网络传输-HTTP/HTTP1.1</a></li>
                    <li>
                        <a href="#%e7%bd%91%e7%bb%9c%e4%bc%a0%e8%be%93-https" aria-label="网络传输-HTTPS">网络传输-HTTPS</a></li>
                    <li>
                        <a href="#%e7%bd%91%e7%bb%9c%e4%bc%a0%e8%be%93-ssltls%e6%8f%a1%e6%89%8b" aria-label="网络传输-SSL/TLS握手">网络传输-SSL/TLS握手</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e7%bd%91%e7%bb%9c%e6%9e%b6%e6%9e%84%e6%80%8e%e4%b9%88%e7%bb%99%e6%8a%96%e9%9f%b3%e6%8f%90%e8%b4%a8" aria-label="网络架构怎么给抖音提质？">网络架构怎么给抖音提质？</a><ul>
                            
                    <li>
                        <a href="#%e7%bd%91%e7%bb%9c%e6%8f%90%e9%80%9f-http20" aria-label="网络提速-HTTP2.0">网络提速-HTTP2.0</a></li>
                    <li>
                        <a href="#%e7%bd%91%e7%bb%9c%e6%8f%90%e9%80%9f-%e5%a6%82%e4%bd%95%e7%90%86%e8%a7%a3%e5%a4%9a%e8%b7%af%e5%a4%8d%e7%94%a8stream" aria-label="网络提速-如何理解多路复用/stream">网络提速-如何理解多路复用/stream</a></li>
                    <li>
                        <a href="#%e7%bd%91%e7%bb%9c%e6%8f%90%e9%80%9f-quichttp30" aria-label="网络提速-QUIC/HTTP3.0">网络提速-QUIC/HTTP3.0</a></li>
                    <li>
                        <a href="#%e7%bd%91%e7%bb%9c%e6%8f%90%e9%80%9f-%e6%95%b0%e6%8d%ae%e4%b8%ad%e5%bf%83%e5%88%86%e5%b8%83" aria-label="网络提速-数据中心分布">网络提速-数据中心分布</a></li>
                    <li>
                        <a href="#%e7%bd%91%e7%bb%9c%e6%8f%90%e9%80%9f-%e5%90%8c%e8%bf%90%e8%90%a5%e5%95%86%e8%ae%bf%e9%97%ae" aria-label="网络提速-同运营商访问">网络提速-同运营商访问</a></li>
                    <li>
                        <a href="#%e7%bd%91%e7%bb%9c%e6%8f%90%e9%80%9f-%e9%9d%99%e6%80%81%e8%b5%84%e6%ba%90%e8%b7%af%e5%be%84%e4%bc%98%e5%8c%96cdn" aria-label="网络提速-静态资源路径优化（CDN）">网络提速-静态资源路径优化（CDN）</a></li>
                    <li>
                        <a href="#%e7%bd%91%e7%bb%9c%e6%8f%90%e9%80%9f-%e5%8a%a8%e6%80%81api%e8%b7%af%e5%be%84%e4%bc%98%e5%8c%96dsa" aria-label="网络提速-动态API路径优化（DSA）">网络提速-动态API路径优化（DSA）</a></li>
                    <li>
                        <a href="#%e7%bd%91%e7%bb%9c%e7%a8%b3%e5%ae%9a-%e5%ae%b9%e7%81%be%e6%a6%82%e5%bf%b5" aria-label="网络稳定-容灾概念">网络稳定-容灾概念</a></li>
                    <li>
                        <a href="#%e7%bd%91%e7%bb%9c%e7%a8%b3%e5%ae%9a-%e6%95%85%e9%9a%9c%e6%8e%92%e6%9f%a5" aria-label="网络稳定-故障排查">网络稳定-故障排查</a><ul>
                            
                    <li>
                        <a href="#%e6%95%85%e9%9a%9c%e6%98%8e%e7%a1%ae" aria-label="故障明确">故障明确</a></li>
                    <li>
                        <a href="#%e6%95%85%e9%9a%9c%e6%ad%a2%e6%8d%9f" aria-label="故障止损">故障止损</a></li>
                    <li>
                        <a href="#%e5%88%86%e6%ae%b5%e6%8e%92%e6%9f%a5" aria-label="分段排查">分段排查</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e7%bd%91%e7%bb%9c%e7%a8%b3%e5%ae%9a-%e7%bd%91%e7%bb%9c%e6%95%85%e9%9a%9c%e6%8e%92%e6%9f%a5%e5%b8%b8%e7%94%a8%e5%91%bd%e4%bb%a4" aria-label="网络稳定-网络故障排查常用命令">网络稳定-网络故障排查常用命令</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e8%af%be%e5%90%8e%e4%bd%9c%e4%b8%9a1--udp-socket-%e5%ae%9e%e7%8e%b0-ack%e6%84%9f%e7%9f%a5%e4%b8%a2%e5%8c%85%e9%87%8d%e4%bc%a0" aria-label="课后作业1- UDP socket 实现 ack，感知丢包重传">课后作业1- UDP socket 实现 ack，感知丢包重传</a></li>
                    <li>
                        <a href="#%e8%af%be%e5%90%8e%e4%bd%9c%e4%b8%9a2--%e4%b8%89%e5%8f%b0%e5%90%8c%e7%bd%91%e6%ae%b5%e5%86%85%e7%9a%84%e6%9c%8d%e5%8a%a1%e5%99%a8%e6%a8%a1%e6%8b%9f%e5%ae%9e%e7%8e%b0%e4%b8%80%e4%b8%aa%e8%b7%af%e7%94%b1%e5%99%a8" aria-label="课后作业2- 三台同网段内的服务器，模拟实现一个路由器">课后作业2- 三台同网段内的服务器，模拟实现一个路由器</a></li>
                    <li>
                        <a href="#%e6%ad%a3%e7%a1%ae%e7%ad%94%e6%a1%88-4" aria-label="正确答案：">正确答案：</a><ul>
                            
                    <li>
                        <a href="#%e8%af%be%e5%90%8e%e4%bd%9c%e4%b8%9a1" aria-label="课后作业1：">课后作业1：</a></li>
                    <li>
                        <a href="#%e8%af%be%e5%90%8e%e4%bd%9c%e4%b8%9a2" aria-label="课后作业2：">课后作业2：</a></li></ul>
                    </li></ul>
                    </li>
                    <li>
                        <a href="#day72-%e5%a6%82%e4%bd%95%e5%b0%86%e6%88%91%e7%9a%84%e6%9c%8d%e5%8a%a1%e5%bc%80%e6%94%be%e7%bb%99%e7%94%a8%e6%88%b7" aria-label="day7.2 如何将我的服务开放给用户">day7.2 如何将我的服务开放给用户</a><ul>
                            
                    <li>
                        <a href="#%e5%9f%9f%e5%90%8d%e7%b3%bb%e7%bb%9f" aria-label="域名系统">域名系统</a><ul>
                            
                    <li>
                        <a href="#host%e7%ae%a1%e7%90%86%e7%9a%84%e9%97%ae%e9%a2%98" aria-label="host管理的问题">host管理的问题</a></li>
                    <li>
                        <a href="#%e5%9f%9f%e5%90%8d%e8%b4%ad%e4%b9%b0%e5%92%8c%e9%85%8d%e7%bd%ae%e8%bf%81%e7%a7%bb" aria-label="域名购买和配置迁移">域名购买和配置迁移</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e8%87%aa%e5%bb%badns%e6%9c%8d%e5%8a%a1%e5%99%a8" aria-label="自建DNS服务器">自建DNS服务器</a><ul>
                            
                    <li>
                        <a href="#%e6%9d%83%e5%a8%81dns%e7%b3%bb%e7%bb%9f" aria-label="权威DNS系统">权威DNS系统</a></li></ul>
                    </li>
                    <li>
                        <a href="#https%e5%8d%8f%e8%ae%ae" aria-label="HTTPS协议">HTTPS协议</a><ul>
                            
                    <li>
                        <a href="#%e5%af%b9%e7%a7%b0%e5%8a%a0%e5%af%86%e5%92%8c%e9%9d%9e%e5%af%b9%e7%a7%b0%e5%8a%a0%e5%af%86" aria-label="对称加密和非对称加密">对称加密和非对称加密</a></li>
                    <li>
                        <a href="#ssl%e7%9a%84%e9%80%9a%e4%bf%a1%e8%bf%87%e7%a8%8b" aria-label="SSL的通信过程">SSL的通信过程</a></li>
                    <li>
                        <a href="#%e8%af%81%e4%b9%a6%e9%93%be" aria-label="证书链">证书链</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e6%8e%a5%e5%85%a5%e5%85%a8%e7%ab%99%e5%8a%a0%e9%80%9f" aria-label="接入全站加速">接入全站加速</a><ul>
                            
                    <li>
                        <a href="#%e9%9d%99%e6%80%81%e5%8a%a0%e9%80%9fcdn" aria-label="静态加速CDN">静态加速CDN</a></li>
                    <li>
                        <a href="#%e5%8a%a8%e6%80%81%e5%8a%a0%e9%80%9fdcdn" aria-label="动态加速DCDN">动态加速DCDN</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e5%9b%9b%e5%b1%82%e8%b4%9f%e8%bd%bd%e5%9d%87%e8%a1%a1" aria-label="四层负载均衡">四层负载均衡</a></li>
                    <li>
                        <a href="#%e4%b8%83%e5%b1%82%e8%b4%9f%e8%bd%bd%e5%9d%87%e8%a1%a1" aria-label="七层负载均衡">七层负载均衡</a></li></ul>
                    </li>
                    <li>
                        <a href="#day81-%e6%9e%b6%e6%9e%84%e5%88%9d%e6%8e%a2" aria-label="day8.1 架构初探">day8.1 架构初探</a><ul>
                            
                    <li>
                        <a href="#%e4%bb%80%e4%b9%88%e6%98%af%e6%9e%b6%e6%9e%84" aria-label="什么是架构">什么是架构</a><ul>
                            
                    <li>
                        <a href="#%e5%8d%95%e6%9c%ba" aria-label="单机">单机</a></li>
                    <li>
                        <a href="#%e5%8d%95%e4%bd%93%e5%9e%82%e7%9b%b4%e5%88%87%e5%88%86" aria-label="单体、垂直切分">单体、垂直切分</a></li>
                    <li>
                        <a href="#soa" aria-label="SOA">SOA</a></li>
                    <li>
                        <a href="#%e5%be%ae%e6%9c%8d%e5%8a%a1" aria-label="微服务">微服务</a></li>
                    <li>
                        <a href="#%e5%b0%8f%e7%bb%93" aria-label="小结">小结</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e4%bc%81%e4%b8%9a%e7%ba%a7%e5%90%8e%e7%ab%af%e6%9e%b6%e6%9e%84%e5%89%96%e6%9e%90" aria-label="企业级后端架构剖析">企业级后端架构剖析</a><ul>
                            
                    <li>
                        <a href="#%e4%ba%91%e8%ae%a1%e7%ae%97%e5%9f%ba%e7%a1%80" aria-label="云计算基础：">云计算基础：</a></li>
                    <li>
                        <a href="#%e4%ba%91%e8%ae%a1%e7%ae%97%e6%9e%b6%e6%9e%84" aria-label="云计算架构：">云计算架构：</a></li>
                    <li>
                        <a href="#%e4%ba%91%e5%8e%9f%e7%94%9f" aria-label="云原生">云原生</a><ul>
                            
                    <li>
                        <a href="#%e5%bc%b9%e6%80%a7%e8%b5%84%e6%ba%90" aria-label="弹性资源">弹性资源</a></li>
                    <li>
                        <a href="#%e5%be%ae%e6%9c%8d%e5%8a%a1%e6%9e%b6%e6%9e%84" aria-label="微服务架构">微服务架构</a></li>
                    <li>
                        <a href="#%e6%9c%8d%e5%8a%a1%e7%bd%91%e6%a0%bc" aria-label="服务网格">服务网格</a></li></ul>
                    </li></ul>
                    </li>
                    <li>
                        <a href="#%e4%bc%81%e4%b8%9a%e7%ba%a7%e5%90%8e%e7%ab%af%e6%9e%b6%e6%9e%84%e7%9a%84%e6%8c%91%e6%88%98" aria-label="企业级后端架构的挑战">企业级后端架构的挑战</a><ul>
                            
                    <li>
                        <a href="#%e6%8c%91%e6%88%98" aria-label="挑战">挑战</a></li>
                    <li>
                        <a href="#%e7%a6%bb%e5%9c%a8%e7%ba%bf%e8%b5%84%e6%ba%90%e5%b9%b6%e6%b1%a0" aria-label="离在线资源并池">离在线资源并池</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e5%90%8e%e7%ab%af%e6%9e%b6%e6%9e%84%e5%ae%9e%e8%b7%b5" aria-label="后端架构实践">后端架构实践</a></li></ul>
                    </li>
                    <li>
                        <a href="#day82-git" aria-label="day8.2 git">day8.2 git</a></li>
                    <li>
                        <a href="#day9-%e6%95%b0%e6%8d%ae%e7%bb%93%e6%9e%84%e4%b8%8e%e7%ae%97%e6%b3%95" aria-label="day9 数据结构与算法">day9 数据结构与算法</a><ul>
                            
                    <li>
                        <a href="#%e8%af%be%e5%90%8e%e4%bd%9c%e4%b8%9a-%e5%ae%9e%e7%8e%b0-pdqsort-version-1" aria-label="课后作业-实现 pdqsort-Version 1">课后作业-<strong>实现 pdqsort-Version</strong> <strong>1</strong></a></li>
                    <li>
                        <a href="#%e6%ad%a3%e7%a1%ae%e7%ad%94%e6%a1%88-5" aria-label="正确答案：">正确答案：</a></li></ul>
                    </li>
                    <li>
                        <a href="#day101-rpc%e6%a1%86%e6%9e%b6" aria-label="day10.1 RPC框架">day10.1 RPC框架</a><ul>
                            
                    <li>
                        <a href="#rpc-%e7%9b%b8%e5%85%b3%e7%9a%84%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5" aria-label="RPC 相关的基本概念">RPC 相关的基本概念</a></li>
                    <li>
                        <a href="#rpc-%e6%a1%86%e6%9e%b6%e7%9a%84%e5%88%86%e5%b1%82%e8%ae%be%e8%ae%a1" aria-label="RPC 框架的分层设计">RPC 框架的分层设计</a></li>
                    <li>
                        <a href="#%e8%a1%a1%e9%87%8f-rpc-%e6%a1%86%e6%9e%b6%e7%9a%84%e4%b8%80%e4%ba%9b%e6%a0%b8%e5%bf%83%e6%8c%87%e6%a0%87" aria-label="衡量 RPC 框架的一些核心指标">衡量 RPC 框架的一些核心指标</a></li>
                    <li>
                        <a href="#%e5%ad%97%e8%8a%82%e5%86%85%e9%83%a8-rpc-%e6%a1%86%e6%9e%b6-kitex-%e5%ae%9e%e8%b7%b5%e5%88%86%e4%ba%ab" aria-label="字节内部 RPC 框架 Kitex 实践分享">字节内部 RPC 框架 Kitex 实践分享</a></li>
                    <li>
                        <a href="#%e8%af%be%e5%90%8e%e4%bd%9c%e4%b8%9a--%e9%87%8d%e7%82%b9%e5%86%85%e5%ae%b9-review-1" aria-label="课后作业- 重点内容 Review">课后作业- 重点内容 Review</a></li></ul>
                    </li>
                    <li>
                        <a href="#day102-http%e4%bf%ae%e7%82%bc%e7%9f%a5%e9%81%93" aria-label="day10.2 HTTP修炼知道">day10.2 HTTP修炼知道</a><ul>
                            
                    <li>
                        <a href="#%e5%86%8d%e8%b0%88http%e5%8d%8f%e8%ae%ae" aria-label="再谈HTTP协议">再谈HTTP协议</a></li>
                    <li>
                        <a href="#http%e6%a1%86%e6%9e%b6%e7%9a%84%e8%ae%be%e8%ae%a1%e4%b8%8e%e5%ae%9e%e7%8e%b0" aria-label="HTTP框架的设计与实现">HTTP框架的设计与实现</a></li>
                    <li>
                        <a href="#%e6%80%a7%e8%83%bd%e4%bf%ae%e7%82%bc%e4%b9%8b%e9%81%93" aria-label="性能修炼之道">性能修炼之道</a></li>
                    <li>
                        <a href="#%e4%bc%81%e4%b8%9a%e5%ae%9e%e8%b7%b5" aria-label="企业实践">企业实践</a></li>
                    <li>
                        <a href="#%e8%af%be%e5%90%8e%e4%bd%9c%e4%b8%9a-%e9%87%8d%e7%82%b9%e5%86%85%e5%ae%b9-review-1" aria-label="课后作业-重点内容 Review">课后作业-重点内容 Review</a></li>
                    <li>
                        <a href="#%e6%ad%a3%e7%a1%ae%e7%ad%94%e6%a1%88-6" aria-label="正确答案："><strong>正确答案：</strong></a></li></ul>
                    </li>
                    <li>
                        <a href="#day111-%e5%be%ae%e6%9c%8d%e5%8a%a1%e6%a1%86%e6%9e%b6" aria-label="day11.1 微服务框架">day11.1 微服务框架</a><ul>
                            
                    <li>
                        <a href="#%e5%be%ae%e6%9c%8d%e5%8a%a1%e6%9e%b6%e6%9e%84%e4%bb%8b%e7%bb%8d" aria-label="微服务架构介绍">微服务架构介绍</a><ul>
                            
                    <li>
                        <a href="#%e5%be%ae%e6%9c%8d%e5%8a%a1%e6%9e%b6%e6%9e%84%e6%a6%82%e8%a7%88" aria-label="微服务架构概览">微服务架构概览</a></li>
                    <li>
                        <a href="#%e5%be%ae%e6%9c%8d%e5%8a%a1%e6%9e%b6%e6%9e%84%e7%9a%84%e6%a0%b8%e5%bf%83%e8%a6%81%e7%b4%a0" aria-label="微服务架构的核心要素">微服务架构的核心要素</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e5%be%ae%e6%9c%8d%e5%8a%a1%e6%9e%b6%e6%9e%84%e5%8e%9f%e7%90%86%e5%8f%8a%e7%89%b9%e5%be%81" aria-label="微服务架构原理及特征">微服务架构原理及特征</a><ul>
                            
                    <li>
                        <a href="#%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5" aria-label="基本概念">基本概念</a></li>
                    <li>
                        <a href="#%e6%9c%8d%e5%8a%a1%e6%b3%a8%e5%86%8c%e5%8f%8a%e5%8f%91%e7%8e%b0" aria-label="服务注册及发现">服务注册及发现</a></li>
                    <li>
                        <a href="#%e6%97%a0%e6%8d%9f%e7%9a%84%e6%9c%8d%e5%8a%a1%e5%ae%9e%e4%be%8b%e4%b8%8a%e4%b8%8b%e7%ba%bf%e6%b5%81%e7%a8%8b" aria-label="无损的服务实例上下线流程">无损的服务实例上下线流程</a></li>
                    <li>
                        <a href="#%e5%be%ae%e6%9c%8d%e5%8a%a1%e6%9e%b6%e6%9e%84%e4%b8%ad%e7%9a%84%e5%9f%ba%e6%9c%ac%e6%b5%81%e9%87%8f%e7%89%b9%e5%be%81" aria-label="微服务架构中的基本流量特征">微服务架构中的基本流量特征</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e6%a0%b8%e5%bf%83%e6%9c%8d%e5%8a%a1%e6%b2%bb%e7%90%86%e5%8a%9f%e8%83%bd" aria-label="核心服务治理功能">核心服务治理功能</a><ul>
                            
                    <li>
                        <a href="#%e6%9c%8d%e5%8a%a1%e5%8f%91%e5%b8%83" aria-label="服务发布">服务发布</a></li>
                    <li>
                        <a href="#%e6%b5%81%e9%87%8f%e6%b2%bb%e7%90%86" aria-label="流量治理">流量治理</a></li>
                    <li>
                        <a href="#%e8%b4%9f%e8%bd%bd%e5%9d%87%e8%a1%a1" aria-label="负载均衡">负载均衡</a></li>
                    <li>
                        <a href="#%e7%a8%b3%e5%ae%9a%e6%80%a7%e6%b2%bb%e7%90%86" aria-label="稳定性治理">稳定性治理</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e5%ad%97%e8%8a%82%e8%b7%b3%e5%8a%a8%e6%9c%8d%e5%8a%a1%e6%b2%bb%e7%90%86%e5%ae%9e%e8%b7%b5" aria-label="字节跳动服务治理实践">字节跳动服务治理实践</a></li>
                    <li>
                        <a href="#%e8%af%be%e5%90%8e%e4%bd%9c%e4%b8%9a--%e9%87%8d%e7%82%b9%e5%86%85%e5%ae%b9-review-2" aria-label="课后作业- 重点内容 Review">课后作业- 重点内容 Review</a></li></ul>
                    </li>
                    <li>
                        <a href="#day112%e6%b6%88%e6%81%af%e9%98%9f%e5%88%97" aria-label="day11.2消息队列">day11.2消息队列</a><ul>
                            
                    <li>
                        <a href="#%e5%89%8d%e4%b8%96%e4%bb%8a%e7%94%9f" aria-label="前世今生">前世今生</a></li>
                    <li>
                        <a href="#%e6%b6%88%e6%81%af%e9%98%9f%e5%88%97kafka" aria-label="消息队列Kafka">消息队列Kafka</a><ul>
                            
                    <li>
                        <a href="#producer%e7%ab%af%e9%80%bb%e8%be%91" aria-label="Producer端逻辑">Producer端逻辑</a></li>
                    <li>
                        <a href="#broker%e7%ab%af%e9%80%bb%e8%be%91" aria-label="Broker端逻辑">Broker端逻辑</a></li>
                    <li>
                        <a href="#consumer%e7%ab%af%e9%80%bb%e8%be%91" aria-label="Consumer端逻辑">Consumer端逻辑</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e6%b6%88%e6%81%af%e9%98%9f%e5%88%97bmq" aria-label="消息队列BMQ">消息队列BMQ</a></li>
                    <li>
                        <a href="#%e8%af%be%e5%90%8e%e4%bd%9c%e4%b8%9a-2" aria-label="课后作业：">课后作业：</a></li></ul>
                    </li>
                    <li>
                        <a href="#day121-%e5%88%86%e5%b8%83%e5%bc%8f%e5%ae%9a%e6%97%b6%e5%99%a8" aria-label="day12.1 分布式定时器">day12.1 分布式定时器</a><ul>
                            
                    <li>
                        <a href="#%e5%89%8d%e8%a8%80" aria-label="前言">前言</a></li>
                    <li>
                        <a href="#%e5%8f%91%e5%b1%95%e5%8e%86%e7%a8%8b" aria-label="发展历程">发展历程</a><ul>
                            
                    <li>
                        <a href="#%e5%88%86%e5%b8%83%e5%bc%8f%e5%ae%9a%e6%97%b6%e4%bb%bb%e5%8a%a1" aria-label="分布式定时任务">分布式定时任务</a><ul>
                            
                    <li>
                        <a href="#%e5%ae%9a%e4%b9%89" aria-label="定义">定义</a></li>
                    <li>
                        <a href="#%e7%89%b9%e7%82%b9" aria-label="特点">特点</a></li>
                    <li>
                        <a href="#%e6%89%a7%e8%a1%8c%e6%a8%a1%e5%bc%8f" aria-label="执行模式">执行模式</a></li>
                    <li>
                        <a href="#%e5%88%86%e5%b8%83%e5%bc%8f%e5%ae%9a%e6%97%b6%e4%bb%bb%e5%8a%a1vs%e5%8d%95%e6%9c%ba%e5%ae%9a%e6%97%b6%e4%bb%bb%e5%8a%a1" aria-label="分布式定时任务VS单机定时任务">分布式定时任务VS单机定时任务</a></li>
                    <li>
                        <a href="#%e5%88%86%e5%b8%83%e5%bc%8f%e5%ae%9a%e6%97%b6%e4%bb%bb%e5%8a%a1vs%e5%a4%a7%e6%95%b0%e6%8d%ae%e5%a4%84%e7%90%86%e5%bc%95%e6%93%8e" aria-label="分布式定时任务VS大数据处理引擎">分布式定时任务VS大数据处理引擎</a></li>
                    <li>
                        <a href="#%e4%b8%9a%e5%86%85%e6%b5%81%e8%a1%8c%e6%a1%86%e6%9e%b6xxl-jobschedulerxtct" aria-label="业内流行框架：Xxl-job、SchedulerX、TCT">业内流行框架：Xxl-job、SchedulerX、TCT</a></li></ul>
                    </li></ul>
                    </li></ul>
                    </li>
                    <li>
                        <a href="#%e5%ae%9e%e7%8e%b0%e5%8e%9f%e7%90%86" aria-label="实现原理">实现原理</a><ul>
                            
                    <li>
                        <a href="#%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5-1" aria-label="基本概念">基本概念</a></li>
                    <li>
                        <a href="#%e8%a7%a6%e5%8f%91%e5%99%a8" aria-label="触发器">触发器</a><ul>
                            
                    <li>
                        <a href="#%e6%96%b9%e6%a1%88%e4%b8%80" aria-label="方案一">方案一</a></li>
                    <li>
                        <a href="#%e6%96%b9%e6%a1%88%e4%ba%8c" aria-label="方案二">方案二</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e8%af%be%e5%90%8e%e4%bd%9c%e4%b8%9a--%e9%87%8d%e7%82%b9%e5%86%85%e5%ae%b9-review-3" aria-label="课后作业- 重点内容 Review">课后作业- 重点内容 Review</a></li>
                    <li>
                        <a href="#%e6%ad%a3%e7%a1%ae%e7%ad%94%e6%a1%88-7" aria-label="正确答案：">正确答案：</a></li></ul>
                    </li>
                    <li>
                        <a href="#day122-%e5%ad%98%e5%82%a8%e4%b8%8e%e6%95%b0%e6%8d%ae%e5%ba%93" aria-label="day12.2 存储与数据库">day12.2 存储与数据库</a><ul>
                            
                    <li>
                        <a href="#%e8%af%be%e5%90%8e%e4%bd%9c%e4%b8%9a-%e5%ae%9e%e7%8e%b0%e4%b8%80%e4%b8%aa%e5%88%86%e5%b8%83%e5%bc%8fkey-value-%e5%ad%98%e5%82%a8%e7%b3%bb%e7%bb%9f" aria-label="课后作业-实现一个（分布式）key-value 存储系统">课后作业-实现一个（分布式）key-value 存储系统</a></li></ul>
                    </li>
                    <li>
                        <a href="#day13-%e6%b7%b1%e5%85%a5%e7%90%86%e8%a7%a3rdbms" aria-label="day13 深入理解RDBMS">day13 深入理解RDBMS</a><ul>
                            
                    <li>
                        <a href="#%e8%af%be%e5%90%8e%e4%bd%9c%e4%b8%9a--%e9%87%8d%e7%82%b9%e5%86%85%e5%ae%b9-review-4" aria-label="课后作业- 重点内容 Review">课后作业- 重点内容 Review</a></li>
                    <li>
                        <a href="#%e6%ad%a3%e7%a1%ae%e7%ad%94%e6%a1%88-8" aria-label="正确答案：">正确答案：</a></li></ul>
                    </li>
                    <li>
                        <a href="#day141-tos%e5%af%b9%e8%b1%a1%e5%ad%98%e5%82%a8" aria-label="day14.1 TOS对象存储">day14.1 TOS对象存储</a><ul>
                            
                    <li>
                        <a href="#%e8%af%be%e5%90%8e%e4%bd%9c%e4%b8%9a-%e5%ae%9e%e7%8e%b0%e4%b8%80%e4%b8%aa%e5%af%b9%e8%b1%a1%e5%ad%98%e5%82%a8%e5%ae%a2%e6%88%b7%e7%ab%af" aria-label="课后作业-实现一个对象存储客户端">课后作业-实现一个对象存储客户端</a>
                    </li>
                </ul>
                </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 && 
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
</script>

  <div class="post-content"><h2 id="day1-go语言上手-基础语言">day1 go语言上手-基础语言<a hidden class="anchor" aria-hidden="true" href="#day1-go语言上手-基础语言">#</a></h2>
<p><a href="https://bytedance.feishu.cn/file/boxcnQnHXuDOdzd8CqVid7nQLmg">https://bytedance.feishu.cn/file/boxcnQnHXuDOdzd8CqVid7nQLmg</a></p>
<h3 id="随机数">随机数<a hidden class="anchor" aria-hidden="true" href="#随机数">#</a></h3>
<p>rand.Intn () 函数是个伪随机函数，不管运行多少次都只会返回同样的随机数，因为它默认的资源就是单一值，所以必须调用 rand.Seed (), 并且传入一个变化的值作为参数，如 time.Now().UnixNano() , 就是可以生成时刻变化的值.</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>maxNum := <span style="color:#ff0;font-weight:bold">100</span>
</span></span><span style="display:flex;"><span>rand.Seed(time.Now().UnixNano())
</span></span><span style="display:flex;"><span>secretNumber := rand.Intn(maxNum)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="输入">输入<a hidden class="anchor" aria-hidden="true" href="#输入">#</a></h3>
<p>输入bufio的reader</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>reader := bufio.NewReader(os.Stdin)
</span></span><span style="display:flex;"><span>input, err := reader.ReadString(<span style="color:#0ff;font-weight:bold">&#39;\n&#39;</span>)  <span style="color:#007f7f">//以空格结束
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>input = strings.TrimSuffix(input, <span style="color:#0ff;font-weight:bold">&#34;\r\n&#34;</span>)
</span></span><span style="display:flex;"><span>uess, err := strconv.Atoi(input)  <span style="color:#007f7f">//转为int
</span></span></span></code></pre></td></tr></table>
</div>
</div><table>
<thead>
<tr>
<th>fmt.Scan</th>
<th>获取输入</th>
</tr>
</thead>
<tbody>
<tr>
<td>fmt.Scanf</td>
<td>获取输入，但是可以指定格式，go语言会根据格式解析参数</td>
</tr>
<tr>
<td>fmt.Scanln</td>
<td>获取一行的输入，只会获取到一行</td>
</tr>
</tbody>
</table>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">var</span> guess <span style="color:#fff;font-weight:bold">int</span>
</span></span><span style="display:flex;"><span>_ , err := fmt.Scanf(<span style="color:#0ff;font-weight:bold">&#34;%v\n&#34;</span>,&amp;guess)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">var</span> a1,a2 <span style="color:#fff;font-weight:bold">string</span>
</span></span><span style="display:flex;"><span>fmt.Scanln(&amp;a1,&amp;a2)<span style="color:#007f7f">//如果换行输出不了a2了
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">var</span> a1,a2 <span style="color:#fff;font-weight:bold">string</span>
</span></span><span style="display:flex;"><span>fmt.Scanf(<span style="color:#0ff;font-weight:bold">&#34;%s %s&#34;</span>,&amp;a1,&amp;a2)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="自动生成爬虫代码">自动生成爬虫代码<a hidden class="anchor" aria-hidden="true" href="#自动生成爬虫代码">#</a></h3>
<p><a href="https://fanyi.caiyunapp.com/#/">https://fanyi.caiyunapp.com/#/</a></p>
<p>要求是bash</p>
<p><img loading="lazy" src="C:%5cUsers%5cWIN10%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20220506151241567.png" alt="image-20220506151241567"  />
</p>
<p><a href="https://curlconverter.com/#go">https://curlconverter.com/#go</a></p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmd" data-lang="cmd"><span style="display:flex;"><span>package main
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>import (
</span></span><span style="display:flex;"><span>	<span style="color:#0ff;font-weight:bold">&#34;fmt&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#0ff;font-weight:bold">&#34;io/ioutil&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#0ff;font-weight:bold">&#34;log&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#0ff;font-weight:bold">&#34;net/http&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#0ff;font-weight:bold">&#34;strings&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>func main() {
</span></span><span style="display:flex;"><span>	client := &amp;http.Client{}
</span></span><span style="display:flex;"><span>	var data = strings.NewReader(`{<span style="color:#0ff;font-weight:bold">&#34;trans_type&#34;</span>:<span style="color:#0ff;font-weight:bold">&#34;en2zh&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;source&#34;</span>:<span style="color:#0ff;font-weight:bold">&#34;good&#34;</span>}`)
</span></span><span style="display:flex;"><span>	req, err := http.NewRequest(<span style="color:#0ff;font-weight:bold">&#34;POST&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;https://api.interpreter.caiyunai.com/v1/dict&#34;</span>, data)
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">if</span> err<span style="color:#f00"> != nil {</span>
</span></span><span style="display:flex;"><span>		log.Fatal(err)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	req.Header.Set(<span style="color:#0ff;font-weight:bold">&#34;Accept&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;application/json, text/plain, */*&#34;</span>)
</span></span><span style="display:flex;"><span>	req.Header.Set(<span style="color:#0ff;font-weight:bold">&#34;Accept-Language&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;zh-CN,zh;q=0.9&#34;</span>)
</span></span><span style="display:flex;"><span>	req.Header.Set(<span style="color:#0ff;font-weight:bold">&#34;Connection&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;keep-alive&#34;</span>)
</span></span><span style="display:flex;"><span>	req.Header.Set(<span style="color:#0ff;font-weight:bold">&#34;Content-Type&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;application/json;charset=UTF-8&#34;</span>)
</span></span><span style="display:flex;"><span>	req.Header.Set(<span style="color:#0ff;font-weight:bold">&#34;Origin&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;https://fanyi.caiyunapp.com&#34;</span>)
</span></span><span style="display:flex;"><span>	req.Header.Set(<span style="color:#0ff;font-weight:bold">&#34;Referer&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;https://fanyi.caiyunapp.com/&#34;</span>)
</span></span><span style="display:flex;"><span>	req.Header.Set(<span style="color:#0ff;font-weight:bold">&#34;Sec-Fetch-Dest&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;empty&#34;</span>)
</span></span><span style="display:flex;"><span>	req.Header.Set(<span style="color:#0ff;font-weight:bold">&#34;Sec-Fetch-Mode&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;cors&#34;</span>)
</span></span><span style="display:flex;"><span>	req.Header.Set(<span style="color:#0ff;font-weight:bold">&#34;Sec-Fetch-Site&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;cross-site&#34;</span>)
</span></span><span style="display:flex;"><span>	req.Header.Set(<span style="color:#0ff;font-weight:bold">&#34;User-Agent&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36&#34;</span>)
</span></span><span style="display:flex;"><span>	req.Header.Set(<span style="color:#0ff;font-weight:bold">&#34;X-Authorization&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;token:qgemv4jr1y38jyq6vhvi&#34;</span>)
</span></span><span style="display:flex;"><span>	req.Header.Set(<span style="color:#0ff;font-weight:bold">&#34;app-name&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;xy&#34;</span>)
</span></span><span style="display:flex;"><span>	req.Header.Set(<span style="color:#0ff;font-weight:bold">&#34;os-type&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;web&#34;</span>)
</span></span><span style="display:flex;"><span>	req.Header.Set(<span style="color:#0ff;font-weight:bold">&#34;sec-ch-ua&#34;</span>, `<span style="color:#0ff;font-weight:bold">&#34; Not A;Brand&#34;</span>;v=<span style="color:#0ff;font-weight:bold">&#34;99&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;Chromium&#34;</span>;v=<span style="color:#0ff;font-weight:bold">&#34;100&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;Google Chrome&#34;</span>;v=<span style="color:#0ff;font-weight:bold">&#34;100&#34;</span>`)
</span></span><span style="display:flex;"><span>	req.Header.Set(<span style="color:#0ff;font-weight:bold">&#34;sec-ch-ua-mobile&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;?0&#34;</span>)
</span></span><span style="display:flex;"><span>	req.Header.Set(<span style="color:#0ff;font-weight:bold">&#34;sec-ch-ua-platform&#34;</span>, `<span style="color:#0ff;font-weight:bold">&#34;Windows&#34;</span>`)
</span></span><span style="display:flex;"><span>	resp, err := client.Do(req)
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">if</span> err<span style="color:#f00"> != nil {</span>
</span></span><span style="display:flex;"><span>		log.Fatal(err)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	defer resp.Body.Close()
</span></span><span style="display:flex;"><span>	bodyText, err := ioutil.ReadAll(resp.Body)
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">if</span> err<span style="color:#f00"> != nil {</span>
</span></span><span style="display:flex;"><span>		log.Fatal(err)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	fmt.Printf(<span style="color:#0ff;font-weight:bold">&#34;%s\n&#34;</span>, bodyText)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>运行代码输出</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{<span style="font-weight:bold">&#34;rc&#34;</span>:<span style="color:#ff0;font-weight:bold">0</span>,<span style="font-weight:bold">&#34;wiki&#34;</span>:{<span style="font-weight:bold">&#34;known_in_laguages&#34;</span>:<span style="color:#ff0;font-weight:bold">63</span>,<span style="font-weight:bold">&#34;description&#34;</span>:{<span style="font-weight:bold">&#34;source&#34;</span>:<span style="color:#0ff;font-weight:bold">&#34;tangible and intangible thing, except labor tied services, that satisfies human wants and provides utility&#34;</span>,<span style="font-weight:bold">&#34;target&#34;</span>:<span style="color:#fff;font-weight:bold">null</span>},<span style="font-weight:bold">&#34;id&#34;</span>:<span style="color:#0ff;font-weight:bold">&#34;Q28877&#34;</span>,<span style="font-weight:bold">&#34;item&#34;</span>:{<span style="font-weight:bold">&#34;source&#34;</span>:<span style="color:#0ff;font-weight:bold">&#34;good&#34;</span>,<span style="font-weight:bold">&#34;target&#34;</span>:<span style="color:#0ff;font-weight:bold">&#34;\u5546\u54c1&#34;</span>},<span style="font-weight:bold">&#34;image_url&#34;</span>:<span style="color:#0ff;font-weight:bold">&#34;http:\/\/www.caiyunapp.com\/imgs\/link_default_img.png&#34;</span>,<span style="font-weight:bold">&#34;is_subject&#34;</span>:<span style="color:#0ff;font-weight:bold">&#34;true&#34;</span>,<span style="font-weight:bold">&#34;sitelink&#34;</span>:<span style="color:#0ff;font-weight:bold">&#34;https:\/\/www.caiyunapp.com\/read_mode\/?id=625b4b949c0120504d1e7b69&#34;</span>},<span style="font-weight:bold">&#34;dictionary&#34;</span>:{<span style="font-weight:bold">&#34;prons&#34;</span>:{<span style="font-weight:bold">&#34;en-us&#34;</span>:<span style="color:#0ff;font-weight:bold">&#34;[g\u028ad]&#34;</span>,<span style="font-weight:bold">&#34;en&#34;</span>:<span style="color:#0ff;font-weight:bold">&#34;[gud]&#34;</span>},<span style="font-weight:bold">&#34;explanations&#34;</span>:[<span style="color:#0ff;font-weight:bold">&#34;a.\u597d\u7684;\u5584\u826f\u7684;\u5feb\u4e50\u7684;\u771f\u6b63\u7684;\u5bbd\u5927\u7684;\u6709\u76ca\u7684;\u8001\u7ec3\u7684;\u5e78\u798f\u7684;\u5fe0\u5b9e\u7684;\u4f18\u79c0\u7684;\u5b8c\u6574\u7684;\u5f7b\u5e95\u7684;\u4e30\u5bcc\u7684&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;n.\u5229\u76ca;\u597d\u5904;\u5584\u826f;\u597d\u4eba&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;ad.=well&#34;</span>],<span style="font-weight:bold">&#34;synonym&#34;</span>:[<span style="color:#0ff;font-weight:bold">&#34;excellent&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;fine&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;nice&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;splendid&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;proper&#34;</span>],<span style="font-weight:bold">&#34;antonym&#34;</span>:[<span style="color:#0ff;font-weight:bold">&#34;bad&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;wrong&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;evil&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;harmful&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;poor&#34;</span>],<span style="font-weight:bold">&#34;wqx_example&#34;</span>:[[<span style="color:#0ff;font-weight:bold">&#34;to the good&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;\u6709\u5229,\u6709\u597d\u5904&#34;</span>],[<span style="color:#0ff;font-weight:bold">&#34;good, bad and indifferent&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;\u597d\u7684,\u574f\u7684\u548c\u4e00\u822c\u7684&#34;</span>],[<span style="color:#0ff;font-weight:bold">&#34;good innings&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;\u957f\u5bff&#34;</span>],[<span style="color:#0ff;font-weight:bold">&#34;good and ...&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;\u5f88,\u9887;\u5b8c\u5168,\u5f7b\u5e95&#34;</span>],[<span style="color:#0ff;font-weight:bold">&#34;do somebody&#39;s heart good&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;\u5bf9\u67d0\u4eba\u7684\u5fc3\u810f\u6709\u76ca,\u4f7f\u67d0\u4eba\u611f\u5230\u6109\u5feb&#34;</span>],[<span style="color:#0ff;font-weight:bold">&#34;do somebody good&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;\u5bf9\u67d0\u4eba\u6709\u76ca&#34;</span>],[<span style="color:#0ff;font-weight:bold">&#34;be good for&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;\u5bf9\u2026\u6709\u6548,\u9002\u5408,\u80dc\u4efb&#34;</span>],[<span style="color:#0ff;font-weight:bold">&#34;be good at&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;\u5728\u2026\u65b9\u9762(\u5b66\u5f97,\u505a\u5f97)\u597d;\u5584\u4e8e&#34;</span>],[<span style="color:#0ff;font-weight:bold">&#34;as good as one&#39;s word&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;\u4fe1\u5b88\u8bfa\u8a00,\u503c\u5f97\u4fe1\u8d56&#34;</span>],[<span style="color:#0ff;font-weight:bold">&#34;as good as&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;\u5b9e\u9645\u4e0a,\u51e0\u4e4e\u7b49\u4e8e&#34;</span>],[<span style="color:#0ff;font-weight:bold">&#34;all well and good&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;\u4e5f\u597d,\u8fd8\u597d,\u5f88\u4e0d\u9519&#34;</span>],[<span style="color:#0ff;font-weight:bold">&#34;a good&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;\u76f8\u5f53,\u8db3\u8db3&#34;</span>],[<span style="color:#0ff;font-weight:bold">&#34;He is good at figures . &#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;\u4ed6\u5584\u4e8e\u8ba1\u7b97\u3002&#34;</span>]],<span style="font-weight:bold">&#34;entry&#34;</span>:<span style="color:#0ff;font-weight:bold">&#34;good&#34;</span>,<span style="font-weight:bold">&#34;type&#34;</span>:<span style="color:#0ff;font-weight:bold">&#34;word&#34;</span>,<span style="font-weight:bold">&#34;related&#34;</span>:[],<span style="font-weight:bold">&#34;source&#34;</span>:<span style="color:#0ff;font-weight:bold">&#34;wenquxing&#34;</span>}}
</span></span></code></pre></td></tr></table>
</div>
</div><p><a href="https://oktools.net/json2go">https://oktools.net/json2go</a></p>
<p>转为go结构体</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">type</span> DictResponse <span style="color:#fff;font-weight:bold">struct</span> {
</span></span><span style="display:flex;"><span>	Rc <span style="color:#fff;font-weight:bold">int</span> <span style="color:#0ff;font-weight:bold">`json:&#34;rc&#34;`</span>
</span></span><span style="display:flex;"><span>	Wiki <span style="color:#fff;font-weight:bold">struct</span> {
</span></span><span style="display:flex;"><span>		KnownInLaguages <span style="color:#fff;font-weight:bold">int</span> <span style="color:#0ff;font-weight:bold">`json:&#34;known_in_laguages&#34;`</span>
</span></span><span style="display:flex;"><span>		Description <span style="color:#fff;font-weight:bold">struct</span> {
</span></span><span style="display:flex;"><span>			Source <span style="color:#fff;font-weight:bold">string</span> <span style="color:#0ff;font-weight:bold">`json:&#34;source&#34;`</span>
</span></span><span style="display:flex;"><span>			Target <span style="color:#fff;font-weight:bold">interface</span>{} <span style="color:#0ff;font-weight:bold">`json:&#34;target&#34;`</span>
</span></span><span style="display:flex;"><span>		} <span style="color:#0ff;font-weight:bold">`json:&#34;description&#34;`</span>
</span></span><span style="display:flex;"><span>		ID <span style="color:#fff;font-weight:bold">string</span> <span style="color:#0ff;font-weight:bold">`json:&#34;id&#34;`</span>
</span></span><span style="display:flex;"><span>		Item <span style="color:#fff;font-weight:bold">struct</span> {
</span></span><span style="display:flex;"><span>			Source <span style="color:#fff;font-weight:bold">string</span> <span style="color:#0ff;font-weight:bold">`json:&#34;source&#34;`</span>
</span></span><span style="display:flex;"><span>			Target <span style="color:#fff;font-weight:bold">string</span> <span style="color:#0ff;font-weight:bold">`json:&#34;target&#34;`</span>
</span></span><span style="display:flex;"><span>		} <span style="color:#0ff;font-weight:bold">`json:&#34;item&#34;`</span>
</span></span><span style="display:flex;"><span>		ImageURL <span style="color:#fff;font-weight:bold">string</span> <span style="color:#0ff;font-weight:bold">`json:&#34;image_url&#34;`</span>
</span></span><span style="display:flex;"><span>		IsSubject <span style="color:#fff;font-weight:bold">string</span> <span style="color:#0ff;font-weight:bold">`json:&#34;is_subject&#34;`</span>
</span></span><span style="display:flex;"><span>		Sitelink <span style="color:#fff;font-weight:bold">string</span> <span style="color:#0ff;font-weight:bold">`json:&#34;sitelink&#34;`</span>
</span></span><span style="display:flex;"><span>	} <span style="color:#0ff;font-weight:bold">`json:&#34;wiki&#34;`</span>
</span></span><span style="display:flex;"><span>	Dictionary <span style="color:#fff;font-weight:bold">struct</span> {
</span></span><span style="display:flex;"><span>		Prons <span style="color:#fff;font-weight:bold">struct</span> {
</span></span><span style="display:flex;"><span>			EnUs <span style="color:#fff;font-weight:bold">string</span> <span style="color:#0ff;font-weight:bold">`json:&#34;en-us&#34;`</span>
</span></span><span style="display:flex;"><span>			En <span style="color:#fff;font-weight:bold">string</span> <span style="color:#0ff;font-weight:bold">`json:&#34;en&#34;`</span>
</span></span><span style="display:flex;"><span>		} <span style="color:#0ff;font-weight:bold">`json:&#34;prons&#34;`</span>
</span></span><span style="display:flex;"><span>		Explanations []<span style="color:#fff;font-weight:bold">string</span> <span style="color:#0ff;font-weight:bold">`json:&#34;explanations&#34;`</span>
</span></span><span style="display:flex;"><span>		Synonym []<span style="color:#fff;font-weight:bold">string</span> <span style="color:#0ff;font-weight:bold">`json:&#34;synonym&#34;`</span>
</span></span><span style="display:flex;"><span>		Antonym []<span style="color:#fff;font-weight:bold">string</span> <span style="color:#0ff;font-weight:bold">`json:&#34;antonym&#34;`</span>
</span></span><span style="display:flex;"><span>		WqxExample [][]<span style="color:#fff;font-weight:bold">string</span> <span style="color:#0ff;font-weight:bold">`json:&#34;wqx_example&#34;`</span>
</span></span><span style="display:flex;"><span>		Entry <span style="color:#fff;font-weight:bold">string</span> <span style="color:#0ff;font-weight:bold">`json:&#34;entry&#34;`</span>
</span></span><span style="display:flex;"><span>		Type <span style="color:#fff;font-weight:bold">string</span> <span style="color:#0ff;font-weight:bold">`json:&#34;type&#34;`</span>
</span></span><span style="display:flex;"><span>		Related []<span style="color:#fff;font-weight:bold">interface</span>{} <span style="color:#0ff;font-weight:bold">`json:&#34;related&#34;`</span>
</span></span><span style="display:flex;"><span>		Source <span style="color:#fff;font-weight:bold">string</span> <span style="color:#0ff;font-weight:bold">`json:&#34;source&#34;`</span>
</span></span><span style="display:flex;"><span>	} <span style="color:#0ff;font-weight:bold">`json:&#34;dictionary&#34;`</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="socks5">SOCKS5<a hidden class="anchor" aria-hidden="true" href="#socks5">#</a></h3>
<p><a href="https://zhuanlan.zhihu.com/p/438521117">https://zhuanlan.zhihu.com/p/438521117</a></p>
<p><img loading="lazy" src="C:%5cUsers%5cWIN10%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20220506111513080.png" alt="image-20220506111513080"  />
</p>
<p><img loading="lazy" src="C:%5cUsers%5cWIN10%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20220506111526219.png" alt="image-20220506111526219"  />
</p>
<p><img loading="lazy" src="C:%5cUsers%5cWIN10%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20220506113933058.png" alt="image-20220506113933058"  />
</p>
<p><img loading="lazy" src="C:%5cUsers%5cWIN10%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20220506114341603.png" alt="image-20220506114341603"  />
</p>
<p>老师，请问go的字符串拼接效率问题，一般考虑到综合易用性和性能，推荐使用 strings.Builder 来拼接字符串。但为什么有的文章会说标准编译器对使用+运算符的字符串衔接做了特别的优化。 所以，一般说来，在被衔接的字符串的数量是已知的情况下，使用+运算符进行字符串衔接是比较高效的。请问下一般在项目中如何拼接字符串是比较高效合理的呢</p>
<h2 id="day2-go语言上手-应用实践">day2 go语言上手-应用实践<a hidden class="anchor" aria-hidden="true" href="#day2-go语言上手-应用实践">#</a></h2>
<p><a href="https://bytedance.feishu.cn/file/boxcnRmlw9MjbtAMBnOW44y8dZd?hash=7cfc75acc80372c08463b622df90a4b5">https://bytedance.feishu.cn/file/boxcnRmlw9MjbtAMBnOW44y8dZd?hash=7cfc75acc80372c08463b622df90a4b5</a></p>
<h3 id="go依赖管理引进">go依赖管理引进<a hidden class="anchor" aria-hidden="true" href="#go依赖管理引进">#</a></h3>
<h4 id="2个目标">2个目标<a hidden class="anchor" aria-hidden="true" href="#2个目标">#</a></h4>
<p>不同环境依赖的版本不同</p>
<p>控制依赖库的版本</p>
<h4 id="gopath">GOPATH<a hidden class="anchor" aria-hidden="true" href="#gopath">#</a></h4>
<h4 id="go-vendor">GO Vendor<a hidden class="anchor" aria-hidden="true" href="#go-vendor">#</a></h4>
<h4 id="go-module">GO Module<a hidden class="anchor" aria-hidden="true" href="#go-module">#</a></h4>
<p>go.mod</p>
<p>Proxy</p>
<p>go get/mod</p>
<h3 id="测试">测试<a hidden class="anchor" aria-hidden="true" href="#测试">#</a></h3>
<h4 id="单元测试">单元测试<a hidden class="anchor" aria-hidden="true" href="#单元测试">#</a></h4>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">package</span> concurrence
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">func</span> HelloTom() <span style="color:#fff;font-weight:bold">string</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">return</span> <span style="color:#0ff;font-weight:bold">&#34;Tom&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">package</span> concurrence
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> <span style="color:#0ff;font-weight:bold">&#34;testing&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">func</span> TestHelloTom(t *testing.T) {
</span></span><span style="display:flex;"><span>	output := HelloTom()
</span></span><span style="display:flex;"><span>	expectOutput := <span style="color:#0ff;font-weight:bold">&#34;Tom&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">if</span> output != expectOutput {
</span></span><span style="display:flex;"><span>		t.Errorf(<span style="color:#0ff;font-weight:bold">&#34;Expected %s do not match actual %s&#34;</span>, expectOutput, output)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="assert">assert<a hidden class="anchor" aria-hidden="true" href="#assert">#</a></h5>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-GO" data-lang="GO"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">package</span> concurrence
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#0ff;font-weight:bold">&#34;github.com/stretchr/testify/assert&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#0ff;font-weight:bold">&#34;testing&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">func</span> TestHelloTom(t *testing.T) {
</span></span><span style="display:flex;"><span>	output := HelloTom()
</span></span><span style="display:flex;"><span>	expectOutput := <span style="color:#0ff;font-weight:bold">&#34;Tom&#34;</span>
</span></span><span style="display:flex;"><span>	assert.Equal(t, expectOutput, output)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="覆盖率">覆盖率<a hidden class="anchor" aria-hidden="true" href="#覆盖率">#</a></h5>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">package</span> concurrence
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">func</span> JudgePassLine(score <span style="color:#fff;font-weight:bold">int16</span>) <span style="color:#fff;font-weight:bold">bool</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">if</span> score &gt;= <span style="color:#ff0;font-weight:bold">60</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">true</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">false</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">package</span> concurrence
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#0ff;font-weight:bold">&#34;github.com/stretchr/testify/assert&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#0ff;font-weight:bold">&#34;testing&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">func</span> TestJudgePassLineTrue(t *testing.T) {
</span></span><span style="display:flex;"><span>	isPass := JudgePassLine(<span style="color:#ff0;font-weight:bold">70</span>)
</span></span><span style="display:flex;"><span>	assert.Equal(t, <span style="color:#fff;font-weight:bold">true</span>, isPass)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">func</span> TestJudgePassLineFalse(t *testing.T) {
</span></span><span style="display:flex;"><span>	isPass := JudgePassLine(<span style="color:#ff0;font-weight:bold">50</span>)
</span></span><span style="display:flex;"><span>	assert.Equal(t, <span style="color:#fff;font-weight:bold">false</span>, isPass)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>go <span style="color:#fff;font-weight:bold">test</span> .<span style="color:#0ff;font-weight:bold">\d</span>emo_test.go .<span style="color:#0ff;font-weight:bold">\d</span>emo.go --cover
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="mock测试">Mock测试<a hidden class="anchor" aria-hidden="true" href="#mock测试">#</a></h4>
<h4 id="基准测试">基准测试<a hidden class="anchor" aria-hidden="true" href="#基准测试">#</a></h4>
<h2 id="heading"><a hidden class="anchor" aria-hidden="true" href="#heading">#</a></h2>
<h2 id="day3-高质量编程与性能调优实战">day3 高质量编程与性能调优实战<a hidden class="anchor" aria-hidden="true" href="#day3-高质量编程与性能调优实战">#</a></h2>
<p><a href="https://bytedance.feishu.cn/file/boxcnqqWtT0xgWAIMGWVs7wM6fd">https://bytedance.feishu.cn/file/boxcnqqWtT0xgWAIMGWVs7wM6fd</a></p>
<h3 id="高质量编程">高质量编程<a hidden class="anchor" aria-hidden="true" href="#高质量编程">#</a></h3>
<p>高质量-正确可靠、简洁清晰</p>
<h4 id="编码规范">编码规范<a hidden class="anchor" aria-hidden="true" href="#编码规范">#</a></h4>
<h5 id="代码格式">代码格式<a hidden class="anchor" aria-hidden="true" href="#代码格式">#</a></h5>
<p>gofmt</p>
<p>goimports</p>
<h5 id="注释">注释<a hidden class="anchor" aria-hidden="true" href="#注释">#</a></h5>
<p>解释代码作用&ndash;适合注释公共符号</p>
<p>解释代码代码是如何做的&ndash;适合代码逻辑比较多的</p>
<p>解释代码实现的原因&ndash;提供额外上下文</p>
<p>解释代码什么情况下会出错&ndash;</p>
<p>公共符号始终要注释,不需要注释实现接口的方法</p>
<h5 id="命名规范">命名规范<a hidden class="anchor" aria-hidden="true" href="#命名规范">#</a></h5>
<p>简洁胜于冗长</p>
<p>缩略词全大写</p>
<p>有特定的含义</p>
<p>函数名不带包的上下文信息</p>
<h5 id="控制流程">控制流程<a hidden class="anchor" aria-hidden="true" href="#控制流程">#</a></h5>
<p>优先处理错误情况，尽早返回</p>
<p><img loading="lazy" src="C:%5cUsers%5cWIN10%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20220508185654638.png" alt="image-20220508185654638"  />
</p>
<p><img loading="lazy" src="C:%5cUsers%5cWIN10%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20220508185726866.png" alt="image-20220508185726866"  />
</p>
<h5 id="错误和异常处理">错误和异常处理<a hidden class="anchor" aria-hidden="true" href="#错误和异常处理">#</a></h5>
<h4 id="性能优化建议">性能优化建议<a hidden class="anchor" aria-hidden="true" href="#性能优化建议">#</a></h4>
<h5 id="benchmark">benchmark<a hidden class="anchor" aria-hidden="true" href="#benchmark">#</a></h5>
<h5 id="slice">Slice<a hidden class="anchor" aria-hidden="true" href="#slice">#</a></h5>
<p>尽量初始化容量信息，避免内存发生拷贝</p>
<p>因为切片操作并不复制切片指向的元素，创建一个新的切片会复用原来切片的底层数组，所以会有大内存未释放的陷阱</p>
<p><img loading="lazy" src="C:%5cUsers%5cWIN10%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20220508191454635.png" alt="image-20220508191454635"  />
</p>
<h5 id="map">Map<a hidden class="anchor" aria-hidden="true" href="#map">#</a></h5>
<p>预分配内存</p>
<h5 id="字符串处理">字符串处理<a hidden class="anchor" aria-hidden="true" href="#字符串处理">#</a></h5>
<p>+最慢</p>
<p>strings.Builder</p>
<p>bytes.Buffer最快</p>
<p><img loading="lazy" src="C:%5cUsers%5cWIN10%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20220508195908309.png" alt="image-20220508195908309"  />
</p>
<p><img loading="lazy" src="C:%5cUsers%5cWIN10%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20220508200629914.png" alt="image-20220508200629914"  />
</p>
<p><img loading="lazy" src="C:%5cUsers%5cWIN10%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20220508200610917.png" alt="image-20220508200610917"  />
</p>
<h5 id="空结构体">空结构体<a hidden class="anchor" aria-hidden="true" href="#空结构体">#</a></h5>
<p>可以用来实现set</p>
<h5 id="atomic包">atomic包<a hidden class="anchor" aria-hidden="true" href="#atomic包">#</a></h5>
<p>锁的实现是由操作系统来实现，属于系统调用</p>
<p>atomic操作通过硬件实现，效率比锁高</p>
<h3 id="性能调优实战">性能调优实战<a hidden class="anchor" aria-hidden="true" href="#性能调优实战">#</a></h3>
<p>要依靠数据，而不是猜测</p>
<p>要定位最大瓶颈而不是细枝末节</p>
<p>不要过早优化</p>
<p>不要过度优化</p>
<h4 id="pprof实战">pprof实战<a hidden class="anchor" aria-hidden="true" href="#pprof实战">#</a></h4>
<p><a href="https://blog.wolfogre.com/posts/go-ppof-practice/">https://blog.wolfogre.com/posts/go-ppof-practice/</a></p>
<p>cpu占用情况</p>
<p>go tool pprof http://localhost:6060/debug/pprof/profile</p>
<p>内存分配情况</p>
<p>go tool pprof http://localhost:6060/debug/pprof/heap</p>
<p>阻塞操作情况</p>
<p>go tool pprof http://localhost:6060/debug/pprof/block</p>
<p>goroutine堆栈</p>
<p>go tool pprof http://localhost:6060/debug/pprof/goroutine</p>
<p>锁竞争</p>
<p>go tool pprof http://localhost:6060/debug/pprof/mutex</p>
<p>gc</p>
<p>go tool pprof http://localhost:6060/debug/pprof/allocs</p>
<h4 id="pprof采样过程和原理">pprof采样过程和原理<a hidden class="anchor" aria-hidden="true" href="#pprof采样过程和原理">#</a></h4>
<h4 id="性能调优案例">性能调优案例<a hidden class="anchor" aria-hidden="true" href="#性能调优案例">#</a></h4>
<h5 id="业务服务优化">业务服务优化<a hidden class="anchor" aria-hidden="true" href="#业务服务优化">#</a></h5>
<p>建立服务性能评估手段</p>
<ol>
<li>服务性能评估手段</li>
<li>请求流量构造</li>
<li>压测范围</li>
<li>性能数据采集</li>
</ol>
<p>分析性能数据，定位性能评价</p>
<p>重点优化项改造</p>
<p>优化效果验证</p>
<p>进一步优化，服务整体链路分析</p>
<p>AB实验SDK的优化</p>
<p>编译器和运行时优化</p>
<h3 id="课后作业-重点内容-review">课后作业-重点内容 Review<a hidden class="anchor" aria-hidden="true" href="#课后作业-重点内容-review">#</a></h3>
<ol>
<li>
<p>了解下其他语言的编码规范，是否和 Go 语言编码规范有相通之处，注重理解哪些共同点？</p>
</li>
<li>
<p>编码规范或者性能优化建议大部分是通用的，有没有方式能够自动化对代码进行检测？</p>
</li>
<li>
<p>从 <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fgolang%2Fgo%2Ftree%2Fmaster%2Fsrc">github.com/golang/go/t…</a> 中选择感兴趣的包，看看官方代码是如何编写的？</p>
</li>
<li>
<p>使用 Go 进行并发编程时有哪些性能陷阱或者优化手段？</p>
</li>
<li>
<p>在真实的线上环境中，每个场景或者服务遇到的性能问题也是各种各样，搜索下知名公司的官方公众号或者博客，里面有哪些性能优化的案例？比如 <a href="https://link.juejin.cn?target=https%3A%2F%2Feng.uber.com%2Fcategory%2Foss-projects%2Foss-go%2F">eng.uber.com/category/os…</a></p>
</li>
<li>
<p>Go 语言本身在持续更新迭代，每个版本在性能上有哪些重要的优化点？</p>
<p>&lt; 作业提交截止时间：5月9日  10:00前 &gt;</p>
</li>
</ol>
<h3 id="正确答案">正确答案：<a hidden class="anchor" aria-hidden="true" href="#正确答案">#</a></h3>
<ol>
<li>
<p>可以了解下开源项目的编码规范，比如Google开源项目风格指南，</p>
<p>google.github.io/styleguide</p>
<p><a href="https://zh-google-styleguide.readthedocs.io/en/latest/">https://zh-google-styleguide.readthedocs.io/en/latest/</a></p>
</li>
<li>
<p>Go 语言有代码检查工具，可以和CI进行集成，https://github.com/golangci/golangci-lint</p>
</li>
<li>
<p>可以优先看看sync和net包的内容，实际在服务端编程过程中会经常用到</p>
<p><a href="https://github.com/golang/go/tree/master/src/sync">https://github.com/golang/go/tree/master/src/sync</a></p>
<p><a href="https://github.com/golang/go/tree/master/src/net">https://github.com/golang/go/tree/master/src/net</a></p>
</li>
<li>
<p>可以看看Effective Go的并发编程章节，</p>
<p><a href="https://go.dev/doc/effective_go#concurrency">https://go.dev/doc/effective_go#concurrency</a></p>
<p><a href="https://github.com/geektutu/high-performance-go">https://github.com/geektutu/high-performance-go</a></p>
</li>
<li>
<p>实际优化案例，</p>
<p><a href="https://eng.uber.com/how-we-saved-70k-cores-across-30-mission-critical-services/">https://eng.uber.com/how-we-saved-70k-cores-across-30-mission-critical-services/</a></p>
<p><a href="https://medium.com/coralogix-engineering/optimizing-a-golang-service-to-reduce-over-40-cpu-366b67c67ef9">https://medium.com/coralogix-engineering/optimizing-a-golang-service-to-reduce-over-40-cpu-366b67c67ef9</a></p>
</li>
<li>
<p>Go 的每次版本更新都有详细的文档说明，可以从中了解性能相关的信息，</p>
<p><a href="https://go.dev/doc/devel/release">https://go.dev/doc/devel/release</a></p>
</li>
</ol>
<h2 id="day4-高性能go语言发行版优化与落地实践">day4 高性能go语言发行版优化与落地实践<a hidden class="anchor" aria-hidden="true" href="#day4-高性能go语言发行版优化与落地实践">#</a></h2>
<p><a href="https://bytedance.feishu.cn/file/boxcnRcx62rX5X22Q2WFR5Xm5Oh?hash=cd874ae31e355b9a1f34ae0dad2fad5e">https://bytedance.feishu.cn/file/boxcnRcx62rX5X22Q2WFR5Xm5Oh?hash=cd874ae31e355b9a1f34ae0dad2fad5e</a></p>
<p>内存管理优化</p>
<p>编译器优化</p>
<h3 id="性能优化的基本问题">性能优化的基本问题<a hidden class="anchor" aria-hidden="true" href="#性能优化的基本问题">#</a></h3>
<p>性能优化是什么？</p>
<p>提升软件系统处理能力，减少不必要的耗费、充分发掘计算机算力</p>
<p>为什么要性能优化</p>
<p>用户体验</p>
<p>资源高效利用</p>
<h3 id="性能优化的2个层面">性能优化的2个层面<a hidden class="anchor" aria-hidden="true" href="#性能优化的2个层面">#</a></h3>
<p>业务层优化</p>
<p>语言运行时优化</p>
<h3 id="性能优化的可维护性">性能优化的可维护性<a hidden class="anchor" aria-hidden="true" href="#性能优化的可维护性">#</a></h3>
<h3 id="自动内存管理">自动内存管理<a hidden class="anchor" aria-hidden="true" href="#自动内存管理">#</a></h3>
<p>自动内存管理：由程序语言的运行时系统管理动态内存</p>
<p>避免手动处理内存</p>
<p>保证内存使用的正确性和安全性</p>
<p><img loading="lazy" src="C:%5cUsers%5cWIN10%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20220512100143414.png" alt="image-20220512100143414"  />
</p>
<p>评价gc算法：安全性、吞吐率、暂停时间、内存开销</p>
<p><img loading="lazy" src="C:%5cUsers%5cWIN10%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20220512100551366.png" alt="image-20220512100551366"  />
</p>
<h4 id="分代gc">分代GC<a hidden class="anchor" aria-hidden="true" href="#分代gc">#</a></h4>
<h4 id="引用计数">引用计数<a hidden class="anchor" aria-hidden="true" href="#引用计数">#</a></h4>
<p><img loading="lazy" src="C:%5cUsers%5cWIN10%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20220512101527133.png" alt="image-20220512101527133"  />
</p>
<h3 id="go内存管理及优化">go内存管理及优化<a hidden class="anchor" aria-hidden="true" href="#go内存管理及优化">#</a></h3>
<h4 id="分块">分块<a hidden class="anchor" aria-hidden="true" href="#分块">#</a></h4>
<h4 id="缓存">缓存<a hidden class="anchor" aria-hidden="true" href="#缓存">#</a></h4>
<h4 id="go对象分配的性能问题">Go对象分配的性能问题<a hidden class="anchor" aria-hidden="true" href="#go对象分配的性能问题">#</a></h4>
<p>分配路径过长</p>
<p>小对象居多</p>
<h4 id="balanced-gc">Balanced GC<a hidden class="anchor" aria-hidden="true" href="#balanced-gc">#</a></h4>
<p>指针碰撞风格的对象分配</p>
<p>实现了copying GC</p>
<p>性能收益</p>
<h3 id="编译器和静态分析">编译器和静态分析<a hidden class="anchor" aria-hidden="true" href="#编译器和静态分析">#</a></h3>
<h4 id="编译器的结构与编译的流程">编译器的结构与编译的流程<a hidden class="anchor" aria-hidden="true" href="#编译器的结构与编译的流程">#</a></h4>
<h4 id="编译器后端优化">编译器后端优化<a hidden class="anchor" aria-hidden="true" href="#编译器后端优化">#</a></h4>
<h4 id="数据流和控制流分析">数据流和控制流分析<a hidden class="anchor" aria-hidden="true" href="#数据流和控制流分析">#</a></h4>
<h4 id="过程内和过程间分析">过程内和过程间分析<a hidden class="anchor" aria-hidden="true" href="#过程内和过程间分析">#</a></h4>
<h3 id="go编译器优化">go编译器优化<a hidden class="anchor" aria-hidden="true" href="#go编译器优化">#</a></h3>
<h4 id="tradeoff">Tradeoff<a hidden class="anchor" aria-hidden="true" href="#tradeoff">#</a></h4>
<p>：用编译时间换取更高效的机器码</p>
<h4 id="beast-mode">Beast mode<a hidden class="anchor" aria-hidden="true" href="#beast-mode">#</a></h4>
<p>函数内联</p>
<p>逃逸分析</p>
<h3 id="课后作业--重点内容-review">课后作业- 重点内容 Review<a hidden class="anchor" aria-hidden="true" href="#课后作业--重点内容-review">#</a></h3>
<ol>
<li>
<p>从业务层和语言运行时层进行优化分别有什么特点？</p>
</li>
<li>
<p>从软件工程的角度出发，为了保证语言SDK的可维护性和可拓展性，在进行运行时优化时需要注意什么？</p>
</li>
<li>
<p>自动内存管理技术从大类上分为哪两种，每一种技术的特点以及优缺点有哪些？</p>
</li>
<li>
<p>什么是分代假说？分代 GC 的初衷是为了解决什么样的问题？</p>
</li>
<li>
<p>Go 是如何管理和组织内存的？</p>
</li>
<li>
<p>为什么采用 bump-pointer 的方式分配内存会很快？</p>
</li>
<li>
<p>为什么我们需要在编译器优化中进行静态代码分析？</p>
</li>
<li>
<p>函数内联是什么，这项优化的优缺点是什么？</p>
</li>
<li>
<p>什么是逃逸分析？逃逸分析是如何提升代码性能的？</p>
<p>&lt; 作业提交截止时间：5月12日 10:00前 &gt;</p>
</li>
</ol>
<h3 id="正确答案-1">正确答案：<a hidden class="anchor" aria-hidden="true" href="#正确答案-1">#</a></h3>
<ol>
<li>
<p>业务层的优化需要针对具体问题具体分析；而语言运行时层的优化针对的是更通用的问题，需要在多方面进行 tradeoff。两者都需要自动化性能分析工具的支持。</p>
</li>
<li>
<p>因为语言 SDK 会被大量广泛使用，保证接口的稳定性和一致性至关重要。对已有接口的改动，需要保证兼容性；对新增的接口，需要提供明确的文档说明。对于功能的改动，最好通过选项进行隔离，保证新增改动在不打开的情况下不影响原本的功能。</p>
</li>
<li>
<p>主要分为追踪垃圾回收和引用计数：</p>
<p>a. 追踪垃圾回收</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>1️⃣ 回收内存的条件：回收不可达的对象；
</span></span><span style="display:flex;"><span>2️⃣ 回收时，首先会扫描 GC roots，例如栈上的对象、全局变量等；
</span></span><span style="display:flex;"><span>3️⃣ 从 GC roots 出发，沿着指针指向，追踪所有的可达对象；
</span></span><span style="display:flex;"><span>4️⃣ 追踪完成后，回收所有不可达对象的内存。
</span></span><span style="display:flex;"><span>复制代码
</span></span></code></pre></td></tr></table>
</div>
</div><p>b.  引用计数</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>1️⃣ 对象有一个与之关联的引用数目。当且仅当引用数大于 0 时对象存活；
</span></span><span style="display:flex;"><span>2️⃣ 当对象的引用数目为 0 时，内存可以被回收；
</span></span><span style="display:flex;"><span>3️⃣ 优点：内存管理的开销被平摊到程序运行中，且内存管理不需要了解 runtime 的实现细节；
</span></span><span style="display:flex;"><span>4️⃣ 缺点：维护引用计数的开销较大；额外的内存开销存储引用计数；无法回收带有环的数据结构；回收大数据结构时依然会造成程序暂停。
</span></span><span style="display:flex;"><span>复制代码
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>大量的对象会很快死去。分代 GC 的思想是：针对不同生命周期的对象采取不同策略的内存管理机制。</p>
</li>
<li>
<p>Go 使用 TCMalloc 风格的内存管理方式。</p>
<p>a.  TC 是 thread caching 的简写。每个线程都绑定 cache 方便线程快速分配内存；</p>
<p>b.  内存被划分为特定大小的块。根据对象是否包含指针，将内存块分为 scan 和 noscan 两种；</p>
<p>c.  根据内存分配请求的大小，选择合适的内存块返回，完成一次内存分配操作；</p>
<p>d.  回收的内存不会立刻还给操作系统，而是在 Go 内部缓存起来，方便下次分配。</p>
</li>
<li>
<p>每个线程都持有用于对象分配的 buffer，因此指针碰撞方式的内存分配无需加锁或使用 CAS 操作；对象分配的操作非常简单。</p>
</li>
<li>
<p>通过静态分析，我们可以获取更多关于程序的非平凡特性 (non-trivial properties)；这些关于程序的知识可以指导编译器优化。例如通过逃逸分析得知对象并未逃逸出当前函数，因此对象可以在栈上分配，避免频繁在堆上分配对象，降低 GC 的压力。</p>
</li>
<li>
<p>函数内联：将被调用函数的函数体的副本替换到调用位置上，同时重写代码以反映参数的绑定。</p>
<p>a.  优点</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>① 消除函数调用；
</span></span><span style="display:flex;"><span>② 由于没有了函数调用，过程间分析转化为过程内分析；
</span></span><span style="display:flex;"><span>复制代码
</span></span></code></pre></td></tr></table>
</div>
</div><p>b.  缺点</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>① 函数体变大；
</span></span><span style="display:flex;"><span>② 编译生成的 Go 镜像变大。
</span></span><span style="display:flex;"><span>复制代码
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>逃逸分析：分析代码中指针的动态作用域，即指针在何处可以被访问。</p>
<p>通过逃逸分析得知对象并未逃逸出当前函数，因此对象可以在栈上分配，避免频繁在堆上分配对象，降低 GC 的压力。</p>
</li>
</ol>
<h2 id="day5-gorm">day5 GORM<a hidden class="anchor" aria-hidden="true" href="#day5-gorm">#</a></h2>
<p><a href="https://bytedance.feishu.cn/file/boxcnct7Jc8Td2Oolfbm6t4HfJg?hash=e52044cf65cc597854fbf299f2a26073">https://bytedance.feishu.cn/file/boxcnct7Jc8Td2Oolfbm6t4HfJg?hash=e52044cf65cc597854fbf299f2a26073</a></p>
<h3 id="理解databasesql">理解database/sql<a hidden class="anchor" aria-hidden="true" href="#理解databasesql">#</a></h3>
<h4 id="基本用法">基本用法<a hidden class="anchor" aria-hidden="true" href="#基本用法">#</a></h4>
<h4 id="设计原理">设计原理<a hidden class="anchor" aria-hidden="true" href="#设计原理">#</a></h4>
<h4 id="基础概念">基础概念<a hidden class="anchor" aria-hidden="true" href="#基础概念">#</a></h4>
<h3 id="gorm使用简介">GORM使用简介<a hidden class="anchor" aria-hidden="true" href="#gorm使用简介">#</a></h3>
<h4 id="基本用法-1">基本用法<a hidden class="anchor" aria-hidden="true" href="#基本用法-1">#</a></h4>
<h4 id="model定义">Model定义<a hidden class="anchor" aria-hidden="true" href="#model定义">#</a></h4>
<h3 id="惯例约定">惯例约定<a hidden class="anchor" aria-hidden="true" href="#惯例约定">#</a></h3>
<h4 id="关联">关联<a hidden class="anchor" aria-hidden="true" href="#关联">#</a></h4>
<h3 id="gorm设计原理">GORM设计原理<a hidden class="anchor" aria-hidden="true" href="#gorm设计原理">#</a></h3>
<h4 id="sql生成">SQL生成<a hidden class="anchor" aria-hidden="true" href="#sql生成">#</a></h4>
<h4 id="插件扩展">插件扩展<a hidden class="anchor" aria-hidden="true" href="#插件扩展">#</a></h4>
<h4 id="connpool">ConnPool<a hidden class="anchor" aria-hidden="true" href="#connpool">#</a></h4>
<h4 id="dialector">Dialector<a hidden class="anchor" aria-hidden="true" href="#dialector">#</a></h4>
<h3 id="gorm最佳实践">GORM最佳实践<a hidden class="anchor" aria-hidden="true" href="#gorm最佳实践">#</a></h3>
<p>数据序列化与SQL表达式</p>
<p>批量数据操作</p>
<p>代码复用、分库分表、Sharding</p>
<p>混沌工程/压测</p>
<p>Logger/Trace</p>
<p>Migrate</p>
<p>Gen代码生成/Raw SQL</p>
<p>安全</p>
<h3 id="课后作业">课后作业<a hidden class="anchor" aria-hidden="true" href="#课后作业">#</a></h3>
<p>作业要求：首先实现一个脚本工具：包含一个 User struct, 只包含 UUID string, Name string，Age int，Version int 四个字段，在脚本中使用 gorm ＋ mysql 初始化 DB, 并使用初始化后的 DB 的 AutoMigrate 迁移数据表。</p>
<p>然后完成一个 Gen (github.com/go-gorm/gen/) 项目，基于上面创建的数据库及表名，通过 Gen 的自动同步库表功能生成 struct People，并给该 struct 生成基本 CRUD 方法，基于 OnConflict Upsert 功能实现 100 个随机用户的创建，其中需要包含重复的 UUID 用户的 Upsert, 在 Upsert 时，如果遇到重复 UUID 中，需要将 Version 更新为 Version + 1。最后再通过一条自定义的Raw SQL 实现，将数据按 Version 分组，并取出 Version 最高的一组的用户总数的功能，该 Raw SQL 需要通过自定义查询方法的形式实现，需要给 People 生成相应的方法名: <code>GetMaxVersionCount</code>。完成后提交代码到 github</p>
<p>&lt; 作业提交截止时间：5月14日 10:00前 &gt;</p>
<h3 id="正确答案-2">正确答案：<a hidden class="anchor" aria-hidden="true" href="#正确答案-2">#</a></h3>
<ul>
<li>
<p>(WIP)</p>
</li>
<li>
<p>参考 <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fgo-gorm%2Fmysql%2F">github.com/go-gorm/mys…</a> , 实现出 gorm dialector interface (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fgo-gorm%2Fgorm%2Fblob%2Fb0104943edf50bba6072d18ca91e949ff8d4e3a2%2Finterfaces.go%23L12-L21">github.com/go-gorm/gor…</a>)</p>
</li>
</ul>
<p>通过 docker compose 跑起来环境后，go test 测试通过成后即可</p>
<ul>
<li>通过实现插件的 callbacks 接口，然后通过 Use 注册使用加解密码功能，在实现中需要从 db.Statement.Context 读取到当前租户 ID，然后通过该 ID 进行加解密</li>
</ul>
<p>通过 docker compose 跑起来环境后，go test 测试通过成后即可</p>
<h2 id="day61-实战项目">day6.1 实战项目<a hidden class="anchor" aria-hidden="true" href="#day61-实战项目">#</a></h2>
<p><a href="https://bytedance.feishu.cn/docx/doxcnDExcSSmRx5R9s8uKmZRpNc">https://bytedance.feishu.cn/docx/doxcnDExcSSmRx5R9s8uKmZRpNc</a></p>
<p><a href="https://live.juejin.cn/4354/yc_teacher">https://live.juejin.cn/4354/yc_teacher</a></p>
<h2 id="day62-从需求到上线全流程">day6.2 从需求到上线全流程<a hidden class="anchor" aria-hidden="true" href="#day62-从需求到上线全流程">#</a></h2>
<p><a href="https://bytedance.feishu.cn/file/boxcnBFwiH4ItgbiBBADJcFTKBc">https://bytedance.feishu.cn/file/boxcnBFwiH4ItgbiBBADJcFTKBc</a></p>
<p><a href="https://live.juejin.cn/4354/yc_demand">https://live.juejin.cn/4354/yc_demand</a></p>
<h3 id="为什么要有流程">为什么要有流程<a hidden class="anchor" aria-hidden="true" href="#为什么要有流程">#</a></h3>
<table>
<thead>
<tr>
<th>分类</th>
<th>英文</th>
<th>中文</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>研发模式</td>
<td>Waterfall Model</td>
<td>瀑布模型</td>
<td>瀑布模型（Waterfall Model）最早强调软件或系统开发应有完整之周期，且必须完整的经历周期之每一开发阶段，并系统化的考量分析与设计的技术、时间与资源之投入等。由于该模式强调系统开发过程需有完整的规划、分析、设计、测试及文件等管理与控制，因此能有效的确保系统质量，它已经成为软体业界大多数软件开发的最初标准</td>
</tr>
<tr>
<td></td>
<td>The Scaled Agile Framework(SAFe)</td>
<td>规模化敏捷框架</td>
<td></td>
</tr>
<tr>
<td></td>
<td>Scrum</td>
<td>Scrum</td>
<td>在软件工程中，Scrum是以经验过程为依据，采用迭代、增量的方法来提高产品开发的可预见性并控制风险的理论，Scrum不是一种过程，也不是一项构建产品的技术，而是一个框架，在Scrum框架中可以应用各种过程和技术，Scrum的作用是让开发实践方法的相对功效显现出来以便随时改进。 Scrum是敏捷(Agile)开发的一种实践模式，敏捷开发强调拥抱需求变化，快速响应不断变化的需求，并尽可能快地提供可以工作的软件产品，敏捷最强调的是可以正常工作的软件产品，文档等不是非常的强调（并非不要文档，只是需要必要的文档），敏捷理论认为面对面的沟通交流远比文档更有效。 敏捷开发的Scrum模式是以价值驱动(Value-Driven)的开发模式，即认为用户的需求并不一定需要100%实现，最重要的是将对用户最有价值的功能实现并交付.</td>
</tr>
<tr>
<td>流程中的概念</td>
<td>Scrum Master</td>
<td>敏捷教练</td>
<td>Scrum Master是Scrum教练和团队带头人，确保团队合理的运作Scrum，并帮助团队扫除实施中的障碍</td>
</tr>
<tr>
<td>Product Owner</td>
<td>产品负责人</td>
<td>产品负责人，确定产品的方向和愿景，定义产品发布的内容、优先级及交付时间，为产品投资回报率负责；</td>
<td></td>
</tr>
<tr>
<td>Agile Release Train</td>
<td>敏捷发布火车</td>
<td>敏捷开发的一种发布模式</td>
<td></td>
</tr>
<tr>
<td>RD</td>
<td>研发工程师</td>
<td>RD一般指Research and Development Engineer，即研发工程师。</td>
<td></td>
</tr>
<tr>
<td>PM</td>
<td>产品经理</td>
<td>产品经理</td>
<td></td>
</tr>
<tr>
<td>PRD</td>
<td>产品需求文档</td>
<td>产品需求文档</td>
<td></td>
</tr>
<tr>
<td>RD</td>
<td>研发工程师</td>
<td>RD一般指Research and Development Engineer，即研发工程师。</td>
<td></td>
</tr>
<tr>
<td>UED</td>
<td>交互设计师</td>
<td>用户体验设计师，交互设计师，界面设计师</td>
<td></td>
</tr>
<tr>
<td>QA</td>
<td>测试工程师</td>
<td>指理解产品的功能要求，并对其进行测试，检查软件有没有缺陷（Bug），测试软件是否具有稳定性（Robustness）、安全性、易操作性等性能，写出相应的测试规范和测试用例的专门工作人员。</td>
<td></td>
</tr>
<tr>
<td>Backlog</td>
<td>待办事项</td>
<td>产品订单（product backlog）是整个专案的概要文档。产品订单包括所有所需特性的粗略的描述。产品订单是关于将要生产什么样的产品。产品订单是开放的，每个人都可以编辑。产品订单包括粗略的估算，通常以天为单位。估算将帮助产品负责人衡量时程表和优先级（例如，如果&quot;增加拼写检查&quot;特性的估计需要花3天或3个月，将影响产品负责人对该特性的渴望）。 冲刺订单（sprint backlog）是大大细化了的文档，包含团队如何实现下一个冲刺的需求的信息。任务被分解为以小时为单位，没有任务可以超过16个小时。如果一个任务超过16个小时，那么它就应该被进一步分解。冲刺订单上的任务不会被分派，而是由团队成员签名认领他们喜爱的任务。</td>
<td></td>
</tr>
<tr>
<td>Grooming Meeting</td>
<td>Grooming会议</td>
<td>这个会议上面会由PO来描述下个迭代需要实现的功能，大家讨论要不要干</td>
<td></td>
</tr>
<tr>
<td>Planning Meeting</td>
<td>Planning会议</td>
<td>这个会议讨论功能具体什么时候干，要估算任务的工作量</td>
<td></td>
</tr>
<tr>
<td>基础知识</td>
<td>CNCF</td>
<td>云原生计算基金会</td>
<td>云原生计算是软件开发中的一种方法，它利用云计算“在现代动态环境（例如公共云、私有云和混合云）中构建和运行可扩展的应用程序”。 通过声明性代码部署的容器、微服务、无服务器功能和不可变基础设施等技术是这种架构风格的常见元素。</td>
</tr>
<tr>
<td>Kubernetes</td>
<td>K8S</td>
<td>生产级别的容器编排系统。Kubernetes 是一个可移植的、可扩展的开源平台，用于管理容器化的工作负载和服务，可促进声明式配置和自动化。 Kubernetes 拥有一个庞大且快速增长的生态系统。Kubernetes 的服务、支持和工具广泛可用。</td>
<td></td>
</tr>
<tr>
<td>FAAS</td>
<td>函数即服务</td>
<td>函数即服务。仅通过编写函数（function）就能够发布为一个 API 或者服务，实现业务功能的技术体系。由于处理单元为函数粒度，往往底层也能够支持自动扩缩容地更精细化使用计算资源，开发侧支持事件驱动，可由消息或多种 Hook 触发，同时拥有快速上线、按需付费等优点。</td>
<td></td>
</tr>
<tr>
<td>APAAS</td>
<td>平台即服务</td>
<td>是一个为应用程序服务提供开发和部署环境的云服务</td>
<td></td>
</tr>
<tr>
<td>IDE</td>
<td>IDE</td>
<td>用于提供程序开发环境的应用程序。一般包括代码编辑器、编译器、调试器和图形用户界面等工具</td>
<td></td>
</tr>
<tr>
<td>Git</td>
<td>Git</td>
<td>分布式的版本管理系统</td>
<td></td>
</tr>
<tr>
<td>Merge/Rebase</td>
<td>合并/变基</td>
<td>处理代码分支的操作，将不同的分支整合成一个的两种方式</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="后端的定位">后端的定位<a hidden class="anchor" aria-hidden="true" href="#后端的定位">#</a></h4>
<ul>
<li>瀑布模式
<ul>
<li>按照时间节点参与会议，产出文档（系统分析，概要设计，详细设计，接口文档，提测文档等）</li>
<li>按照时间节点交付测试</li>
<li>按照时间节点发布</li>
</ul>
</li>
<li>敏捷团队
<ul>
<li>跟随迭代制定规划，进行开发</li>
<li>参与待办事项整理会议（Backlog Grooming Meeting）
<ul>
<li>PO描述下个迭代希望实现的用户故事</li>
</ul>
</li>
<li>迭代计划会议（Sprint Planning Meeting）
<ul>
<li>选择迭代的任务和估算工作量</li>
</ul>
</li>
<li>每日站会（Standup Meeting）
<ul>
<li>昨天你做了什么?</li>
<li>今天你将要做什么?</li>
<li>你有需要帮助的地方吗?</li>
</ul>
</li>
<li>评审会（Retrospective Meeting）
<ul>
<li>小组向产品负责人展示迭代工作结果</li>
</ul>
</li>
<li>反思会（Retrospective Meeting）
<ul>
<li>在每个迭代后召开简短的反思会，总结哪些事情做得好，哪些事情做得不好</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="团队协作">团队协作<a hidden class="anchor" aria-hidden="true" href="#团队协作">#</a></h4>
<p>一个具体的迭代时间表：</p>
<p><img loading="lazy" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b82fefa85cd94b60be71e920121ee6f8~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp" alt=""  />
</p>
<h3 id="2-有哪些流程">2. 有哪些流程<a hidden class="anchor" aria-hidden="true" href="#2-有哪些流程">#</a></h3>
<h4 id="需求阶段">需求阶段<a hidden class="anchor" aria-hidden="true" href="#需求阶段">#</a></h4>
<ul>
<li>
<p>不要浪费时间讨论不应该存在的问题</p>
</li>
<li>
<p>站在用户的角度思考</p>
</li>
<li>
<p>给出后端系统视角的建议，估算任务优先级</p>
</li>
</ul>
<h4 id="开发阶段">开发阶段<a hidden class="anchor" aria-hidden="true" href="#开发阶段">#</a></h4>
<ul>
<li>
<p>云原生下的开发：</p>
<ul>
<li>容器化技术</li>
<li>微服务技术</li>
<li>WebIDE</li>
</ul>
</li>
<li>
<p>团队分支策略：</p>
<ul>
<li>为什么会有分支策略</li>
<li>有哪些分支策略</li>
<li>合并的方式</li>
</ul>
</li>
<li>
<p>代码规范</p>
<ul>
<li>养成良好的注释习惯，超过三个月的代码，自己都会忘了当时在想什么</li>
<li>不要有魔法数字，魔法字符串</li>
<li>重复的逻辑抽象成公共的方法，不要copy代码</li>
<li>正确使用IDE的重构功能，防止修改错误</li>
</ul>
</li>
<li>
<p>自测</p>
<ul>
<li>单元测试</li>
<li>功能环境测试</li>
<li>测试数据构造</li>
</ul>
</li>
<li>
<p>文档</p>
<ul>
<li>大型改造需要有技术设计文档，方案评审</li>
<li>好的接口文档能更方便的和前端进行沟通</li>
</ul>
</li>
</ul>
<h4 id="测试阶段">测试阶段<a hidden class="anchor" aria-hidden="true" href="#测试阶段">#</a></h4>
<ul>
<li>功能测试</li>
</ul>
<p>功能测试，是为了测试一个新开发的功能，因此需要有能模拟线上的开发和测试环境，环境之间能相互隔离，这样可以独立验证不同的新功能</p>
<ul>
<li>
<p>集成测试：集成测试，是为了把几个功能合在一起测试，因为可能各个新功能独立测试没有问题，但是合在一起却产生了bug</p>
</li>
<li>
<p>回归测试：回归测试是为了验证老的功能不被新的改动影响</p>
</li>
</ul>
<h4 id="发布阶段">发布阶段<a hidden class="anchor" aria-hidden="true" href="#发布阶段">#</a></h4>
<ul>
<li>
<p>各种发布模式</p>
<ul>
<li>蛮力发布：简单粗暴，直接用新版本覆盖老版本。</li>
<li>金丝雀发布：由于金丝雀对瓦斯极其敏感，因此以前矿工开矿下矿洞前，先会放一只金丝雀进去探是否有有毒气体，看金丝雀能否活下来，金丝雀发布由此得名。</li>
<li>滚动发布：每个实例都通过金丝雀的方式逐步放大流量，对用户影响小，体验平滑</li>
<li>蓝绿发布：常备两个集群，先把流量全部切换到Group 1，升级Group2，然后再把流量全部切换到Group 2，升级Group 1。最终恢复流量。</li>
<li>红黑发布：与蓝绿发布类似，但是日常只有一个集群工作，发布时扩容一个集群升级新版本，切换流量后下掉老版本的集群。</li>
</ul>
</li>
<li>
<p>发布过程要做的事</p>
<ul>
<li>发布负责人
<ul>
<li>负责按照计划执行发布</li>
<li>需要通知各个相关人员发布进展</li>
<li>观察各个服务的发布状态，及时处理异常</li>
</ul>
</li>
<li>变更服务的相关RD
<ul>
<li>按照上线checklist检查服务的日志，监控，响应上线过程中的告警</li>
<li>对于自己负责的改动，在小流量或者是预览环境进行功能验证</li>
<li>执行发布计划中的其他操作（如线上配置，数据处理等）</li>
</ul>
</li>
<li>值班同学
<ul>
<li>发布过程中的监控和告警需要特别关注，如果有异常需要立刻判断是否由变更引起</li>
<li>如果有变更引起的告警或者用户反馈，需要及时中止发布</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="运维阶段">运维阶段<a hidden class="anchor" aria-hidden="true" href="#运维阶段">#</a></h4>
<h3 id="3-怎样执行流程">3. 怎样执行流程<a hidden class="anchor" aria-hidden="true" href="#3-怎样执行流程">#</a></h3>
<h4 id="devops">DevOps<a hidden class="anchor" aria-hidden="true" href="#devops">#</a></h4>
<ul>
<li>效率竖井
<ul>
<li>流程中实际产生价值的部分很短</li>
<li>大量的时间用在等待和传递上</li>
<li>人和人之间的沟通很慢</li>
</ul>
</li>
</ul>
<p><img loading="lazy" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c12374129f8d4c11a2a07b74bd6ed511~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp" alt="img"  />
</p>
<ul>
<li>DevOps解决方案
<ul>
<li>代码管理</li>
<li>自动化测试</li>
<li>持续集成</li>
<li>持续交付</li>
</ul>
</li>
</ul>
<h4 id="全流程自动化">全流程自动化<a hidden class="anchor" aria-hidden="true" href="#全流程自动化">#</a></h4>
<ul>
<li>
<p>通过效能平台串联各个阶段</p>
<ul>
<li>需求发起研发流程的自动化</li>
<li>写代码，测试环境部署的自动化</li>
<li>自动化测试触发和报告分析</li>
<li>发布过程可观测融入流程</li>
</ul>
</li>
<li>
<p>减少无价值的等待</p>
<ul>
<li>分析整个流程的耗时，计算真正产生价值的时间</li>
<li>不断优化流程，让有价值的流程时间占比上升</li>
</ul>
</li>
</ul>
<h3 id="参考文献">参考文献<a hidden class="anchor" aria-hidden="true" href="#参考文献">#</a></h3>
<ol>
<li>
<p>瀑布模型 <a href="https://link.juejin.cn?target=https%3A%2F%2Fzh.wikipedia.org%2Fwiki%2F%E7%80%91%E5%B8%83%E6%A8%A1%E5%9E%8B">zh.wikipedia.org/wiki/%E7%80…</a></p>
</li>
<li>
<p>Scrum: <a href="https://link.juejin.cn?target=https%3A%2F%2Fzh.wikipedia.org%2Fwiki%2FScrum">zh.wikipedia.org/wiki/Scrum</a></p>
</li>
<li>
<p>SAFe：</p>
<p>a.  <a href="https://link.juejin.cn?target=http%3A%2F%2Fwww.woshipm.com%2Fpd%2F4331832.html">www.woshipm.com/pd/4331832.…</a>
b.  <a href="https://link.juejin.cn?target=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FScaled_agile_framework">en.wikipedia.org/wiki/Scaled…</a></p>
</li>
<li>
<p>CNCF：<a href="https://link.juejin.cn?target=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FCloud_Native_Computing_Foundation">en.wikipedia.org/wiki/Cloud_…</a></p>
</li>
<li>
<p>常用的发布模式：<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.cnblogs.com%2FLeo_wl%2Fp%2F14395960.html">www.cnblogs.com/Leo_wl/p/14…</a></p>
</li>
</ol>
<h3 id="课后作业-1">课后作业：<a hidden class="anchor" aria-hidden="true" href="#课后作业-1">#</a></h3>
<ol>
<li>
<p>敏捷宣言是什么？</p>
</li>
<li>
<p>Grooming meeting 的作用是什么？</p>
</li>
<li>
<p>我们为什么需要进行集成测试？</p>
</li>
<li>
<p>遇到线上问题，我们要做的四个关键动作是什么？</p>
</li>
<li>
<p>DevOps 包含了哪些流程？</p>
<p>&lt; 作业提交截止时间：5月17日 10:00前 &gt;</p>
</li>
</ol>
<h3 id="正确答案-3">正确答案：<a hidden class="anchor" aria-hidden="true" href="#正确答案-3">#</a></h3>
<ol>
<li>
<p>敏捷宣言参考：<a href="https://link.juejin.cn?target=https%3A%2F%2Fagilemanifesto.org%2Fiso%2Fzhchs%2Fmanifesto.html">agilemanifesto.org/iso/zhchs/m…</a></p>
</li>
<li>
<p>PO描述下个迭代希望实现的用户故事，PM提出需求列表</p>
</li>
<li>
<p>不同人开发的功能合并在一起测试，相互之间的影响可能产生缺陷；迭代发布的所有功能合并在一起测试，确保发布的所有功能之间的影响不产生缺陷</p>
</li>
<li>
<p>止损，周知，定位，修复</p>
</li>
<li>
<p>DevOps概念上，涵盖了软件交付生命周期的全流程，包含需求-&gt;开发-&gt;构建-&gt;测试-&gt;发布-&gt;运维的研发环节</p>
</li>
</ol>
<h2 id="day71-计算机网络基本概念">day7.1 计算机网络基本概念<a hidden class="anchor" aria-hidden="true" href="#day71-计算机网络基本概念">#</a></h2>
<p><a href="https://live.juejin.cn/4354/yc_computer">https://live.juejin.cn/4354/yc_computer</a></p>
<p><a href="https://bytedance.feishu.cn/file/boxcneJVcYNfEn3umrE5K806h0g">https://bytedance.feishu.cn/file/boxcneJVcYNfEn3umrE5K806h0g</a></p>
<p><a href="https://juejin.cn/post/7097126973163454494#heading-0">https://juejin.cn/post/7097126973163454494#heading-0</a></p>
<h3 id="刷抖音网络是怎么交互的">刷抖音网络是怎么交互的？<a hidden class="anchor" aria-hidden="true" href="#刷抖音网络是怎么交互的">#</a></h3>
<h3 id="怎么让我的手机能访问抖音服务器">怎么让我的手机能访问抖音服务器<a hidden class="anchor" aria-hidden="true" href="#怎么让我的手机能访问抖音服务器">#</a></h3>
<h4 id="网络接入-互联网">网络接入-互联网<a hidden class="anchor" aria-hidden="true" href="#网络接入-互联网">#</a></h4>
<h4 id="网络接入-路由">网络接入-路由<a hidden class="anchor" aria-hidden="true" href="#网络接入-路由">#</a></h4>
<p>交换机-同网段发包交互？</p>
<p>找MAC地址就行，SDN（Software Defined Network）软件定义网络</p>
<p>路由一定是对称的吗？</p>
<p>不一定，去的时候可以是一条路，回来的时候另一条路</p>
<p>路由是工作在哪一层协议？</p>
<p>ip层 传输层</p>
<p>路由改的是IP地址吗？</p>
<p>源IP地址和⽬标IP地址在传输过程中是不会变化的，只有源 MAC 地址和⽬标 MAC ⼀直在变化。</p>
<p>动态路由BGP/OSPF？</p>
<p><a href="https://blog.csdn.net/weixin_43914604/article/details/105084158">https://blog.csdn.net/weixin_43914604/article/details/105084158</a></p>
<p><a href="https://blog.csdn.net/weixin_43914604/article/details/105313629">https://blog.csdn.net/weixin_43914604/article/details/105313629</a></p>
<h4 id="网络接入-arp协议">网络接入-ARP协议<a hidden class="anchor" aria-hidden="true" href="#网络接入-arp协议">#</a></h4>
<p>逻辑同网段才能发送ARP？</p>
<p><a href="https://blog.csdn.net/weixin_43914604/article/details/105138313">https://blog.csdn.net/weixin_43914604/article/details/105138313</a></p>
<p>ARP请求广播，应答单播</p>
<p>ARP的本质是寻求下一跳的MAC，而不是请求目标地址</p>
<p>非同网段需要借助路由器的帮助</p>
<p>免费ARP？</p>
<p>免费告诉别人我的MAC地址</p>
<p>免费 ARP（Gratuitous ARP）包是一种特殊的 ARP 请求，它并非期待得到 IP 对应的 MAC 地址</p>
<p>免费 ARP 报文与普通 ARP 请求报文的区别在于报文中的目标 IP 地址。普通 ARP 报文中的目标 IP 地址是其他主机的 IP 地址；而免费 ARP 的请求报文中，目标 IP 地址是自己的 IP 地址。</p>
<p><a href="https://zhuanlan.zhihu.com/p/371088648">https://zhuanlan.zhihu.com/p/371088648</a></p>
<p>ARP代理？</p>
<p><img loading="lazy" src="C:%5cUsers%5cWIN10%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20220516110900752.png" alt="image-20220516110900752"  />
</p>
<h4 id="网络接入-ip协议">网络接入-IP协议<a hidden class="anchor" aria-hidden="true" href="#网络接入-ip协议">#</a></h4>
<p>唯一标识，互联网通用。抖音客户端一个、抖音服务端一个</p>
<p>Mac地址不能替代IP地址吗？</p>
<p><a href="https://www.cnblogs.com/botoo/p/7793036.html">https://www.cnblogs.com/botoo/p/7793036.html</a></p>
<ul>
<li>IP地址是网络层使用的地址，它是分层次等级的。</li>
<li>硬件地址是数据链路层使用的地址(如MAC地址)，它是平面式的。</li>
</ul>
<p>随着网络中的设备逐渐增多，人们发现路由（也就是寻找数据包从发送方到接收方的路径）变得越来越困难了</p>
<p>MAC 地址就像自己的 ID 号，而 IP 地址就像带着邮政编码的住址，各有各的用途。所以我们需要两个地址，缺一不可。</p>
<p>IPv4不够用，一般怎么解决？</p>
<p>NAT、IPv6</p>
<h4 id="网络接入-nat">网络接入-NAT<a hidden class="anchor" aria-hidden="true" href="#网络接入-nat">#</a></h4>
<p>家里路由器是怎样上网的？</p>
<p>(Network Address Translation)网络地址转换</p>
<p>私有地址（10 172 192）&ndash;公用地址</p>
<p>该网络中的主机使用私用IP地址.当私有网络内部主机和外部Internet通信时,网关(gateway)路由器负责将私有IP地址转换为全球IP地址</p>
<p>多个内网客户端访问同一个目标地址+端口，源端口恰好一样，冲突了？</p>
<p>NAPT</p>
<p>(Network Address and Port Translation)</p>
<p>把端口也变了</p>
<h3 id="网络打通了怎么下载视频">网络打通了怎么下载视频<a hidden class="anchor" aria-hidden="true" href="#网络打通了怎么下载视频">#</a></h3>
<h4 id="网络传输-数据包">网络传输-数据包<a hidden class="anchor" aria-hidden="true" href="#网络传输-数据包">#</a></h4>
<h4 id="网络传输-数据包发送">网络传输-数据包发送<a hidden class="anchor" aria-hidden="true" href="#网络传输-数据包发送">#</a></h4>
<h4 id="网络传输-先请求dns">网络传输-先请求DNS<a hidden class="anchor" aria-hidden="true" href="#网络传输-先请求dns">#</a></h4>
<p><a href="https://blog.csdn.net/weixin_43914604/article/details/105583806">https://blog.csdn.net/weixin_43914604/article/details/105583806</a></p>
<h4 id="网络传输-dns的传输协议udp">网络传输-DNS的传输协议UDP<a hidden class="anchor" aria-hidden="true" href="#网络传输-dns的传输协议udp">#</a></h4>
<p>由于过于简单，用好很难</p>
<p>发包每次发多少？怎么避免切片？</p>
<p>MTU（数据帧最大传输单元）有限制，∴要分片</p>
<p>怎么知道没有丢包？</p>
<p>怎么权衡传输效率与质量？</p>
<h4 id="网络传输-tcp三次握手">网络传输-TCP三次握手<a hidden class="anchor" aria-hidden="true" href="#网络传输-tcp三次握手">#</a></h4>
<p>拔了网线，连接会断吗？</p>
<p>看具体情况。</p>
<p>假设TCP有探活，假设刚好在一次探活后拔了网线，不会立马断开</p>
<p>你真的了解TCP三次握手？</p>
<p>最大报文段长度（MSS）是<a href="https://baike.baidu.com/item/TCP%E5%8D%8F%E8%AE%AE/8988699">TCP协议</a>的一个选项，用于在TCP连接建立时，收发双方协商通信时每一个报文段所能承载的最大数据长度（不包括文段头）。为了避免IP切片</p>
<p>区分MSS与MTU</p>
<p>最大报文段长度（MSS）与<a href="https://baike.baidu.com/item/%E6%9C%80%E5%A4%A7%E4%BC%A0%E8%BE%93%E5%8D%95%E5%85%83/9730690">最大传输单元</a>（Maximum Transmission Unit, MTU）均是协议用来定义最大长度的。不同的是，MTU应用于OSI模型的第二层数据链接层，并无具体针对的协议。MTU限制了数据链接层上可以传输的数据包的大小，也因此限制了上层（网络层）的数据包大小。例如，如果已知某局域网的MTU为1500字节，则在网络层的<a href="https://baike.baidu.com/item/%E5%9B%A0%E7%89%B9%E7%BD%91%E5%8D%8F%E8%AE%AE/9453796">因特网协议</a>（Internet Protocol, IP）里，最大的数据包大小为1500字节（包含IP协议头）。MSS针对的是OSI模型里第四层传输层的TCP协议。因为MSS应用的协议在数据链接层的上层，MSS会受到MTU的限制</p>
<p>TCP的有限状态机</p>
<p>为什么老问你Timewait？</p>
<p>等待足够的时间以确保远程 TCP 收到其连接终止请求的确认。</p>
<p><a href="https://blog.csdn.net/mystyle_/article/details/119176327">https://blog.csdn.net/mystyle_/article/details/119176327</a></p>
<p>丢包怎么办？</p>
<p><a href="https://blog.csdn.net/weixin_43914604/article/details/105524592">https://blog.csdn.net/weixin_43914604/article/details/105524592</a></p>
<p>滑动窗口</p>
<p>流量控制/拥塞控制</p>
<p><a href="https://blog.csdn.net/weixin_43914604/article/details/105531547">https://blog.csdn.net/weixin_43914604/article/details/105531547</a></p>
<p><a href="https://blog.csdn.net/weixin_43914604/article/details/105532044">https://blog.csdn.net/weixin_43914604/article/details/105532044</a></p>
<h4 id="网络传输-httphttp11">网络传输-HTTP/HTTP1.1<a hidden class="anchor" aria-hidden="true" href="#网络传输-httphttp11">#</a></h4>
<p>为什么不直接用TCP通信？</p>
<p>TCP内容太多了，编程麻烦</p>
<p>其实HTTP只是多加了一层规矩，HTTP仍然是TCP，只是这个规矩让用户更清晰</p>
<p><a href="https://www.cnblogs.com/heluan/p/8620312.html">https://www.cnblogs.com/heluan/p/8620312.html</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/266578819">https://zhuanlan.zhihu.com/p/266578819</a></p>
<h4 id="网络传输-https">网络传输-HTTPS<a hidden class="anchor" aria-hidden="true" href="#网络传输-https">#</a></h4>
<h4 id="网络传输-ssltls握手">网络传输-SSL/TLS握手<a hidden class="anchor" aria-hidden="true" href="#网络传输-ssltls握手">#</a></h4>
<p><a href="https://www.jianshu.com/p/6811285c577d">https://www.jianshu.com/p/6811285c577d</a></p>
<h3 id="网络架构怎么给抖音提质">网络架构怎么给抖音提质？<a hidden class="anchor" aria-hidden="true" href="#网络架构怎么给抖音提质">#</a></h3>
<h4 id="网络提速-http20">网络提速-HTTP2.0<a hidden class="anchor" aria-hidden="true" href="#网络提速-http20">#</a></h4>
<h4 id="网络提速-如何理解多路复用stream">网络提速-如何理解多路复用/stream<a hidden class="anchor" aria-hidden="true" href="#网络提速-如何理解多路复用stream">#</a></h4>
<p>单个TCP链接传输</p>
<p>实际上stream还是串行的</p>
<p>如果TCP丢包怎么办？</p>
<p>TCP队头阻塞，TCP有个option，可以指定ack的序列号，指定需要重传的</p>
<h4 id="网络提速-quichttp30">网络提速-QUIC/HTTP3.0<a hidden class="anchor" aria-hidden="true" href="#网络提速-quichttp30">#</a></h4>
<p>TCP or UDP?</p>
<p>改TCP动一发而牵全身</p>
<p>Kernel or Userspace?</p>
<p>0RTT</p>
<p>弱网优势</p>
<h4 id="网络提速-数据中心分布">网络提速-数据中心分布<a hidden class="anchor" aria-hidden="true" href="#网络提速-数据中心分布">#</a></h4>
<p>核心机房</p>
<p>POP接入</p>
<p>边缘机房</p>
<p>汇聚机房</p>
<h4 id="网络提速-同运营商访问">网络提速-同运营商访问<a hidden class="anchor" aria-hidden="true" href="#网络提速-同运营商访问">#</a></h4>
<h4 id="网络提速-静态资源路径优化cdn">网络提速-静态资源路径优化（CDN）<a hidden class="anchor" aria-hidden="true" href="#网络提速-静态资源路径优化cdn">#</a></h4>
<p>Content Delivery <strong>Network，即内容分发网络</strong></p>
<h4 id="网络提速-动态api路径优化dsa">网络提速-动态API路径优化（DSA）<a hidden class="anchor" aria-hidden="true" href="#网络提速-动态api路径优化dsa">#</a></h4>
<h4 id="网络稳定-容灾概念">网络稳定-容灾概念<a hidden class="anchor" aria-hidden="true" href="#网络稳定-容灾概念">#</a></h4>
<p>故障发生</p>
<p>故障感知</p>
<p>自动切换</p>
<p>服务恢复</p>
<p>专线</p>
<p>外网容灾</p>
<p>云控？</p>
<p>web页面不能嵌入SDK、用户权限、</p>
<h4 id="网络稳定-故障排查">网络稳定-故障排查<a hidden class="anchor" aria-hidden="true" href="#网络稳定-故障排查">#</a></h4>
<h5 id="故障明确">故障明确<a hidden class="anchor" aria-hidden="true" href="#故障明确">#</a></h5>
<p>出现了什么故障？-&gt;沟通是前提</p>
<p>什么业务?什么接口障碍?</p>
<p>故障体现在哪里？</p>
<p>访问其他目标是否正常？</p>
<p>是否是修改导致的异常？</p>
<h5 id="故障止损">故障止损<a hidden class="anchor" aria-hidden="true" href="#故障止损">#</a></h5>
<p>先止损再排查</p>
<h5 id="分段排查">分段排查<a hidden class="anchor" aria-hidden="true" href="#分段排查">#</a></h5>
<p><img loading="lazy" src="C:%5cUsers%5cWIN10%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20220516144052484.png" alt="image-20220516144052484"  />
</p>
<h4 id="网络稳定-网络故障排查常用命令">网络稳定-网络故障排查常用命令<a hidden class="anchor" aria-hidden="true" href="#网络稳定-网络故障排查常用命令">#</a></h4>
<p><img loading="lazy" src="C:%5cUsers%5cWIN10%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20220516144146994.png" alt="image-20220516144146994"  />
</p>
<h3 id="课后作业1--udp-socket-实现-ack感知丢包重传">课后作业1- UDP socket 实现 ack，感知丢包重传<a hidden class="anchor" aria-hidden="true" href="#课后作业1--udp-socket-实现-ack感知丢包重传">#</a></h3>
<p>作业要求：</p>
<ol>
<li>
<p>学会 UDP socket 编程</p>
</li>
<li>
<p>先从简单的 ack 学习，客户端等待 ack 再发包</p>
</li>
<li>
<p>什么时候客户端认为是丢包？</p>
</li>
<li>
<p>重传怎么考虑效率？</p>
</li>
<li>
<p>能不能不阻塞只穿丢掉的中间的段？</p>
</li>
</ol>
<h3 id="课后作业2--三台同网段内的服务器模拟实现一个路由器">课后作业2- 三台同网段内的服务器，模拟实现一个路由器<a hidden class="anchor" aria-hidden="true" href="#课后作业2--三台同网段内的服务器模拟实现一个路由器">#</a></h3>
<p><strong>方法一: Linux 操作系统配置法</strong></p>
<p>提示：</p>
<ol>
<li>
<p>了解Linux的路由配置方式</p>
</li>
<li>
<p>确保是同网段直连可达的环境。在三台机器上另外配置IP网段和路由</p>
</li>
<li>
<p>一台机器做客户端，一台机器做路由器，一台机器做服务端</p>
</li>
<li>
<p>客户端配置到达服务器的下一跳指向路由器，路由器上配置到达服务端的路由</p>
</li>
</ol>
<p><strong>方法二:</strong> <strong>用户态</strong> <strong>socket 编程实现简易 route 软件</strong></p>
<p>提示：</p>
<ol>
<li>
<p>收到指定的包后，做转发</p>
</li>
<li>
<p>注意是修改报文的 MAC ，不是修改 IP</p>
</li>
<li>
<p>实现一个对称路由。这样可以实现 TCP 交互</p>
</li>
<li>
<p>可以通过 ping 来验证</p>
</li>
<li>
<p>可以支持 traceroute 吗？</p>
<p>&lt; 作业提交截止时间：5月17日 10:00前 &gt;</p>
</li>
</ol>
<h3 id="正确答案-4">正确答案：<a hidden class="anchor" aria-hidden="true" href="#正确答案-4">#</a></h3>
<h4 id="课后作业1">课后作业1：<a hidden class="anchor" aria-hidden="true" href="#课后作业1">#</a></h4>
<p>开放性问题，答案只要合理即可。具体实现可以参考</p>
<p><a href="https://github.com/networkprotocol/reliable">https://github.com/networkprotocol/reliable</a></p>
<p>根据作业要求的顺序一点点去实现，由简单ack功能入手到复杂的流控。</p>
<h4 id="课后作业2">课后作业2：<a hidden class="anchor" aria-hidden="true" href="#课后作业2">#</a></h4>
<p>开放性问题，答案只要合理即可。具体实现可以参考：</p>
<ol>
<li>
<p>静态路由表的注入可以在代码内用全局变量表示，也可以写一个配置文件去注入。</p>
</li>
<li>
<p>socket编程收raw包</p>
</li>
<li>
<p>解析raw包的IP层数据，根据静态路由表找到目标IP的下一跳</p>
</li>
<li>
<p>获取下一跳的MAC地址（linux有命令/系统调用接口，也可以自己实现简单的arp请求，保存目标MAC地址）</p>
</li>
<li>
<p>修改目标MAC地址为下一跳的MAC，修改源MAC地址为本机的出口网卡MAC。</p>
</li>
<li>
<p>ttl记得-1，然后转发数据包。</p>
</li>
</ol>
<h2 id="day72-如何将我的服务开放给用户">day7.2 如何将我的服务开放给用户<a hidden class="anchor" aria-hidden="true" href="#day72-如何将我的服务开放给用户">#</a></h2>
<p><a href="https://live.juejin.cn/4354/yc_open-serve">https://live.juejin.cn/4354/yc_open-serve</a></p>
<p><a href="https://bytedance.feishu.cn/file/boxcnUDmxxNLZjEd8oC17wFRRTe">https://bytedance.feishu.cn/file/boxcnUDmxxNLZjEd8oC17wFRRTe</a></p>
<p>企业接入升级打怪之路</p>
<h3 id="域名系统">域名系统<a hidden class="anchor" aria-hidden="true" href="#域名系统">#</a></h3>
<h4 id="host管理的问题">host管理的问题<a hidden class="anchor" aria-hidden="true" href="#host管理的问题">#</a></h4>
<p>流量和负载</p>
<p>名称冲突</p>
<p>时效性</p>
<h4 id="域名购买和配置迁移">域名购买和配置迁移<a hidden class="anchor" aria-hidden="true" href="#域名购买和配置迁移">#</a></h4>
<p><img loading="lazy" src="C:%5cUsers%5cWIN10%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20220515203844074.png" alt="image-20220515203844074"  />
</p>
<h3 id="自建dns服务器">自建DNS服务器<a hidden class="anchor" aria-hidden="true" href="#自建dns服务器">#</a></h3>
<h4 id="权威dns系统">权威DNS系统<a hidden class="anchor" aria-hidden="true" href="#权威dns系统">#</a></h4>
<p><a href="https://www.bilibili.com/video/BV1Mf4y1C7V8?spm_id_from=333.337.search-card.all.click">https://www.bilibili.com/video/BV1Mf4y1C7V8?spm_id_from=333.337.search-card.all.click</a></p>
<p>常见的开源DNS：bind、nsd、knot、coredns</p>
<h3 id="https协议">HTTPS协议<a hidden class="anchor" aria-hidden="true" href="#https协议">#</a></h3>
<p>HTTP明文传输，弊端越来愈明显</p>
<h4 id="对称加密和非对称加密">对称加密和非对称加密<a hidden class="anchor" aria-hidden="true" href="#对称加密和非对称加密">#</a></h4>
<h4 id="ssl的通信过程">SSL的通信过程<a hidden class="anchor" aria-hidden="true" href="#ssl的通信过程">#</a></h4>
<h4 id="证书链">证书链<a hidden class="anchor" aria-hidden="true" href="#证书链">#</a></h4>
<h3 id="接入全站加速">接入全站加速<a hidden class="anchor" aria-hidden="true" href="#接入全站加速">#</a></h3>
<p>源站容量低，可承载的并发请求数低</p>
<p>报文经过的网络设备越多，出问题的概率越大</p>
<p>自主选路网络链路长</p>
<h4 id="静态加速cdn">静态加速CDN<a hidden class="anchor" aria-hidden="true" href="#静态加速cdn">#</a></h4>
<h4 id="动态加速dcdn">动态加速DCDN<a hidden class="anchor" aria-hidden="true" href="#动态加速dcdn">#</a></h4>
<p>基于智能选路技术，从众多回源路线中择优选择一条路线进行传输</p>
<h3 id="四层负载均衡">四层负载均衡<a hidden class="anchor" aria-hidden="true" href="#四层负载均衡">#</a></h3>
<p><a href="https://blog.csdn.net/hanjinjuan/article/details/120274878">https://blog.csdn.net/hanjinjuan/article/details/120274878</a></p>
<h3 id="七层负载均衡">七层负载均衡<a hidden class="anchor" aria-hidden="true" href="#七层负载均衡">#</a></h3>
<p><a href="https://www.cnblogs.com/cheyunhua/p/10670070.html">https://www.cnblogs.com/cheyunhua/p/10670070.html</a></p>
<p><a href="https://blog.csdn.net/lamp_yang_3533/article/details/80383039">https://blog.csdn.net/lamp_yang_3533/article/details/80383039</a></p>
<h2 id="day81-架构初探">day8.1 架构初探<a hidden class="anchor" aria-hidden="true" href="#day81-架构初探">#</a></h2>
<p><a href="https://live.juejin.cn/4354/yc_cake">https://live.juejin.cn/4354/yc_cake</a></p>
<p><a href="https://bytedance.feishu.cn/file/boxcne8xf0JBAiXgPJ08Vf0IdJg?hash=d3d3a460879da375f28cee06d470b5aa">https://bytedance.feishu.cn/file/boxcne8xf0JBAiXgPJ08Vf0IdJg?hash=d3d3a460879da375f28cee06d470b5aa</a></p>
<h3 id="什么是架构">什么是架构<a hidden class="anchor" aria-hidden="true" href="#什么是架构">#</a></h3>
<p>有关软件整体结构与组件的抽象描述</p>
<p>用于指导软件系统各个方面的设计</p>
<h4 id="单机">单机<a hidden class="anchor" aria-hidden="true" href="#单机">#</a></h4>
<p>All in one，所有的东西都在一个进程里，部署在一个机器上。</p>
<p>优点：</p>
<ul>
<li>简单</li>
</ul>
<p>缺点：</p>
<ul>
<li>
<p>运维需要停服，用户体验较差</p>
</li>
<li>
<p>承载能力有限。<strong>了解下 c10k 问题</strong></p>
</li>
</ul>
<h4 id="单体垂直切分">单体、垂直切分<a hidden class="anchor" aria-hidden="true" href="#单体垂直切分">#</a></h4>
<p>在单机架构的基础上，将进程部署到多个机器上。</p>
<p>优点：</p>
<ul>
<li>
<p>具备水平扩容能力</p>
</li>
<li>
<p>运维不需要停服</p>
</li>
</ul>
<p>缺点：</p>
<ul>
<li>
<p>后端进程职责太多，越来越臃肿</p>
</li>
<li>
<p>爆炸半径较大，进程中一个很小的模块出现问题，都可能导致整个进程崩溃</p>
</li>
</ul>
<h4 id="soa">SOA<a hidden class="anchor" aria-hidden="true" href="#soa">#</a></h4>
<p>SOA 架构中，服务为一等公民，将进程按照不同的功能单元进行抽象，拆分为『服务』。有了服务之后，SOA 还为服务之间的通信定义了标准，保证各个服务之间通讯体验的一致性。</p>
<p>优点：</p>
<ul>
<li>
<p>各服务的职责更清晰</p>
</li>
<li>
<p>运维粒度减小到服务，爆炸半径可控</p>
</li>
</ul>
<p>缺点：</p>
<ul>
<li>ESB (企业服务总线) 往往需要一整套解决方案</li>
</ul>
<h4 id="微服务">微服务<a hidden class="anchor" aria-hidden="true" href="#微服务">#</a></h4>
<p>在 SOA 架构中，ESB 起到了至关重要的作用。但从架构拓扑来看，它更像是一个集中式的模块。有一个 SOA 分布式演进的分支，最终的形态便是微服务。</p>
<p>优点：</p>
<ul>
<li>
<p>兼具 SOA 解决的问题</p>
</li>
<li>
<p>服务间的通信更敏捷、灵活</p>
</li>
</ul>
<p>缺点：</p>
<ul>
<li>运维成本</li>
<li>服务间通信成本问题；</li>
<li>数据一致性问题</li>
</ul>
<h4 id="小结">小结<a hidden class="anchor" aria-hidden="true" href="#小结">#</a></h4>
<ul>
<li>
<p>架构演进的初衷：满足软件迭代诉求，提高迭代效率</p>
</li>
<li>
<p>架构演进的思路：垂直切分——分布式，水平切分——分层/模块化</p>
</li>
</ul>
<h3 id="企业级后端架构剖析">企业级后端架构剖析<a hidden class="anchor" aria-hidden="true" href="#企业级后端架构剖析">#</a></h3>
<p><a href="https://www.zhihu.com/question/20387284">https://www.zhihu.com/question/20387284</a></p>
<h4 id="云计算基础">云计算基础：<a hidden class="anchor" aria-hidden="true" href="#云计算基础">#</a></h4>
<ul>
<li>
<p>虚拟化技术</p>
<ul>
<li>硬件层面（VM 虚拟机）- KVM/Xen/VMware</li>
<li>操作系统层面（Container 容器）- LCX/Docker/Kata Container</li>
<li>网络层面 - Linux Bridge/Open v Switch</li>
</ul>
</li>
<li>
<p>编排方案</p>
<ul>
<li>VM - OpenStack/VMWare Workstation</li>
<li>Container - Kubernetes/Docker Swarm</li>
</ul>
</li>
</ul>
<h4 id="云计算架构">云计算架构：<a hidden class="anchor" aria-hidden="true" href="#云计算架构">#</a></h4>
<ul>
<li>
<p>云服务</p>
<ul>
<li>IaaS - 云基础设施，对底层硬件资源池的抽象</li>
<li>PaaS - 基于资源池抽象，对上层提供的弹性资源平台</li>
<li>SaaS - 基于弹性资源平台构建的云服务</li>
<li>FaaS - 更轻量级的函数服务。好比 LeetCode 等 OJ，刷题时只需要实现函数，不需要关注输入输出流</li>
</ul>
</li>
<li>
<p>云部署模式（拓展）</p>
<ul>
<li>私有云 - 企业自用</li>
<li>公有云 - AWS/Azure/Google Cloud/Huawei</li>
<li>混合云</li>
</ul>
</li>
</ul>
<h4 id="云原生">云原生<a hidden class="anchor" aria-hidden="true" href="#云原生">#</a></h4>
<p>云原生，实际是云原生（计算）的简称，它是元计算发展到现在的一种形态。</p>
<p>云原生技术为组织（公司）在公有云、自由云、混合云等新型的动态环境中，构建和运行可弹性拓展的应用提供了可能。 它的代表技术：</p>
<ul>
<li>
<p>弹性资源</p>
</li>
<li>
<p>微服务架构</p>
</li>
<li>
<p>DevOps</p>
</li>
<li>
<p>服务网格</p>
</li>
</ul>
<h5 id="弹性资源">弹性资源<a hidden class="anchor" aria-hidden="true" href="#弹性资源">#</a></h5>
<p>基于虚拟化技术，提供的可以快速扩缩容的能力。可以分为弹性计算资源和弹性存储资源两个方面。
弹性计算资源：</p>
<ul>
<li>
<p>计算资源调度</p>
<ul>
<li>在线计算 - 互联网后端服务</li>
<li>离线计算 - 大数据分析。Map-Reduce/Spark/Flinnk</li>
</ul>
</li>
<li>
<p>消息队列</p>
<ul>
<li>在线队列 - 削峰、解耦</li>
<li>离线队列 - 结合数据分析的一整套方案，如 ELK</li>
</ul>
</li>
</ul>
<p>弹性存储资源：</p>
<ul>
<li>
<p>经典存储</p>
<ul>
<li>对象存储 - 视频、图片等。结合 CDN 等技术，可以为应用提供丰富的多媒体能力</li>
<li>大数据存储 - 应用日志、用户数据等。结合数据挖掘、机器学习等技术，提高应用的体验</li>
</ul>
</li>
<li>
<p>关系型数据库</p>
</li>
<li>
<p>元数据</p>
<ul>
<li>服务发现</li>
</ul>
</li>
<li>
<p>NoSQL</p>
<ul>
<li>KV 存储 - Redis</li>
<li>文档存储 - Mongo</li>
</ul>
</li>
</ul>
<p>在云原生的大背景下，不论是计算资源还是存储资源，他们都像是服务一样供用户使用。</p>
<h5 id="微服务架构">微服务架构<a hidden class="anchor" aria-hidden="true" href="#微服务架构">#</a></h5>
<p>微服务架构下，服务之间的通讯标准是基于协议而不是 ESB 的。</p>
<ul>
<li>
<p>HTTP - H1/H2</p>
</li>
<li>
<p>RPC - Apache Thrift/gRPC</p>
</li>
</ul>
<p>如何在 HTTP 和 RPC 之间选择？</p>
<ul>
<li>
<p>性能 - RPC 协议往往具备较好的压缩率，性能较高。如 Thrift, Protocol Buffers</p>
</li>
<li>
<p>服务治理 - RPC 中间件往往集成了丰富的服务治理能力。如 熔断、降级、超时等</p>
</li>
<li>
<p>可解释性 - HTTP 通信的协议往往首选 JSON，可解释性、可调试性更好</p>
</li>
</ul>
<h5 id="服务网格">服务网格<a hidden class="anchor" aria-hidden="true" href="#服务网格">#</a></h5>
<p>什么是服务网格？</p>
<ul>
<li>
<p>微服务之间通讯的中间层</p>
</li>
<li>
<p>一个高性能的 4 层网络代理</p>
</li>
<li>
<p>将流量层面的逻辑与业务进程解耦</p>
</li>
</ul>
<p>没有什么是加一层代理解决不了的问题，服务网格相比较于 RPC/HTTP 框架：</p>
<ul>
<li>
<p>实现了异构系统治理体验的统一化</p>
</li>
<li>
<p>服务网格的数据平面代理与业务进程采取进程间通信的模式，使得流量相关的逻辑（包含治理）与业务进程解耦，生命周期也更容易管理</p>
</li>
</ul>
<h3 id="企业级后端架构的挑战">企业级后端架构的挑战<a hidden class="anchor" aria-hidden="true" href="#企业级后端架构的挑战">#</a></h3>
<h4 id="挑战">挑战<a hidden class="anchor" aria-hidden="true" href="#挑战">#</a></h4>
<p>基础设施层面：
Q：我们总说，云是弹性的，也就是说，在用户的角度，云提供的资源是无限的。然而，云背后的物理资源是有限的。在企业级后端架构里，云如何解决近乎无限的弹性资源和有限的物理资源之间的矛盾？</p>
<p>Q：闲事的资源就这么空着呢？如何提高资源利用率，提高物理资源的价值转换率？</p>
<p>用户层面：
Q：上了云原生微服务后，服务之间的通信开销较大，应该如何做成本优化？</p>
<p>Q：微服务看起来没有那么美好，抖动导致的运维成本较高，如何解决？</p>
<p>Q：异构的物理环境应该对用户是透明的，如何屏蔽这些细节？</p>
<h4 id="离在线资源并池">离在线资源并池<a hidden class="anchor" aria-hidden="true" href="#离在线资源并池">#</a></h4>
<p>考虑到在线业务的<strong>潮汐性</strong>，物理资源的用量不是一成不变的。离在线资源并池，可以：</p>
<ul>
<li>
<p>提高物理资源利用率</p>
</li>
<li>
<p>提供更多的弹性资源</p>
</li>
</ul>
<h3 id="后端架构实践">后端架构实践<a hidden class="anchor" aria-hidden="true" href="#后端架构实践">#</a></h3>
<h2 id="day82-git">day8.2 git<a hidden class="anchor" aria-hidden="true" href="#day82-git">#</a></h2>
<p><a href="https://bytedance.feishu.cn/file/boxcnsl8BgASj1TA9lzYb0TevEg?hash=8b34156117fb8fbc4eb72588c99e1adc">https://bytedance.feishu.cn/file/boxcnsl8BgASj1TA9lzYb0TevEg?hash=8b34156117fb8fbc4eb72588c99e1adc</a></p>
<p><a href="https://live.juejin.cn/4354/yc_Git-posture">https://live.juejin.cn/4354/yc_Git-posture</a></p>
<h2 id="day9-数据结构与算法">day9 数据结构与算法<a hidden class="anchor" aria-hidden="true" href="#day9-数据结构与算法">#</a></h2>
<p><a href="https://live.juejin.cn/4354/yc_data-correlation/preload">https://live.juejin.cn/4354/yc_data-correlation/preload</a></p>
<p><a href="https://bytedance.feishu.cn/file/boxcnZoRBfHvkwiwXC5qKft4L7b">https://bytedance.feishu.cn/file/boxcnZoRBfHvkwiwXC5qKft4L7b</a></p>
<h3 id="课后作业-实现-pdqsort-version-1">课后作业-<strong>实现 pdqsort-Version</strong> <strong>1</strong><a hidden class="anchor" aria-hidden="true" href="#课后作业-实现-pdqsort-version-1">#</a></h3>
<p><strong>作业要求：</strong></p>
<p>完成 PPT 中 pdqsort v1 版本，可以正确对元素排序</p>
<p>&lt; 作业提交截止时间：5月21日 10:00前 &gt;</p>
<h3 id="正确答案-5">正确答案：<a hidden class="anchor" aria-hidden="true" href="#正确答案-5">#</a></h3>
<p><a href="https://github.com/zhangyunhao116/sortlearning/blob/master/pdqsort.go">https://github.com/zhangyunhao116/sortlearning/blob/master/pdqsort.go</a></p>
<h2 id="day101-rpc框架">day10.1 RPC框架<a hidden class="anchor" aria-hidden="true" href="#day101-rpc框架">#</a></h2>
<p><a href="https://live.juejin.cn/4354/yc_RPC-framework/preload">https://live.juejin.cn/4354/yc_RPC-framework/preload</a></p>
<p><a href="https://bytedance.feishu.cn/file/boxcnQ289aixfQUmvgtDDn98mmf">https://bytedance.feishu.cn/file/boxcnQ289aixfQUmvgtDDn98mmf</a></p>
<h3 id="rpc-相关的基本概念">RPC 相关的基本概念<a hidden class="anchor" aria-hidden="true" href="#rpc-相关的基本概念">#</a></h3>
<p>RPC（Remote Procedure Call）远程过程调用协议，一种通过网络从远程计算机上请求服务，而不需要了解底层网络技术的协议。RPC它假定某些协议的存在，例如TPC/UDP等，为通信程序之间携带信息数据。在OSI网络七层模型中，RPC跨越了传输层和应用层，RPC使得开发，包括网络分布式多程序在内的应用程序更加容易。</p>
<p>过程是什么？ 过程就是业务处理、计算任务，更直白的说，就是程序，就是想调用本地方法一样调用远程的过程</p>
<p>==1：通讯协议== 比如：你需要找人在国外干活，那么你可以直接飞过去或者打电话或者通过互联网的形式，去找人，这个找人的过程就是通讯协议 ==2：寻址== 既然要找人干活，肯定要知道地址在哪，飞过去需要找到详细地址，打电话需要知道电话号码，互联网需要知道IP是多少 ==3：数据序列化== 就是说，语言需要互通，才能够让别人干活，之间需要一个大家都懂的语言去交流</p>
<ul>
<li>
<p>RPC的概念模型：User、User-Stub、RPC-Runtime、Server-Stub、Server</p>
<ul>
<li>来自论文《<a href="https://link.juejin.cn?target=https%3A%2F%2Fweb.eecs.umich.edu%2F~mosharaf%2FReadings%2FRPC.pdf">Implementing Remote Procedure Calls</a>》</li>
</ul>
</li>
<li>
<p>IDL(Interface Definition Language) 文件</p>
<ul>
<li>Thrift</li>
<li>Protobuf</li>
</ul>
</li>
<li>
<p>生成代码</p>
</li>
<li>
<p>编解码（序列化/反序列化）</p>
</li>
<li>
<p>通信协议</p>
<ul>
<li>应用层协议</li>
</ul>
</li>
<li>
<p>网络通信</p>
<ul>
<li>IO 网络模型
<ul>
<li>blocking IO</li>
<li>unblocking IO</li>
<li>IO multiplexing</li>
<li>signal driven IO</li>
<li>asynchronous IO</li>
</ul>
</li>
<li>传输层协议
<ul>
<li>TCP</li>
<li>UDP</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="rpc-框架的分层设计">RPC 框架的分层设计<a hidden class="anchor" aria-hidden="true" href="#rpc-框架的分层设计">#</a></h3>
<ul>
<li>
<p>编解码层</p>
<ul>
<li>数据格式：
<ul>
<li>语言特定格式</li>
<li>文本格式</li>
<li>二进制编码
<ul>
<li>TLV 编码：Thrift 使用 TLV 编码</li>
<li>Varint 编码：Protobuf 使用 Varint 编码</li>
</ul>
</li>
</ul>
</li>
<li>选项：
<ul>
<li>兼容性</li>
<li>通用型</li>
<li>性能</li>
</ul>
</li>
</ul>
</li>
<li>
<p>传输协议层</p>
<ul>
<li>消息切分
<ul>
<li>特殊结束符</li>
<li>变长协议：length+body</li>
</ul>
</li>
<li>协议构造
<ul>
<li>以 Thrift 的 <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fapache%2Fthrift%2Fblob%2Fmaster%2Fdoc%2Fspecs%2FHeaderFormat.md">THeader</a> 协议为例讲解</li>
</ul>
</li>
</ul>
</li>
<li>
<p>网络通信层</p>
<ul>
<li>网络库</li>
<li>核心指标
<ul>
<li>吞吐高</li>
<li>延迟低</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="衡量-rpc-框架的一些核心指标">衡量 RPC 框架的一些核心指标<a hidden class="anchor" aria-hidden="true" href="#衡量-rpc-框架的一些核心指标">#</a></h3>
<ul>
<li>
<p>稳定性</p>
<ul>
<li>保障策略
<ul>
<li>熔断</li>
<li>限流</li>
<li>超时</li>
</ul>
</li>
<li>请求成功率
<ul>
<li>负载均衡</li>
<li>重试</li>
</ul>
</li>
<li>长尾请求
<ul>
<li>BackupRequest</li>
</ul>
</li>
</ul>
</li>
<li>
<p>易用性</p>
<ul>
<li>开箱即用</li>
<li>周边工具</li>
</ul>
</li>
<li>
<p>扩展性</p>
</li>
<li>
<p>观测性</p>
<ul>
<li>Log</li>
<li>Metric</li>
<li>Tracing</li>
<li>内置观测性服务</li>
</ul>
</li>
<li>
<p>高性能</p>
</li>
</ul>
<h3 id="字节内部-rpc-框架-kitex-实践分享">字节内部 RPC 框架 Kitex 实践分享<a hidden class="anchor" aria-hidden="true" href="#字节内部-rpc-框架-kitex-实践分享">#</a></h3>
<ul>
<li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fcloudwego%2Fkitex">Kitex</a> 整体架构</li>
<li>自研网络库 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fcloudwego%2Fnetpoll">Netpoll</a></li>
<li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.infoq.cn%2Farticle%2Fspasfyqgaaid5rguinl4">性能优化</a>：
<ul>
<li>网络库优化</li>
<li>编解码优化</li>
</ul>
</li>
<li>合并部署</li>
</ul>
<h3 id="课后作业--重点内容-review-1">课后作业- 重点内容 Review<a hidden class="anchor" aria-hidden="true" href="#课后作业--重点内容-review-1">#</a></h3>
<ol>
<li>
<p>行业内各个流行的 RPC 框架的优劣对比？</p>
</li>
<li>
<p>从第三章节 RPC 的核心指标来看，Kitex 还有哪些功能是欠缺或者需要加强的？</p>
</li>
<li>
<p>了解微服务的新趋势 ServiceMesh，以及 RPC 框架和 ServiceMesh 的关系</p>
</li>
<li>
<p>关于 RPC 框架，业界有哪些新的趋势和概念？</p>
</li>
<li>
<p>Netpoll 的优势在哪？相比其他高性能网络库例如 Netty 还有什么不足？</p>
</li>
<li>
<p>Flatbuffer 和 Cap&rsquo;n Proto 等编解码协议为什么高性能？</p>
<p>&lt; 作业提交截止时间：5月24日 10:00前 &gt;</p>
</li>
</ol>
<h2 id="day102-http修炼知道">day10.2 HTTP修炼知道<a hidden class="anchor" aria-hidden="true" href="#day102-http修炼知道">#</a></h2>
<p><a href="https://live.juejin.cn/4354/yc_practise/preload">https://live.juejin.cn/4354/yc_practise/preload</a></p>
<p><a href="https://bytedance.feishu.cn/file/boxcnfWxLoNVpn36D041DdKP6Vg">https://bytedance.feishu.cn/file/boxcnfWxLoNVpn36D041DdKP6Vg</a></p>
<h3 id="再谈http协议">再谈HTTP协议<a hidden class="anchor" aria-hidden="true" href="#再谈http协议">#</a></h3>
<h3 id="http框架的设计与实现">HTTP框架的设计与实现<a hidden class="anchor" aria-hidden="true" href="#http框架的设计与实现">#</a></h3>
<h3 id="性能修炼之道">性能修炼之道<a hidden class="anchor" aria-hidden="true" href="#性能修炼之道">#</a></h3>
<h3 id="企业实践">企业实践<a hidden class="anchor" aria-hidden="true" href="#企业实践">#</a></h3>
<h3 id="课后作业-重点内容-review-1">课后作业-重点内容 Review<a hidden class="anchor" aria-hidden="true" href="#课后作业-重点内容-review-1">#</a></h3>
<p><strong>作业要求：</strong></p>
<ol>
<li>
<p>为什么 HTTP 框架做要分层设计？分层设计有哪些优势与劣势。</p>
</li>
<li>
<p>现有开源社区 HTTP 框架有哪些优势与不足。</p>
</li>
<li>
<p>中间件还有没有其他实现方式？可以用伪代码说明。</p>
</li>
<li>
<p>完成基于前缀路由树的注册与查找功能？可以用伪代码说明。</p>
</li>
<li>
<p>路由还有没有其他的实现方式？</p>
<p>&lt; 作业提交截止时间：5月24日 10:00前 &gt;</p>
</li>
</ol>
<h3 id="正确答案-6"><strong>正确答案：</strong><a hidden class="anchor" aria-hidden="true" href="#正确答案-6">#</a></h3>
<p>该问题为开放性问题，答案合理即可。</p>
<ol>
<li>
<p>优势：</p>
<ol>
<li>分层设计可以提高框架的扩展性、可维护性、复用性</li>
<li>分层设计可以让相关同学聚焦在核心层上而不用关心其他层的实现</li>
<li>劣势：</li>
<li>提高代码设计的复杂性，设计不好可能会导致循环依赖</li>
<li>由于使用接口进行解耦，可能会对代码性能造成影响</li>
</ol>
</li>
<li>
<p>gin：易用性强；生态丰富，但扩展性一般，性能一般。</p>
<ol>
<li>fasthttp：性能强；扩展性一般，生态一般。</li>
<li>go-zero：开箱即用，提供全套微服务能力，但扩展性一般，性能一般。</li>
</ol>
</li>
<li>
<p>课程中讲的中间件模型需要有一个地方保存 index，对于没有 index 的场景，可以将中间件构造为递归函数进行调用。</p>
</li>
</ol>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#007f7f">// Endpoint represent one method for calling from remote.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">type</span> Endpoint <span style="color:#fff;font-weight:bold">func</span> ( ctx context.Context, req, resp <span style="color:#fff;font-weight:bold">interface</span> {})  ( err <span style="color:#fff;font-weight:bold">error</span> )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">// Middleware deal with input Endpoint and output Endpoint.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">type</span> Middleware <span style="color:#fff;font-weight:bold">func</span> ( Endpoint ) Endpoint
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">// Chain connect middlewares into one middleware.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">func</span> chain ( mws ...Middleware ) Middleware {
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">func</span> ( next Endpoint ) Endpoint {
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">for</span> i := len ( mws ) - <span style="color:#ff0;font-weight:bold">1</span>; i &gt;= <span style="color:#ff0;font-weight:bold">0</span>; i-- {
</span></span><span style="display:flex;"><span>next = mws [ i ]( next )
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">return</span> next
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>} 
</span></span><span style="display:flex;"><span>复制代码
</span></span></code></pre></td></tr></table>
</div>
</div><ol>
<li>伪代码如下，可以使用递归实现，也可以使用其他更高性能的实现，这里提供递归的实现方式。</li>
</ol>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">47
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">48
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">49
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">50
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">51
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">52
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">53
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">54
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">55
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">56
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">57
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">58
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">59
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">60
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">61
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">62
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">63
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">64
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">65
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">66
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">67
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">68
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">69
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">70
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">71
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">72
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">73
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>func ( r *router ) addRoute ( path string, h app.HandlersChain ) {
</span></span><span style="display:flex;"><span>// 检查 path 合理性
</span></span><span style="display:flex;"><span>   checkPathValid ( path )
</span></span><span style="display:flex;"><span>// 循环添加 path 中的每一段
</span></span><span style="display:flex;"><span>   for i range len ( path ) {
</span></span><span style="display:flex;"><span>// 处理 : 类型参数路由
</span></span><span style="display:flex;"><span>      if path [ i ] == &#34;:&#34; {
</span></span><span style="display:flex;"><span>// 添加 : 之前的静态路由
</span></span><span style="display:flex;"><span>         Insert ( path [ :i ] , staticKind, nil )
</span></span><span style="display:flex;"><span>// 处理参数名称
</span></span><span style="display:flex;"><span>         paramNames.add ( paramName )
</span></span><span style="display:flex;"><span>// 判断当前是否是路由 path 的最后一段
</span></span><span style="display:flex;"><span>         if last {
</span></span><span style="display:flex;"><span>// 插入最后一段
</span></span><span style="display:flex;"><span>            Insert ( path [ i: ] , paramKind, handler )
</span></span><span style="display:flex;"><span>return
</span></span><span style="display:flex;"><span>         } else {
</span></span><span style="display:flex;"><span>// 不是最后一段，插入该段后继续插入之后的部分。
</span></span><span style="display:flex;"><span>            Insert ( path [ i: ] , paramKind, nil )
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>// 处理 * 号类型参数路由
</span></span><span style="display:flex;"><span>      } else if path [ i ] == &#34;*&#34; {
</span></span><span style="display:flex;"><span>// 添加 * 路由之前的部分
</span></span><span style="display:flex;"><span>         Insert ( path [ :i ] , staticKind, nil )
</span></span><span style="display:flex;"><span>// 处理参数名称
</span></span><span style="display:flex;"><span>         paramNames.add (paramName)
</span></span><span style="display:flex;"><span>// 添加最后一段
</span></span><span style="display:flex;"><span>         Insert ( path [ i: ] , allKind, handler )
</span></span><span style="display:flex;"><span>return
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>// 添加最后的静态路由
</span></span><span style="display:flex;"><span>   Insert ( path [ i: ] , staticKind, handler )
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>func find ( path string )  () {
</span></span><span style="display:flex;"><span>   // 匹配静态路由
</span></span><span style="display:flex;"><span>   if matchStaticKind {
</span></span><span style="display:flex;"><span>nextSearchPath = handleStaticKind ( path, node )
</span></span><span style="display:flex;"><span>path = nextSearchPath
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>// 匹配 param 路由
</span></span><span style="display:flex;"><span>   if matchParamKind {
</span></span><span style="display:flex;"><span>nextSearchPath = handleParamKind ( path, node )
</span></span><span style="display:flex;"><span>path = nextSearchPath
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>// 匹配 * 路由
</span></span><span style="display:flex;"><span>   if matchAllKind {
</span></span><span style="display:flex;"><span>nextSearchPath = handleAllKind ( path, node )
</span></span><span style="display:flex;"><span>path = nextSearchPath
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>// 判断是否找到
</span></span><span style="display:flex;"><span>   if endcondition {
</span></span><span style="display:flex;"><span>return
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// 递归搜索下一段静态路由
</span></span><span style="display:flex;"><span>   for node := range allStaticKindNodeChildren {
</span></span><span style="display:flex;"><span>if prefixMatch {
</span></span><span style="display:flex;"><span>node.find ( path )
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>// 搜索下一段 param 路由
</span></span><span style="display:flex;"><span>   if node.HasParamKindChild {
</span></span><span style="display:flex;"><span>node.find ( path)
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>// 搜索下一段 * 路由
</span></span><span style="display:flex;"><span>   if node.HasAllKindChild {
</span></span><span style="display:flex;"><span>node.find ( path)
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>return
</span></span><span style="display:flex;"><span>} 
</span></span><span style="display:flex;"><span>复制代码
</span></span></code></pre></td></tr></table>
</div>
</div><ol>
<li>可以尝试使用正则匹配的方式注册路由</li>
</ol>
<h2 id="day111-微服务框架">day11.1 微服务框架<a hidden class="anchor" aria-hidden="true" href="#day111-微服务框架">#</a></h2>
<p><a href="https://bytedance.feishu.cn/file/boxcnPjF5oJxpZh4ZQYDwVCSxib">https://bytedance.feishu.cn/file/boxcnPjF5oJxpZh4ZQYDwVCSxib</a></p>
<h3 id="微服务架构介绍">微服务架构介绍<a hidden class="anchor" aria-hidden="true" href="#微服务架构介绍">#</a></h3>
<h4 id="微服务架构概览">微服务架构概览<a hidden class="anchor" aria-hidden="true" href="#微服务架构概览">#</a></h4>
<h4 id="微服务架构的核心要素">微服务架构的核心要素<a hidden class="anchor" aria-hidden="true" href="#微服务架构的核心要素">#</a></h4>
<p>服务治理</p>
<p>可观测性</p>
<p>安全</p>
<h3 id="微服务架构原理及特征">微服务架构原理及特征<a hidden class="anchor" aria-hidden="true" href="#微服务架构原理及特征">#</a></h3>
<h4 id="基本概念">基本概念<a hidden class="anchor" aria-hidden="true" href="#基本概念">#</a></h4>
<p>服务</p>
<p>实例</p>
<p>集群</p>
<p>实例承载形式</p>
<h4 id="服务注册及发现">服务注册及发现<a hidden class="anchor" aria-hidden="true" href="#服务注册及发现">#</a></h4>
<h4 id="无损的服务实例上下线流程">无损的服务实例上下线流程<a hidden class="anchor" aria-hidden="true" href="#无损的服务实例上下线流程">#</a></h4>
<h4 id="微服务架构中的基本流量特征">微服务架构中的基本流量特征<a hidden class="anchor" aria-hidden="true" href="#微服务架构中的基本流量特征">#</a></h4>
<h3 id="核心服务治理功能">核心服务治理功能<a hidden class="anchor" aria-hidden="true" href="#核心服务治理功能">#</a></h3>
<h4 id="服务发布">服务发布<a hidden class="anchor" aria-hidden="true" href="#服务发布">#</a></h4>
<h4 id="流量治理">流量治理<a hidden class="anchor" aria-hidden="true" href="#流量治理">#</a></h4>
<h4 id="负载均衡">负载均衡<a hidden class="anchor" aria-hidden="true" href="#负载均衡">#</a></h4>
<h4 id="稳定性治理">稳定性治理<a hidden class="anchor" aria-hidden="true" href="#稳定性治理">#</a></h4>
<h3 id="字节跳动服务治理实践">字节跳动服务治理实践<a hidden class="anchor" aria-hidden="true" href="#字节跳动服务治理实践">#</a></h3>
<p>重试</p>
<h3 id="课后作业--重点内容-review-2">课后作业- 重点内容 Review<a hidden class="anchor" aria-hidden="true" href="#课后作业--重点内容-review-2">#</a></h3>
<ol>
<li>
<p>结合 CAP 等原理，思考微服务架构有哪些缺陷？</p>
</li>
<li>
<p>微服务是否拆分得越“微”越好？为什么？</p>
</li>
<li>
<p>Service Mesh 这一架构是为了解决微服务架构的什么问题？</p>
<p><a href="https://philcalcado.com/2017/08/03/pattern_service_mesh.html">https://philcalcado.com/2017/08/03/pattern_service_mesh.html</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/61901608">https://zhuanlan.zhihu.com/p/61901608</a></p>
</li>
<li>
<p>有没有可能有这样一种架构，从开发上线运维体验上是微服务，但实际运行又类似单体服务？</p>
</li>
</ol>
<h2 id="day112消息队列">day11.2消息队列<a hidden class="anchor" aria-hidden="true" href="#day112消息队列">#</a></h2>
<p><a href="https://bytedance.feishu.cn/file/boxcnKXjTxtmdCpdidtJZGckf5b">https://bytedance.feishu.cn/file/boxcnKXjTxtmdCpdidtJZGckf5b</a></p>
<p><a href="https://live.juejin.cn/4354/yc_message-queue/preload">https://live.juejin.cn/4354/yc_message-queue/preload</a></p>
<p>解耦：系统崩溃</p>
<p>削峰：服务处理能力有限</p>
<p>异步：链路耗时长尾</p>
<p>日志处理：日志如何处理</p>
<h3 id="前世今生">前世今生<a hidden class="anchor" aria-hidden="true" href="#前世今生">#</a></h3>
<p>消息队列：支持高吞吐、高并发、高可用的队列</p>
<h3 id="消息队列kafka">消息队列Kafka<a hidden class="anchor" aria-hidden="true" href="#消息队列kafka">#</a></h3>
<p>kafka使用场景，业务日志、用户行为数据、Metrics数据</p>
<p>基本概念，Producer、Cluster、Consumer、Topic、Partition</p>
<p>数据迁移、Offset、Partition选主</p>
<p>一条消息从生产到消费是如何处理的，Producer端逻辑、Broker端逻辑、Consumer端逻辑</p>
<h4 id="producer端逻辑">Producer端逻辑<a hidden class="anchor" aria-hidden="true" href="#producer端逻辑">#</a></h4>
<p>批量发送、数据压缩</p>
<h4 id="broker端逻辑">Broker端逻辑<a hidden class="anchor" aria-hidden="true" href="#broker端逻辑">#</a></h4>
<p>顺序写、消息索引、零拷贝</p>
<h4 id="consumer端逻辑">Consumer端逻辑<a hidden class="anchor" aria-hidden="true" href="#consumer端逻辑">#</a></h4>
<p>Rebalance</p>
<p>问题：</p>
<p>运维成本高</p>
<p>对于负载不均衡的场景，解决方案复杂</p>
<p>没有自己的缓存，完全依赖于Page Cache</p>
<h3 id="消息队列bmq">消息队列BMQ<a hidden class="anchor" aria-hidden="true" href="#消息队列bmq">#</a></h3>
<h3 id="课后作业-2">课后作业：<a hidden class="anchor" aria-hidden="true" href="#课后作业-2">#</a></h3>
<ol>
<li>
<p>消息队列的应用场景有哪些？</p>
</li>
<li>
<p>Kafka 的哪些 Feature 让其可以支撑大吞吐写入的场景？</p>
</li>
<li>
<p>Kafka Consumer Rebalance 的流程简述？</p>
</li>
<li>
<p>BMQ 相比较 Kafka 有哪些优势？</p>
</li>
<li>
<p>RocketMQ 有哪些特有的 Feature？</p>
</li>
<li>
<p>RocketMQ 事务消息处理流程简述？</p>
</li>
<li>
<p>你认为 MQ 后面应该如何发展？（开放题）</p>
</li>
</ol>
<h2 id="day121-分布式定时器">day12.1 分布式定时器<a hidden class="anchor" aria-hidden="true" href="#day121-分布式定时器">#</a></h2>
<p><a href="https://bytedance.feishu.cn/file/boxcnxSIthZayPmlXZWdYx845qg">https://bytedance.feishu.cn/file/boxcnxSIthZayPmlXZWdYx845qg</a></p>
<h3 id="前言">前言<a hidden class="anchor" aria-hidden="true" href="#前言">#</a></h3>
<ul>
<li>
<p>每年春节抖音都会有很多有意思的玩法，如果同学们是字节的后端同学，怎么设计今年春节集卡瓜分20亿的技术方案？</p>
</li>
<li>
<p>业务流程</p>
<ul>
<li>定时扫描抖音用户集卡状态</li>
<li>汇总计算用户的瓜分金额</li>
<li>定时开奖</li>
</ul>
</li>
<li>
<p>技术体量</p>
<ul>
<li>亿级用户规模</li>
<li>十亿级资金规模</li>
<li>百万级读写QPS</li>
</ul>
</li>
<li>
<p>方案引出</p>
<ul>
<li>自动化 + 定时执行 + 海量数据 + 高效稳定 = 分布式定时任务</li>
</ul>
</li>
</ul>
<h3 id="发展历程">发展历程<a hidden class="anchor" aria-hidden="true" href="#发展历程">#</a></h3>
<p>Windows批处理</p>
<p>windows任务计划程序</p>
<p>Linux CronJob</p>
<p>单机定时任务Timer	Ticker</p>
<p>单机定时任务 ScheduledExecutorService</p>
<p>任务调度Quartz</p>
<h4 id="分布式定时任务">分布式定时任务<a hidden class="anchor" aria-hidden="true" href="#分布式定时任务">#</a></h4>
<h5 id="定义">定义<a hidden class="anchor" aria-hidden="true" href="#定义">#</a></h5>
<ul>
<li>定时任务是指系统为了<strong>自动</strong>完成特定任务，<strong>实时、延时、周期</strong>性完成任务调度的过程。</li>
<li>分布式定时任务是把分散的、可靠性差的定时任务纳入统一的<strong>平台</strong>，并实现集群管理调度和<strong>分布式部署</strong>的一种定时任务的管理方式。</li>
</ul>
<p>按触发时机分类：
定时任务：特定时间触发，比如今天15:06执行
延时任务：延时触发，比如10s后执行
周期任务：固定周期时间，或固定频率周期调度触发，比如每隔5s或者每天12点执行</p>
<h5 id="特点">特点<a hidden class="anchor" aria-hidden="true" href="#特点">#</a></h5>
<p>自动化：全自动完成定时任务的调度和执行
平台化：基于平台化的思维管控一系列的分布式定时任务
分布式：在分布式系统环境下运行任务调度，突破单机定时任务的性能瓶颈
伸缩性：采用集群方式部署，可以随时按需扩缩容
高可用：单点故障不影响最终任务结果，可以做到故障转移</p>
<h5 id="执行模式">执行模式<a hidden class="anchor" aria-hidden="true" href="#执行模式">#</a></h5>
<p>单机任务：随机触发一台机器执行任务，适用于计算量小、并发度低的任务
广播任务：广播到所有机器上执行同一个任务，比如所有机器一起清理日志
Map任务：一个任务可以分出多个子任务，每个子任务负责一部分的计算。适用于计算量大，单机无法满足要求的任务
MapReduce任务：在Map任务的基础上，还可以对所有子任务的结果做汇总计算，适用于计算量大，并且需要对子任务结果做汇总的任务</p>
<h5 id="分布式定时任务vs单机定时任务">分布式定时任务VS单机定时任务<a hidden class="anchor" aria-hidden="true" href="#分布式定时任务vs单机定时任务">#</a></h5>
<p>关系：
都可以实现自动化的定时、延时、周期任务调度
差异：
分布式定时任务可支撑更大的业务体量
分布式定时任务的性能、伸缩性、稳定性更高</p>
<h5 id="分布式定时任务vs大数据处理引擎">分布式定时任务VS大数据处理引擎<a hidden class="anchor" aria-hidden="true" href="#分布式定时任务vs大数据处理引擎">#</a></h5>
<p>关系：
都可以对海量数据做处理
性能、伸缩性、稳定性都很高
差异：
定时并不是大数据处理引擎要解决的核心问题
大数据处理引擎往往致力于将源数据处理成结果数据，分布式定时任务除了能做这个之外，还可以调用HTTP和RPC服务</p>
<h5 id="业内流行框架xxl-jobschedulerxtct">业内流行框架：Xxl-job、SchedulerX、TCT<a hidden class="anchor" aria-hidden="true" href="#业内流行框架xxl-jobschedulerxtct">#</a></h5>
<h2 id="实现原理">实现原理<a hidden class="anchor" aria-hidden="true" href="#实现原理">#</a></h2>
<p>分布式定时任务核心要解决触发、调度、执行三个关键问题</p>
<p>触发器：Trigger，解析任务，生成触发事件
调度器：Scheduler，分配任务，管理任务生命周期
执行器：Executor，获取执行任务单元，执行任务逻辑</p>
<p>除此之外，还需要提供一个控制台（Admin），提供任务管理和干预的功能。</p>
<h3 id="基本概念-1">基本概念<a hidden class="anchor" aria-hidden="true" href="#基本概念-1">#</a></h3>
<p>任务：Job，任务元数据
任务实例：JobInstance，周期任务会生成多个任务实例
任务结果：JobResult，任务实例运行的结果
任务历史：JobHistory，用户可以修改任务信息，任务实例对应的任务元数据可以不同，因而使用任务历史存储</p>
<h3 id="触发器">触发器<a hidden class="anchor" aria-hidden="true" href="#触发器">#</a></h3>
<p>核心职责
给定一系列任务，解析它们的触发规则，在规定的时间点触发任务的调度</p>
<p>设计约束
需支持大量任务
需支持秒级的调度
周期任务需要多次执行
需保证秒级扫描的高性能，并避免资源浪费</p>
<h4 id="方案一">方案一<a hidden class="anchor" aria-hidden="true" href="#方案一">#</a></h4>
<p>定期扫描+延时消息（腾讯、字节方案）</p>
<h4 id="方案二">方案二<a hidden class="anchor" aria-hidden="true" href="#方案二">#</a></h4>
<p>时间轮（ Quartz 所用方案）
时间轮是一种高效利用线程资源进行批量化调度的一种调度模型。时间轮是一个存储环形队列，底层采用数组实现，数组中的每个元素可以存放一个定时任务列表。</p>
<p>多级时间轮</p>
<p>触发器 高可用</p>
<h3 id="课后作业--重点内容-review-3">课后作业- 重点内容 Review<a hidden class="anchor" aria-hidden="true" href="#课后作业--重点内容-review-3">#</a></h3>
<ol>
<li>
<p>分布式定时任务可以帮助我们处理哪些业务场景？</p>
</li>
<li>
<p>春节集卡瓜分20亿的玩法，发奖金额计算、实时开奖两个阶段分别用到分布式定时任务什么执行方式？</p>
</li>
<li>
<p>有了分布式定时任务，单机定时任务还有适用场景么？</p>
</li>
<li>
<p>时间轮这种数据结构，在定时/延时场景相比其他数据结构有哪些优势？</p>
</li>
<li>
<p>分布式定时任务的调度中心怎么判断一台执行器的机器处于可被调度状态？</p>
</li>
<li>
<p>你能想到哪些业务场景，实时计算引擎优于分布式定时任务？</p>
<p>&lt; 作业提交截止时间：5月26日 10:00前 &gt;</p>
</li>
</ol>
<h3 id="正确答案-7">正确答案：<a hidden class="anchor" aria-hidden="true" href="#正确答案-7">#</a></h3>
<ol>
<li>
<p>所有需要定时、延时、周期性执行任务的业务场景，都可以考虑使用分布式定时任务。在电商、游戏、互动等多个业务领域中都有广泛应用。</p>
</li>
<li>
<p>MapReduce任务和Map任务。由于发奖金额计算时需要汇总计算所有用户的集卡状态，因而在Map之后还需要对子任务的结果做汇总计算；而实时开奖则只需要对全量集齐的用户发奖即可。</p>
</li>
<li>
<p>有，比如定时刷新每台机器中的缓存、定期清理机器日志等。</p>
</li>
<li>
<p>相比于链表、最小堆，时间轮的查询和修改的时间复杂度都是O(1)。</p>
</li>
<li>
<p>执行器的机器首先需要调用调度中心的注册服务将本机器注册上去，并且需要定期状态上报供调度中心监控机器状态。</p>
</li>
<li>
<p>需要实时统计大规模流式数据，只需要做数据处理，无需调用RPC/HTTP接口做其他额外处理的业务场景，比较典型的例子是电商双十一的大屏，实时统计当前的GMV、订单量等</p>
</li>
</ol>
<h2 id="day122-存储与数据库">day12.2 存储与数据库<a hidden class="anchor" aria-hidden="true" href="#day122-存储与数据库">#</a></h2>
<p><a href="https://bytedance.feishu.cn/file/boxcn27GCEstXUOpBYFEpAY3EIh">https://bytedance.feishu.cn/file/boxcn27GCEstXUOpBYFEpAY3EIh</a></p>
<h3 id="课后作业-实现一个分布式key-value-存储系统">课后作业-实现一个（分布式）key-value 存储系统<a hidden class="anchor" aria-hidden="true" href="#课后作业-实现一个分布式key-value-存储系统">#</a></h3>
<p><strong>作业要求：</strong></p>
<ol>
<li>
<p>基于本地文件系统实现，支持常用的 put(k, v)、get(k, v)、scan_by_prefix(prefix) 接口</p>
</li>
<li>
<p>支持存储 server 独立进程部署，支持跨进程或者网络访问</p>
</li>
<li>
<p>IO 操作做到低时延</p>
</li>
</ol>
<p>*<strong>可选：</strong> 支持扩展成分布式架构，多台存储server组成一个分布式key-value存储系统，并保证全局的数据一致性。</p>
<p>&lt; 作业提交截止时间：5月26日 10:00前 &gt;</p>
<h2 id="day13-深入理解rdbms">day13 深入理解RDBMS<a hidden class="anchor" aria-hidden="true" href="#day13-深入理解rdbms">#</a></h2>
<p><a href="https://bytedance.feishu.cn/file/boxcnXzUnOJI7nUFhvBMTW9sfBh?hash=a90b5ab6be81c4d6ca20bf103bd9ab65">https://bytedance.feishu.cn/file/boxcnXzUnOJI7nUFhvBMTW9sfBh?hash=a90b5ab6be81c4d6ca20bf103bd9ab65</a></p>
<h3 id="课后作业--重点内容-review-4">课后作业- 重点内容 Review<a hidden class="anchor" aria-hidden="true" href="#课后作业--重点内容-review-4">#</a></h3>
<ol>
<li>
<p>WAL 日志到底是如何保证数据的持久化，宕机后数据不丢失的？</p>
</li>
<li>
<p>相比于其他方案，WAL 日志都有什么优势？</p>
</li>
<li>
<p>除了 Undo Log 之外，是否还有其他方案可以实现 MVCC？</p>
</li>
<li>
<p>基于代价的优化器一般需要考虑哪些代价？</p>
</li>
<li>
<p>执行器的执行模型，除了本课中提到的火山模型是否还有其他模型？</p>
</li>
<li>
<p>B+ Tree的优点有哪些？</p>
</li>
<li>
<p>InnoDB 的 buffer pool 是怎么实现页面管理和淘汰的？</p>
<p>&lt; 作业提交截止时间：5月28日 10:00前 &gt;</p>
</li>
</ol>
<h3 id="正确答案-8">正确答案：<a hidden class="anchor" aria-hidden="true" href="#正确答案-8">#</a></h3>
<ol>
<li>
<p>WAL是预写日志，需要保证日志落盘才能够进行事务提交。日志中包含了事务对数据的修改，宕机后通过解析WAL日志，就可以对数据进行恢复。</p>
</li>
<li>
<p>相比于每次事务提交时都对数据页面进行flush操作，WAL日志有以下优点：</p>
<ol>
<li>解决了IO放大的问题。</li>
<li>随机读写变为顺序读写，对磁盘更友好。</li>
</ol>
</li>
<li>
<p>除了Undo Log之外，还有shadow paging的方式。例如PostgreSQL就是采用这种方式。这种方式的特点是，在数据页面中同时保留了一行数据的多个历史版本，通过trx_id来区分。</p>
</li>
<li>
<p>基于代价的优化器一般需要考虑IO消耗、网络消耗、CPU消耗等。</p>
</li>
<li>
<p>常见的执行模型有三类：火山模型(Volcano Model/Pipeline Model/Iterator Model/Pull Model)、物化模型(Materialization Model/Push Model)、向量化模型(Vectorized / Batch Model)。</p>
</li>
<li>
<p>B+树的优点如下：</p>
<ol>
<li>B+树内部节点不存储数据，只存储键值，这样，每个节点就能存储更多的键值，一次性也就能将更多的键值读入内存，减少了对磁盘的IO操作次数；</li>
<li>B+树的叶节点有一条链相连，所以对于<strong>区间内查询数据</strong>比较高效。</li>
</ol>
</li>
<li>
<p>InnoDB的buffer pool通过一个hash_map&lt;page_id, page_ptr&gt;来实现页面的快速查找访问，通过一个LRU来实现页面的冷热淘汰管理。</p>
</li>
</ol>
<h2 id="day141-tos对象存储">day14.1 TOS对象存储<a hidden class="anchor" aria-hidden="true" href="#day141-tos对象存储">#</a></h2>
<p><a href="https://live.juejin.cn/4354/yc_TOS">https://live.juejin.cn/4354/yc_TOS</a></p>
<p><a href="https://bytedance.feishu.cn/file/boxcn3SOO7DkrVWzb93qx08jtch">https://bytedance.feishu.cn/file/boxcn3SOO7DkrVWzb93qx08jtch</a></p>
<h3 id="课后作业-实现一个对象存储客户端">课后作业-实现一个对象存储客户端<a hidden class="anchor" aria-hidden="true" href="#课后作业-实现一个对象存储客户端">#</a></h3>
<p><strong>作业要求：</strong></p>
<ol>
<li>
<p>在任意一个公有云中申请一个对象存储 Bucket</p>
</li>
<li>
<p>使用你熟悉的语言，实现一个对象存储命令行客户端，要求该客户端能够</p>
<ol>
<li>创建对象：超过 1GB 的对象使用 MultiUpload 上传，小于 1GB 的使用 Put 上传</li>
<li>下载对象</li>
<li>删除对象</li>
<li>查看对象是否存在</li>
<li>列举对象及 CommonPrefix</li>
</ol>
<p>&lt; 作业提交截止时间：5月29日 10:00前 &gt;</p>
</li>
</ol>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://kevinerr.github.io/tags/%E6%A0%87%E7%AD%BE1/">标签1</a></li>
      <li><a href="https://kevinerr.github.io/tags/%E6%A0%87%E7%AD%BE2/">标签2</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://kevinerr.github.io/posts/read/%E5%8D%9A%E5%AE%A2%E9%98%85%E8%AF%BB/">
    <span class="title">« Prev Page</span>
    <br>
    <span>博客阅读</span>
  </a>
  <a class="next" href="https://kevinerr.github.io/posts/tech/%E5%B9%BC%E9%BA%9F%E5%AE%9E%E9%AA%8C%E5%AE%A4/">
    <span class="title">Next Page »</span>
    <br>
    <span>幼麟实验室</span>
  </a>
</nav>


<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share 字节青训营 on twitter"
        href="https://twitter.com/intent/tweet/?text=%e5%ad%97%e8%8a%82%e9%9d%92%e8%ae%ad%e8%90%a5&amp;url=https%3a%2f%2fkevinerr.github.io%2fposts%2ftech%2f%25E5%25AD%2597%25E8%258A%2582%25E9%259D%2592%25E8%25AE%25AD%25E8%2590%25A5%2f&amp;hashtags=%e6%a0%87%e7%ad%be1%2c%e6%a0%87%e7%ad%be2">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share 字节青训营 on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fkevinerr.github.io%2fposts%2ftech%2f%25E5%25AD%2597%25E8%258A%2582%25E9%259D%2592%25E8%25AE%25AD%25E8%2590%25A5%2f&amp;title=%e5%ad%97%e8%8a%82%e9%9d%92%e8%ae%ad%e8%90%a5&amp;summary=%e5%ad%97%e8%8a%82%e9%9d%92%e8%ae%ad%e8%90%a5&amp;source=https%3a%2f%2fkevinerr.github.io%2fposts%2ftech%2f%25E5%25AD%2597%25E8%258A%2582%25E9%259D%2592%25E8%25AE%25AD%25E8%2590%25A5%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share 字节青训营 on reddit"
        href="https://reddit.com/submit?url=https%3a%2f%2fkevinerr.github.io%2fposts%2ftech%2f%25E5%25AD%2597%25E8%258A%2582%25E9%259D%2592%25E8%25AE%25AD%25E8%2590%25A5%2f&title=%e5%ad%97%e8%8a%82%e9%9d%92%e8%ae%ad%e8%90%a5">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share 字节青训营 on facebook"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fkevinerr.github.io%2fposts%2ftech%2f%25E5%25AD%2597%25E8%258A%2582%25E9%259D%2592%25E8%25AE%25AD%25E8%2590%25A5%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share 字节青训营 on whatsapp"
        href="https://api.whatsapp.com/send?text=%e5%ad%97%e8%8a%82%e9%9d%92%e8%ae%ad%e8%90%a5%20-%20https%3a%2f%2fkevinerr.github.io%2fposts%2ftech%2f%25E5%25AD%2597%25E8%258A%2582%25E9%259D%2592%25E8%25AE%25AD%25E8%2590%25A5%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share 字节青训营 on telegram"
        href="https://telegram.me/share/url?text=%e5%ad%97%e8%8a%82%e9%9d%92%e8%ae%ad%e8%90%a5&amp;url=https%3a%2f%2fkevinerr.github.io%2fposts%2ftech%2f%25E5%25AD%2597%25E8%258A%2582%25E9%259D%2592%25E8%25AE%25AD%25E8%2590%25A5%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>

  </footer>
<div>
    <div class="pagination__title">
        <span class="pagination__title-h" style="font-size: 20px;">💬评论</span>
        <hr />
    </div>
    <div id="tcomment"></div>
    <script src="https://cdn.jsdelivr.net/npm/twikoo@1.5.0/dist/twikoo.all.min.js"></script>
    <script>
        twikoo.init({
            envId: "https://twikoo-two-psi.vercel.app/",  
            el: "#tcomment",
            lang: 'zh-CN',
            region: 'ap-guangzhou',  
            path: 'window.TWIKOO_MAGIC_PATH||window.location.pathname',
        });
    </script>
</div>

</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="https://kevinerr.github.io/">hkh&#39;s Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
